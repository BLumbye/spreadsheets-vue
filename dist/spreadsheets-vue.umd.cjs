(function(F,D){typeof exports=="object"&&typeof module<"u"?D(exports,require("vue"),require("vuedraggable")):typeof define=="function"&&define.amd?define(["exports","vue","vuedraggable"],D):(F=typeof globalThis<"u"?globalThis:F||self,D(F.SpreadsheetsVue={},F.Vue,F.draggable))})(this,function(F,D,Je){"use strict";Array.prototype.count||(Array.prototype.count=function(e){return this.reduce((t,r)=>t+(e(r)?1:0),0)});function Br(n,e){let t=[...n];const r=t.filter(c=>!Number.isNaN(Number(c))),i=t.filter(c=>Number.isNaN(Number(c)));return r.sort((c,a)=>Number(c)-Number(a)),i.sort(),e!=null&&e.descending&&(r.reverse(),i.reverse()),t=(e==null?void 0:e.numbersFirst)===void 0||e.numbersFirst?[...r,...i]:[...i,...r],t}function qr(n,e,t,r){if(e<0||t>=n.length||e>=t)throw new Error("Invalid range specified");const i=n.slice(e,t+1);i.sort(),r&&i.reverse();for(let c=e,a=0;c<=t;c++,a++)n[c]=i[a];return n}function Ur(n){return n.reduce((e,t)=>e.concat(t),[])}function Se(n){return n[0].map((e,t)=>n.map(r=>r[t]))}var qn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function be(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var xe={exports:{}};(function(n,e){(function(t,r){r()})(qn,function(){function t(s,o){return typeof o>"u"?o={autoBom:!1}:typeof o!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}function r(s,o,u){var f=new XMLHttpRequest;f.open("GET",s),f.responseType="blob",f.onload=function(){d(f.response,o,u)},f.onerror=function(){console.error("could not download file")},f.send()}function i(s){var o=new XMLHttpRequest;o.open("HEAD",s,!1);try{o.send()}catch{}return 200<=o.status&&299>=o.status}function c(s){try{s.dispatchEvent(new MouseEvent("click"))}catch{var o=document.createEvent("MouseEvents");o.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),s.dispatchEvent(o)}}var a=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof qn=="object"&&qn.global===qn?qn:void 0,E=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),d=a.saveAs||(typeof window!="object"||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!E?function(s,o,u){var f=a.URL||a.webkitURL,l=document.createElement("a");o=o||s.name||"download",l.download=o,l.rel="noopener",typeof s=="string"?(l.href=s,l.origin===location.origin?c(l):i(l.href)?r(s,o,u):c(l,l.target="_blank")):(l.href=f.createObjectURL(s),setTimeout(function(){f.revokeObjectURL(l.href)},4e4),setTimeout(function(){c(l)},0))}:"msSaveOrOpenBlob"in navigator?function(s,o,u){if(o=o||s.name||"download",typeof s!="string")navigator.msSaveOrOpenBlob(t(s,u),o);else if(i(s))r(s,o,u);else{var f=document.createElement("a");f.href=s,f.target="_blank",setTimeout(function(){c(f)})}}:function(s,o,u,f){if(f=f||open("","_blank"),f&&(f.document.title=f.document.body.innerText="downloading..."),typeof s=="string")return r(s,o,u);var l=s.type==="application/octet-stream",g=/constructor/i.test(a.HTMLElement)||a.safari,h=/CriOS\/[\d]+/.test(navigator.userAgent);if((h||l&&g||E)&&typeof FileReader<"u"){var v=new FileReader;v.onloadend=function(){var p=v.result;p=h?p:p.replace(/^data:[^;]*;/,"data:attachment/file;"),f?f.location.href=p:location=p,f=null},v.readAsDataURL(s)}else{var I=a.URL||a.webkitURL,m=I.createObjectURL(s);f?f.location=m:location.href=m,f=null,setTimeout(function(){I.revokeObjectURL(m)},4e4)}});a.saveAs=d.saveAs=d,n.exports=d})})(xe);var Fr=xe.exports;function kr(n,e){return(e!=null&&e.header?[e.header,...n]:n).join((e==null?void 0:e.direction)==="horizontal"?",":`
`)}function Gr(n,e){if(e!=null&&e.nested)return e.nested;for(let t of n)if("items"in t&&Array.isArray(t.items)&&t.items.length>0&&typeof t.items[0]=="object")return!0;return!1}function Hr(n,e,t){let r=[];if(r.push(Object.values(e)),Gr(n,t))for(let i of n)for(let c of i.items)r.push(Object.keys(e).map(a=>a===(t==null?void 0:t.groupKey)?i[t.groupKey]:c[a]));else for(let i of n)r.push(Object.keys(e).map(c=>i[c]));return(t==null?void 0:t.direction)==="horizontal"&&(r=Se(r)),r.map(i=>i.join(",")).join(`
`)}function Yr(n,e){const t=new Blob([n],{type:"text/csv;charset=utf-8;"});Fr.saveAs(t,e)}function $r(n){const e=n.split(`
`),t=[];for(let r of e){const i=r.split(",");for(let c of i)c=c.trim(),t.push(zr(c))}return t}function zr(n){if(n==="")return"";const e=Number(n);if(!isNaN(e))return e;const t=new Date(n);return isNaN(t.getTime())?n.toLowerCase()==="true"?!0:n.toLowerCase()==="false"?!1:n:t}const pe=()=>n=>!isNaN(Number(n))||n==="-"||n==="."||n==="-.",Wr=()=>n=>!isNaN(Number(n))&&!n.includes("."),Kr=()=>n=>(Number(n)||0)>=0,Xr=()=>n=>(Number(n)||0)<=0,Qr=()=>n=>(Number(n)||0)>0,Zr=()=>n=>(Number(n)||0)<0,Jr=n=>e=>(Number(e)||0)<n,Sr=n=>e=>(Number(e)||0)<=n,br=n=>e=>(Number(e)||0)>n,xr=n=>e=>(Number(e)||0)>=n,jr=(n,e)=>t=>(Number(t)||0)>=n&&(Number(t)||0)<=e,_r=(n,e)=>t=>(Number(t)||0)>n&&(Number(t)||0)<e,nt=(n,e)=>t=>(Number(t)||0)>=n&&(Number(t)||0)<e,et=(n,e)=>t=>(Number(t)||0)>n&&(Number(t)||0)<=e,rt=n=>e=>!n(e),tt=(...n)=>e=>n.every(t=>t(e)),ot=(...n)=>e=>n.some(t=>t(e)),it=()=>n=>n==null||n==="",ut=n=>e=>e===n,ft=n=>e=>typeof e==typeof n,st=n=>e=>e.length===n,lt=n=>e=>e.length<n,ct=n=>e=>e.length<=n,at=n=>e=>e.length>n,gt=n=>e=>e.length>=n,ht=(n,e)=>t=>t.length>=n&&t.length<=e,dt=(n,e)=>t=>t.length>n&&t.length<e,vt=(n,e)=>t=>t.length>=n&&t.length<e,Et=(n,e)=>t=>t.length>n&&t.length<=e,pt=n=>e=>n(Number(e)),Nt=n=>{if(n.target.value){const e=n.target;return e.value.substring(0,e.selectionStart)+(n.data??"")+e.value.substring(e.selectionEnd)}else{const e=n.target,t=document.getSelection(),r=Math.min(t.anchorOffset,t.focusOffset),i=Math.max(t.anchorOffset,t.focusOffset);return e.innerText.substring(0,r)+(n.data??"")+e.innerText.substring(i)}},Ne=n=>e=>{const t=Nt(e);n(t)||e.preventDefault()};var je={exports:{}};(function(n,e){(function(t,r){n.exports=r()})(qn,function(){var t=function(r,i){var c=Array.prototype.concat,a=Array.prototype.slice,E=Object.prototype.toString;function d(m,p){var w=m>p?m:p;return r.pow(10,17-~~(r.log(w>0?w:-w)*r.LOG10E))}var s=Array.isArray||function(p){return E.call(p)==="[object Array]"};function o(m){return E.call(m)==="[object Function]"}function u(m){return typeof m=="number"?m-m===0:!1}function f(m){return c.apply([],m)}function l(){return new l._init(arguments)}l.fn=l.prototype,l._init=function(p){if(s(p[0]))if(s(p[0][0])){o(p[1])&&(p[0]=l.map(p[0],p[1]));for(var w=0;w<p[0].length;w++)this[w]=p[0][w];this.length=p[0].length}else this[0]=o(p[1])?l.map(p[0],p[1]):p[0],this.length=1;else if(u(p[0]))this[0]=l.seq.apply(null,p),this.length=1;else{if(p[0]instanceof l)return l(p[0].toArray());this[0]=[],this.length=1}return this},l._init.prototype=l.prototype,l._init.constructor=l,l.utils={calcRdx:d,isArray:s,isFunction:o,isNumber:u,toVector:f},l._random_fn=r.random,l.setRandom=function(p){if(typeof p!="function")throw new TypeError("fn is not a function");l._random_fn=p},l.extend=function(p){var w,T;if(arguments.length===1){for(T in p)l[T]=p[T];return this}for(w=1;w<arguments.length;w++)for(T in arguments[w])p[T]=arguments[w][T];return p},l.rows=function(p){return p.length||1},l.cols=function(p){return p[0].length||1},l.dimensions=function(p){return{rows:l.rows(p),cols:l.cols(p)}},l.row=function(p,w){return s(w)?w.map(function(T){return l.row(p,T)}):p[w]},l.rowa=function(p,w){return l.row(p,w)},l.col=function(p,w){if(s(w)){var T=l.arange(p.length).map(function(){return new Array(w.length)});return w.forEach(function(y,P){l.arange(p.length).forEach(function(q){T[q][P]=p[q][y]})}),T}for(var C=new Array(p.length),L=0;L<p.length;L++)C[L]=[p[L][w]];return C},l.cola=function(p,w){return l.col(p,w).map(function(T){return T[0]})},l.diag=function(p){for(var w=l.rows(p),T=new Array(w),C=0;C<w;C++)T[C]=[p[C][C]];return T},l.antidiag=function(p){for(var w=l.rows(p)-1,T=new Array(w),C=0;w>=0;w--,C++)T[C]=[p[C][w]];return T},l.transpose=function(p){var w=[],T,C,L,y,P;for(s(p[0])||(p=[p]),C=p.length,L=p[0].length,P=0;P<L;P++){for(T=new Array(C),y=0;y<C;y++)T[y]=p[y][P];w.push(T)}return w.length===1?w[0]:w},l.map=function(p,w,T){var C,L,y,P,q;for(s(p[0])||(p=[p]),L=p.length,y=p[0].length,P=T?p:new Array(L),C=0;C<L;C++)for(P[C]||(P[C]=new Array(y)),q=0;q<y;q++)P[C][q]=w(p[C][q],C,q);return P.length===1?P[0]:P},l.cumreduce=function(p,w,T){var C,L,y,P,q;for(s(p[0])||(p=[p]),L=p.length,y=p[0].length,P=T?p:new Array(L),C=0;C<L;C++)for(P[C]||(P[C]=new Array(y)),y>0&&(P[C][0]=p[C][0]),q=1;q<y;q++)P[C][q]=w(P[C][q-1],p[C][q]);return P.length===1?P[0]:P},l.alter=function(p,w){return l.map(p,w,!0)},l.create=function(p,w,T){var C=new Array(p),L,y;for(o(w)&&(T=w,w=p),L=0;L<p;L++)for(C[L]=new Array(w),y=0;y<w;y++)C[L][y]=T(L,y);return C};function g(){return 0}l.zeros=function(p,w){return u(w)||(w=p),l.create(p,w,g)};function h(){return 1}l.ones=function(p,w){return u(w)||(w=p),l.create(p,w,h)},l.rand=function(p,w){return u(w)||(w=p),l.create(p,w,l._random_fn)};function v(m,p){return m===p?1:0}l.identity=function(p,w){return u(w)||(w=p),l.create(p,w,v)},l.symmetric=function(p){var w=p.length,T,C;if(p.length!==p[0].length)return!1;for(T=0;T<w;T++)for(C=0;C<w;C++)if(p[C][T]!==p[T][C])return!1;return!0},l.clear=function(p){return l.alter(p,g)},l.seq=function(p,w,T,C){o(C)||(C=!1);var L=[],y=d(p,w),P=(w*y-p*y)/((T-1)*y),q=p,H;for(H=0;q<=w&&H<T;H++,q=(p*y+P*y*H)/y)L.push(C?C(q,H):q);return L},l.arange=function(p,w,T){var C=[],L;if(T=T||1,w===i&&(w=p,p=0),p===w||T===0)return[];if(p<w&&T<0)return[];if(p>w&&T>0)return[];if(T>0)for(L=p;L<w;L+=T)C.push(L);else for(L=p;L>w;L+=T)C.push(L);return C},l.slice=function(){function m(w,T,C,L){var y,P=[],q=w.length;if(T===i&&C===i&&L===i)return l.copy(w);if(T=T||0,C=C||w.length,T=T>=0?T:q+T,C=C>=0?C:q+C,L=L||1,T===C||L===0)return[];if(T<C&&L<0)return[];if(T>C&&L>0)return[];if(L>0)for(y=T;y<C;y+=L)P.push(w[y]);else for(y=T;y>C;y+=L)P.push(w[y]);return P}function p(w,T){var C,L;if(T=T||{},u(T.row)){if(u(T.col))return w[T.row][T.col];var y=l.rowa(w,T.row);return C=T.col||{},m(y,C.start,C.end,C.step)}if(u(T.col)){var P=l.cola(w,T.col);return L=T.row||{},m(P,L.start,L.end,L.step)}L=T.row||{},C=T.col||{};var q=m(w,L.start,L.end,L.step);return q.map(function(H){return m(H,C.start,C.end,C.step)})}return p}(),l.sliceAssign=function(p,w,T){var C,L;if(u(w.row)){if(u(w.col))return p[w.row][w.col]=T;w.col=w.col||{},w.col.start=w.col.start||0,w.col.end=w.col.end||p[0].length,w.col.step=w.col.step||1,C=l.arange(w.col.start,r.min(p.length,w.col.end),w.col.step);var y=w.row;return C.forEach(function(q,H){p[y][q]=T[H]}),p}if(u(w.col)){w.row=w.row||{},w.row.start=w.row.start||0,w.row.end=w.row.end||p.length,w.row.step=w.row.step||1,L=l.arange(w.row.start,r.min(p[0].length,w.row.end),w.row.step);var P=w.col;return L.forEach(function(q,H){p[q][P]=T[H]}),p}return T[0].length===i&&(T=[T]),w.row.start=w.row.start||0,w.row.end=w.row.end||p.length,w.row.step=w.row.step||1,w.col.start=w.col.start||0,w.col.end=w.col.end||p[0].length,w.col.step=w.col.step||1,L=l.arange(w.row.start,r.min(p.length,w.row.end),w.row.step),C=l.arange(w.col.start,r.min(p[0].length,w.col.end),w.col.step),L.forEach(function(q,H){C.forEach(function(Q,z){p[q][Q]=T[H][z]})}),p},l.diagonal=function(p){var w=l.zeros(p.length,p.length);return p.forEach(function(T,C){w[C][C]=T}),w},l.copy=function(p){return p.map(function(w){return u(w)?w:w.map(function(T){return T})})};var I=l.prototype;return I.length=0,I.push=Array.prototype.push,I.sort=Array.prototype.sort,I.splice=Array.prototype.splice,I.slice=Array.prototype.slice,I.toArray=function(){return this.length>1?a.call(this):a.call(this)[0]},I.map=function(p,w){return l(l.map(this,p,w))},I.cumreduce=function(p,w){return l(l.cumreduce(this,p,w))},I.alter=function(p){return l.alter(this,p),this},function(m){for(var p=0;p<m.length;p++)(function(w){I[w]=function(T){var C=this,L;return T?(setTimeout(function(){T.call(C,I[w].call(C))}),this):(L=l[w](this),s(L)?l(L):L)}})(m[p])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(m){for(var p=0;p<m.length;p++)(function(w){I[w]=function(T,C){var L=this;return C?(setTimeout(function(){C.call(L,I[w].call(L,T))}),this):l(l[w](this,T))}})(m[p])}("row col".split(" ")),function(m){for(var p=0;p<m.length;p++)(function(w){I[w]=function(){return l(l[w].apply(null,arguments))}})(m[p])}("create zeros ones rand identity".split(" ")),l}(Math);return function(r,i){var c=r.utils.isFunction;function a(s,o){return s-o}function E(s,o,u){return i.max(o,i.min(s,u))}r.sum=function(o){for(var u=0,f=o.length;--f>=0;)u+=o[f];return u},r.sumsqrd=function(o){for(var u=0,f=o.length;--f>=0;)u+=o[f]*o[f];return u},r.sumsqerr=function(o){for(var u=r.mean(o),f=0,l=o.length,g;--l>=0;)g=o[l]-u,f+=g*g;return f},r.sumrow=function(o){for(var u=0,f=o.length;--f>=0;)u+=o[f];return u},r.product=function(o){for(var u=1,f=o.length;--f>=0;)u*=o[f];return u},r.min=function(o){for(var u=o[0],f=0;++f<o.length;)o[f]<u&&(u=o[f]);return u},r.max=function(o){for(var u=o[0],f=0;++f<o.length;)o[f]>u&&(u=o[f]);return u},r.unique=function(o){for(var u={},f=[],l=0;l<o.length;l++)u[o[l]]||(u[o[l]]=!0,f.push(o[l]));return f},r.mean=function(o){return r.sum(o)/o.length},r.meansqerr=function(o){return r.sumsqerr(o)/o.length},r.geomean=function(o){var u=o.map(i.log),f=r.mean(u);return i.exp(f)},r.median=function(o){var u=o.length,f=o.slice().sort(a);return u&1?f[u/2|0]:(f[u/2-1]+f[u/2])/2},r.cumsum=function(o){return r.cumreduce(o,function(u,f){return u+f})},r.cumprod=function(o){return r.cumreduce(o,function(u,f){return u*f})},r.diff=function(o){var u=[],f=o.length,l;for(l=1;l<f;l++)u.push(o[l]-o[l-1]);return u},r.rank=function(s){var o,u=[],f={};for(o=0;o<s.length;o++){var l=s[o];f[l]?f[l]++:(f[l]=1,u.push(l))}var g=u.sort(a),h={},v=1;for(o=0;o<g.length;o++){var l=g[o],I=f[l],m=v,p=v+I-1,w=(m+p)/2;h[l]=w,v+=I}return s.map(function(T){return h[T]})},r.mode=function(o){var u=o.length,f=o.slice().sort(a),l=1,g=0,h=0,v=[],I;for(I=0;I<u;I++)f[I]===f[I+1]?l++:(l>g?(v=[f[I]],g=l,h=0):l===g&&(v.push(f[I]),h++),l=1);return h===0?v[0]:v},r.range=function(o){return r.max(o)-r.min(o)},r.variance=function(o,u){return r.sumsqerr(o)/(o.length-(u?1:0))},r.pooledvariance=function(o){var u=o.reduce(function(l,g){return l+r.sumsqerr(g)},0),f=o.reduce(function(l,g){return l+g.length},0);return u/(f-o.length)},r.deviation=function(s){for(var o=r.mean(s),u=s.length,f=new Array(u),l=0;l<u;l++)f[l]=s[l]-o;return f},r.stdev=function(o,u){return i.sqrt(r.variance(o,u))},r.pooledstdev=function(o){return i.sqrt(r.pooledvariance(o))},r.meandev=function(o){for(var u=r.mean(o),f=[],l=o.length-1;l>=0;l--)f.push(i.abs(o[l]-u));return r.mean(f)},r.meddev=function(o){for(var u=r.median(o),f=[],l=o.length-1;l>=0;l--)f.push(i.abs(o[l]-u));return r.median(f)},r.coeffvar=function(o){return r.stdev(o)/r.mean(o)},r.quartiles=function(o){var u=o.length,f=o.slice().sort(a);return[f[i.round(u/4)-1],f[i.round(u/2)-1],f[i.round(u*3/4)-1]]},r.quantiles=function(o,u,f,l){var g=o.slice().sort(a),h=[u.length],v=o.length,I,m,p,w,T,C;for(typeof f>"u"&&(f=3/8),typeof l>"u"&&(l=3/8),I=0;I<u.length;I++)m=u[I],p=f+m*(1-f-l),w=v*m+p,T=i.floor(E(w,1,v-1)),C=E(w-T,0,1),h[I]=(1-C)*g[T-1]+C*g[T];return h},r.percentile=function(o,u,f){var l=o.slice().sort(a),g=u*(l.length+(f?1:-1))+(f?0:1),h=parseInt(g),v=g-h;return h+1<l.length?l[h-1]+v*(l[h]-l[h-1]):l[h-1]},r.percentileOfScore=function(o,u,f){var l=0,g=o.length,h=!1,v,I;for(f==="strict"&&(h=!0),I=0;I<g;I++)v=o[I],(h&&v<u||!h&&v<=u)&&l++;return l/g},r.histogram=function(o,u){u=u||4;var f=r.min(o),l=(r.max(o)-f)/u,g=o.length,h=[],v;for(v=0;v<u;v++)h[v]=0;for(v=0;v<g;v++)h[i.min(i.floor((o[v]-f)/l),u-1)]+=1;return h},r.covariance=function(o,u){var f=r.mean(o),l=r.mean(u),g=o.length,h=new Array(g),v;for(v=0;v<g;v++)h[v]=(o[v]-f)*(u[v]-l);return r.sum(h)/(g-1)},r.corrcoeff=function(o,u){return r.covariance(o,u)/r.stdev(o,1)/r.stdev(u,1)},r.spearmancoeff=function(s,o){return s=r.rank(s),o=r.rank(o),r.corrcoeff(s,o)},r.stanMoment=function(o,u){for(var f=r.mean(o),l=r.stdev(o),g=o.length,h=0,v=0;v<g;v++)h+=i.pow((o[v]-f)/l,u);return h/o.length},r.skewness=function(o){return r.stanMoment(o,3)},r.kurtosis=function(o){return r.stanMoment(o,4)-3};var d=r.prototype;(function(s){for(var o=0;o<s.length;o++)(function(u){d[u]=function(f,l){var g=[],h=0,v=this;if(c(f)&&(l=f,f=!1),l)return setTimeout(function(){l.call(v,d[u].call(v,f))}),this;if(this.length>1){for(v=f===!0?this:this.transpose();h<v.length;h++)g[h]=r[u](v[h]);return g}return r[u](this[0],f)}})(s[o])})("cumsum cumprod".split(" ")),function(s){for(var o=0;o<s.length;o++)(function(u){d[u]=function(f,l){var g=[],h=0,v=this;if(c(f)&&(l=f,f=!1),l)return setTimeout(function(){l.call(v,d[u].call(v,f))}),this;if(this.length>1){for(u!=="sumrow"&&(v=f===!0?this:this.transpose());h<v.length;h++)g[h]=r[u](v[h]);return f===!0?r[u](r.utils.toVector(g)):g}return r[u](this[0],f)}})(s[o])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(s){for(var o=0;o<s.length;o++)(function(u){d[u]=function(){var f=[],l=0,g=this,h=Array.prototype.slice.call(arguments),v;if(c(h[h.length-1])){v=h[h.length-1];var I=h.slice(0,h.length-1);return setTimeout(function(){v.call(g,d[u].apply(g,I))}),this}else{v=void 0;var m=function(w){return r[u].apply(g,[w].concat(h))}}if(this.length>1){for(g=g.transpose();l<g.length;l++)f[l]=m(g[l]);return f}return m(this[0])}})(s[o])}("quantiles percentileOfScore".split(" "))}(t,Math),function(r,i){r.gammaln=function(a){var E=0,d=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],s=1.000000000190015,o,u,f;for(f=(u=o=a)+5.5,f-=(o+.5)*i.log(f);E<6;E++)s+=d[E]/++u;return i.log(2.5066282746310007*s/o)-f},r.loggam=function(a){var E,d,s,o,u,f,l,g=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(E=a,l=0,a==1||a==2)return 0;for(a<=7&&(l=i.floor(7-a),E=a+l),d=1/(E*E),s=2*i.PI,u=g[9],f=8;f>=0;f--)u*=d,u+=g[f];if(o=u/E+.5*i.log(s)+(E-.5)*i.log(E)-E,a<=7)for(f=1;f<=l;f++)o-=i.log(E-1),E-=1;return o},r.gammafn=function(a){var E=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],d=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],s=!1,o=0,u=0,f=0,l=a,g,h,v,I;if(a>171.6243769536076)return 1/0;if(l<=0)if(I=l%1+36e-17,I)s=(l&1?-1:1)*i.PI/i.sin(i.PI*I),l=1-l;else return 1/0;for(v=l,l<1?h=l++:h=(l-=o=(l|0)-1)-1,g=0;g<8;++g)f=(f+E[g])*h,u=u*h+d[g];if(I=f/u+1,v<l)I/=v;else if(v>l)for(g=0;g<o;++g)I*=l,l++;return s&&(I=s/I),I},r.gammap=function(a,E){return r.lowRegGamma(a,E)*r.gammafn(a)},r.lowRegGamma=function(a,E){var d=r.gammaln(a),s=a,o=1/a,u=o,f=E+1-a,l=1/1e-30,g=1/f,h=g,v=1,I=-~(i.log(a>=1?a:1/a)*8.5+a*.4+17),m;if(E<0||a<=0)return NaN;if(E<a+1){for(;v<=I;v++)o+=u*=E/++s;return o*i.exp(-E+a*i.log(E)-d)}for(;v<=I;v++)m=-v*(v-a),f+=2,g=m*g+f,l=f+m/l,g=1/g,h*=g*l;return 1-h*i.exp(-E+a*i.log(E)-d)},r.factorialln=function(a){return a<0?NaN:r.gammaln(a+1)},r.factorial=function(a){return a<0?NaN:r.gammafn(a+1)},r.combination=function(a,E){return a>170||E>170?i.exp(r.combinationln(a,E)):r.factorial(a)/r.factorial(E)/r.factorial(a-E)},r.combinationln=function(a,E){return r.factorialln(a)-r.factorialln(E)-r.factorialln(a-E)},r.permutation=function(a,E){return r.factorial(a)/r.factorial(a-E)},r.betafn=function(a,E){if(!(a<=0||E<=0))return a+E>170?i.exp(r.betaln(a,E)):r.gammafn(a)*r.gammafn(E)/r.gammafn(a+E)},r.betaln=function(a,E){return r.gammaln(a)+r.gammaln(E)-r.gammaln(a+E)},r.betacf=function(a,E,d){var s=1e-30,o=1,u=E+d,f=E+1,l=E-1,g=1,h=1-u*a/f,v,I,m,p;for(i.abs(h)<s&&(h=s),h=1/h,p=h;o<=100&&(v=2*o,I=o*(d-o)*a/((l+v)*(E+v)),h=1+I*h,i.abs(h)<s&&(h=s),g=1+I/g,i.abs(g)<s&&(g=s),h=1/h,p*=h*g,I=-(E+o)*(u+o)*a/((E+v)*(f+v)),h=1+I*h,i.abs(h)<s&&(h=s),g=1+I/g,i.abs(g)<s&&(g=s),h=1/h,m=h*g,p*=m,!(i.abs(m-1)<3e-7));o++);return p},r.gammapinv=function(a,E){var d=0,s=E-1,o=1e-8,u=r.gammaln(E),f,l,g,h,v,I,m;if(a>=1)return i.max(100,E+100*i.sqrt(E));if(a<=0)return 0;for(E>1?(I=i.log(s),m=i.exp(s*(I-1)-u),v=a<.5?a:1-a,g=i.sqrt(-2*i.log(v)),f=(2.30753+g*.27061)/(1+g*(.99229+g*.04481))-g,a<.5&&(f=-f),f=i.max(.001,E*i.pow(1-1/(9*E)-f/(3*i.sqrt(E)),3))):(g=1-E*(.253+E*.12),a<g?f=i.pow(a/g,1/E):f=1-i.log(1-(a-g)/(1-g)));d<12;d++){if(f<=0)return 0;if(l=r.lowRegGamma(E,f)-a,E>1?g=m*i.exp(-(f-s)+s*(i.log(f)-I)):g=i.exp(-f+s*i.log(f)-u),h=l/g,f-=g=h/(1-.5*i.min(1,h*((E-1)/f-1))),f<=0&&(f=.5*(f+g)),i.abs(g)<o*f)break}return f},r.erf=function(a){var E=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],d=E.length-1,s=!1,o=0,u=0,f,l,g,h;for(a<0&&(a=-a,s=!0),f=2/(2+a),l=4*f-2;d>0;d--)g=o,o=l*o-u+E[d],u=g;return h=f*i.exp(-a*a+.5*(E[0]+l*o)-u),s?h-1:1-h},r.erfc=function(a){return 1-r.erf(a)},r.erfcinv=function(a){var E=0,d,s,o,u;if(a>=2)return-100;if(a<=0)return 100;for(u=a<1?a:2-a,o=i.sqrt(-2*i.log(u/2)),d=-.70711*((2.30753+o*.27061)/(1+o*(.99229+o*.04481))-o);E<2;E++)s=r.erfc(d)-u,d+=s/(1.1283791670955126*i.exp(-d*d)-d*s);return a<1?d:-d},r.ibetainv=function(a,E,d){var s=1e-8,o=E-1,u=d-1,f=0,l,g,h,v,I,m,p,w,T,C,L;if(a<=0)return 0;if(a>=1)return 1;for(E>=1&&d>=1?(h=a<.5?a:1-a,v=i.sqrt(-2*i.log(h)),p=(2.30753+v*.27061)/(1+v*(.99229+v*.04481))-v,a<.5&&(p=-p),w=(p*p-3)/6,T=2/(1/(2*E-1)+1/(2*d-1)),C=p*i.sqrt(w+T)/T-(1/(2*d-1)-1/(2*E-1))*(w+5/6-2/(3*T)),p=E/(E+d*i.exp(2*C))):(l=i.log(E/(E+d)),g=i.log(d/(E+d)),v=i.exp(E*l)/E,I=i.exp(d*g)/d,C=v+I,a<v/C?p=i.pow(E*C*a,1/E):p=1-i.pow(d*C*(1-a),1/d)),L=-r.gammaln(E)-r.gammaln(d)+r.gammaln(E+d);f<10;f++){if(p===0||p===1)return p;if(m=r.ibeta(p,E,d)-a,v=i.exp(o*i.log(p)+u*i.log(1-p)+L),I=m/v,p-=v=I/(1-.5*i.min(1,I*(o/p-u/(1-p)))),p<=0&&(p=.5*(p+v)),p>=1&&(p=.5*(p+v+1)),i.abs(v)<s*p&&f>0)break}return p},r.ibeta=function(a,E,d){var s=a===0||a===1?0:i.exp(r.gammaln(E+d)-r.gammaln(E)-r.gammaln(d)+E*i.log(a)+d*i.log(1-a));return a<0||a>1?!1:a<(E+1)/(E+d+2)?s*r.betacf(a,E,d)/E:1-s*r.betacf(1-a,d,E)/d},r.randn=function(a,E){var d,s,o,u,f;if(E||(E=a),a)return r.create(a,E,function(){return r.randn()});do d=r._random_fn(),s=1.7156*(r._random_fn()-.5),o=d-.449871,u=i.abs(s)+.386595,f=o*o+u*(.196*u-.25472*o);while(f>.27597&&(f>.27846||s*s>-4*i.log(d)*d*d));return s/d},r.randg=function(a,E,d){var s=a,o,u,f,l,g,h;if(d||(d=E),a||(a=1),E)return h=r.zeros(E,d),h.alter(function(){return r.randg(a)}),h;a<1&&(a+=1),o=a-1/3,u=1/i.sqrt(9*o);do{do g=r.randn(),l=1+u*g;while(l<=0);l=l*l*l,f=r._random_fn()}while(f>1-.331*i.pow(g,4)&&i.log(f)>.5*g*g+o*(1-l+i.log(l)));if(a==s)return o*l;do f=r._random_fn();while(f===0);return i.pow(f,1/s)*o*l},function(c){for(var a=0;a<c.length;a++)(function(E){r.fn[E]=function(){return r(r.map(this,function(d){return r[E](d)}))}})(c[a])}("gammaln gammafn factorial factorialln".split(" ")),function(c){for(var a=0;a<c.length;a++)(function(E){r.fn[E]=function(){return r(r[E].apply(null,arguments))}})(c[a])}("randn".split(" "))}(t,Math),function(r,i){(function(s){for(var o=0;o<s.length;o++)(function(u){r[u]=function f(l,g,h){return this instanceof f?(this._a=l,this._b=g,this._c=h,this):new f(l,g,h)},r.fn[u]=function(f,l,g){var h=r[u](f,l,g);return h.data=this,h},r[u].prototype.sample=function(f){var l=this._a,g=this._b,h=this._c;return f?r.alter(f,function(){return r[u].sample(l,g,h)}):r[u].sample(l,g,h)},function(f){for(var l=0;l<f.length;l++)(function(g){r[u].prototype[g]=function(h){var v=this._a,I=this._b,m=this._c;return!h&&h!==0&&(h=this.data),typeof h!="number"?r.fn.map.call(h,function(p){return r[u][g](p,v,I,m)}):r[u][g](h,v,I,m)}})(f[l])}("pdf cdf inv".split(" ")),function(f){for(var l=0;l<f.length;l++)(function(g){r[u].prototype[g]=function(){return r[u][g](this._a,this._b,this._c)}})(f[l])}("mean median mode variance".split(" "))})(s[o])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),r.extend(r.beta,{pdf:function(o,u,f){return o>1||o<0?0:u==1&&f==1?1:u<512&&f<512?i.pow(o,u-1)*i.pow(1-o,f-1)/r.betafn(u,f):i.exp((u-1)*i.log(o)+(f-1)*i.log(1-o)-r.betaln(u,f))},cdf:function(o,u,f){return o>1||o<0?(o>1)*1:r.ibeta(o,u,f)},inv:function(o,u,f){return r.ibetainv(o,u,f)},mean:function(o,u){return o/(o+u)},median:function(o,u){return r.ibetainv(.5,o,u)},mode:function(o,u){return(o-1)/(o+u-2)},sample:function(o,u){var f=r.randg(o);return f/(f+r.randg(u))},variance:function(o,u){return o*u/(i.pow(o+u,2)*(o+u+1))}}),r.extend(r.centralF,{pdf:function(o,u,f){var l,g,h;return o<0?0:u<=2?o===0&&u<2?1/0:o===0&&u===2?1:1/r.betafn(u/2,f/2)*i.pow(u/f,u/2)*i.pow(o,u/2-1)*i.pow(1+u/f*o,-(u+f)/2):(l=u*o/(f+o*u),g=f/(f+o*u),h=u*g/2,h*r.binomial.pdf((u-2)/2,(u+f-2)/2,l))},cdf:function(o,u,f){return o<0?0:r.ibeta(u*o/(u*o+f),u/2,f/2)},inv:function(o,u,f){return f/(u*(1/r.ibetainv(o,u/2,f/2)-1))},mean:function(o,u){return u>2?u/(u-2):void 0},mode:function(o,u){return o>2?u*(o-2)/(o*(u+2)):void 0},sample:function(o,u){var f=r.randg(o/2)*2,l=r.randg(u/2)*2;return f/o/(l/u)},variance:function(o,u){if(!(u<=4))return 2*u*u*(o+u-2)/(o*(u-2)*(u-2)*(u-4))}}),r.extend(r.cauchy,{pdf:function(o,u,f){return f<0?0:f/(i.pow(o-u,2)+i.pow(f,2))/i.PI},cdf:function(o,u,f){return i.atan((o-u)/f)/i.PI+.5},inv:function(s,o,u){return o+u*i.tan(i.PI*(s-.5))},median:function(o){return o},mode:function(o){return o},sample:function(o,u){return r.randn()*i.sqrt(1/(2*r.randg(.5)))*u+o}}),r.extend(r.chisquare,{pdf:function(o,u){return o<0?0:o===0&&u===2?.5:i.exp((u/2-1)*i.log(o)-o/2-u/2*i.log(2)-r.gammaln(u/2))},cdf:function(o,u){return o<0?0:r.lowRegGamma(u/2,o/2)},inv:function(s,o){return 2*r.gammapinv(s,.5*o)},mean:function(s){return s},median:function(o){return o*i.pow(1-2/(9*o),3)},mode:function(o){return o-2>0?o-2:0},sample:function(o){return r.randg(o/2)*2},variance:function(o){return 2*o}}),r.extend(r.exponential,{pdf:function(o,u){return o<0?0:u*i.exp(-u*o)},cdf:function(o,u){return o<0?0:1-i.exp(-u*o)},inv:function(s,o){return-i.log(1-s)/o},mean:function(s){return 1/s},median:function(s){return 1/s*i.log(2)},mode:function(){return 0},sample:function(o){return-1/o*i.log(r._random_fn())},variance:function(s){return i.pow(s,-2)}}),r.extend(r.gamma,{pdf:function(o,u,f){return o<0?0:o===0&&u===1?1/f:i.exp((u-1)*i.log(o)-o/f-r.gammaln(u)-u*i.log(f))},cdf:function(o,u,f){return o<0?0:r.lowRegGamma(u,o/f)},inv:function(s,o,u){return r.gammapinv(s,o)*u},mean:function(s,o){return s*o},mode:function(o,u){if(o>1)return(o-1)*u},sample:function(o,u){return r.randg(o)*u},variance:function(o,u){return o*u*u}}),r.extend(r.invgamma,{pdf:function(o,u,f){return o<=0?0:i.exp(-(u+1)*i.log(o)-f/o-r.gammaln(u)+u*i.log(f))},cdf:function(o,u,f){return o<=0?0:1-r.lowRegGamma(u,f/o)},inv:function(s,o,u){return u/r.gammapinv(1-s,o)},mean:function(s,o){return s>1?o/(s-1):void 0},mode:function(o,u){return u/(o+1)},sample:function(o,u){return u/r.randg(o)},variance:function(o,u){if(!(o<=2))return u*u/((o-1)*(o-1)*(o-2))}}),r.extend(r.kumaraswamy,{pdf:function(o,u,f){return o===0&&u===1?f:o===1&&f===1?u:i.exp(i.log(u)+i.log(f)+(u-1)*i.log(o)+(f-1)*i.log(1-i.pow(o,u)))},cdf:function(o,u,f){return o<0?0:o>1?1:1-i.pow(1-i.pow(o,u),f)},inv:function(o,u,f){return i.pow(1-i.pow(1-o,1/f),1/u)},mean:function(s,o){return o*r.gammafn(1+1/s)*r.gammafn(o)/r.gammafn(1+1/s+o)},median:function(o,u){return i.pow(1-i.pow(2,-1/u),1/o)},mode:function(o,u){if(o>=1&&u>=1&&o!==1&&u!==1)return i.pow((o-1)/(o*u-1),1/o)},variance:function(){throw new Error("variance not yet implemented")}}),r.extend(r.lognormal,{pdf:function(o,u,f){return o<=0?0:i.exp(-i.log(o)-.5*i.log(2*i.PI)-i.log(f)-i.pow(i.log(o)-u,2)/(2*f*f))},cdf:function(o,u,f){return o<0?0:.5+.5*r.erf((i.log(o)-u)/i.sqrt(2*f*f))},inv:function(s,o,u){return i.exp(-1.4142135623730951*u*r.erfcinv(2*s)+o)},mean:function(o,u){return i.exp(o+u*u/2)},median:function(o){return i.exp(o)},mode:function(o,u){return i.exp(o-u*u)},sample:function(o,u){return i.exp(r.randn()*u+o)},variance:function(o,u){return(i.exp(u*u)-1)*i.exp(2*o+u*u)}}),r.extend(r.noncentralt,{pdf:function(o,u,f){var l=1e-14;return i.abs(f)<l?r.studentt.pdf(o,u):i.abs(o)<l?i.exp(r.gammaln((u+1)/2)-f*f/2-.5*i.log(i.PI*u)-r.gammaln(u/2)):u/o*(r.noncentralt.cdf(o*i.sqrt(1+2/u),u+2,f)-r.noncentralt.cdf(o,u,f))},cdf:function(o,u,f){var l=1e-14,g=200;if(i.abs(f)<l)return r.studentt.cdf(o,u);var h=!1;o<0&&(h=!0,f=-f);for(var v=r.normal.cdf(-f,0,1),I=l+1,m=I,p=o*o/(o*o+u),w=0,T=i.exp(-f*f/2),C=i.exp(-f*f/2-.5*i.log(2)-r.gammaln(3/2))*f;w<g||m>l||I>l;)m=I,w>0&&(T*=f*f/(2*w),C*=f*f/(2*(w+1/2))),I=T*r.beta.cdf(p,w+.5,u/2)+C*r.beta.cdf(p,w+1,u/2),v+=.5*I,w++;return h?1-v:v}}),r.extend(r.normal,{pdf:function(o,u,f){return i.exp(-.5*i.log(2*i.PI)-i.log(f)-i.pow(o-u,2)/(2*f*f))},cdf:function(o,u,f){return .5*(1+r.erf((o-u)/i.sqrt(2*f*f)))},inv:function(s,o,u){return-1.4142135623730951*u*r.erfcinv(2*s)+o},mean:function(s){return s},median:function(o){return o},mode:function(s){return s},sample:function(o,u){return r.randn()*u+o},variance:function(s,o){return o*o}}),r.extend(r.pareto,{pdf:function(o,u,f){return o<u?0:f*i.pow(u,f)/i.pow(o,f+1)},cdf:function(o,u,f){return o<u?0:1-i.pow(u/o,f)},inv:function(o,u,f){return u/i.pow(1-o,1/f)},mean:function(o,u){if(!(u<=1))return u*i.pow(o,u)/(u-1)},median:function(o,u){return o*(u*i.SQRT2)},mode:function(o){return o},variance:function(s,o){if(!(o<=2))return s*s*o/(i.pow(o-1,2)*(o-2))}}),r.extend(r.studentt,{pdf:function(o,u){return u=u>1e100?1e100:u,1/(i.sqrt(u)*r.betafn(.5,u/2))*i.pow(1+o*o/u,-((u+1)/2))},cdf:function(o,u){var f=u/2;return r.ibeta((o+i.sqrt(o*o+u))/(2*i.sqrt(o*o+u)),f,f)},inv:function(s,o){var u=r.ibetainv(2*i.min(s,1-s),.5*o,.5);return u=i.sqrt(o*(1-u)/u),s>.5?u:-u},mean:function(o){return o>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(o){return r.randn()*i.sqrt(o/(2*r.randg(o/2)))},variance:function(o){return o>2?o/(o-2):o>1?1/0:void 0}}),r.extend(r.weibull,{pdf:function(o,u,f){return o<0||u<0||f<0?0:f/u*i.pow(o/u,f-1)*i.exp(-i.pow(o/u,f))},cdf:function(o,u,f){return o<0?0:1-i.exp(-i.pow(o/u,f))},inv:function(s,o,u){return o*i.pow(-i.log(1-s),1/u)},mean:function(s,o){return s*r.gammafn(1+1/o)},median:function(o,u){return o*i.pow(i.log(2),1/u)},mode:function(o,u){return u<=1?0:o*i.pow((u-1)/u,1/u)},sample:function(o,u){return o*i.pow(-i.log(r._random_fn()),1/u)},variance:function(o,u){return o*o*r.gammafn(1+2/u)-i.pow(r.weibull.mean(o,u),2)}}),r.extend(r.uniform,{pdf:function(o,u,f){return o<u||o>f?0:1/(f-u)},cdf:function(o,u,f){return o<u?0:o<f?(o-u)/(f-u):1},inv:function(s,o,u){return o+s*(u-o)},mean:function(o,u){return .5*(o+u)},median:function(o,u){return r.mean(o,u)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(o,u){return o/2+u/2+(u/2-o/2)*(2*r._random_fn()-1)},variance:function(o,u){return i.pow(u-o,2)/12}});function c(s,o,u,f){for(var l=0,g=1,h=1,v=1,I=0,m=0,p;i.abs((h-m)/h)>f;)m=h,p=-(o+I)*(o+u+I)*s/(o+2*I)/(o+2*I+1),l=h+p*l,g=v+p*g,I=I+1,p=I*(u-I)*s/(o+2*I-1)/(o+2*I),h=l+p*h,v=g+p*v,l=l/v,g=g/v,h=h/v,v=1;return h/o}r.extend(r.binomial,{pdf:function(o,u,f){return f===0||f===1?u*f===o?1:0:r.combination(u,o)*i.pow(f,o)*i.pow(1-f,u-o)},cdf:function(o,u,f){var l,g=1e-10;if(o<0)return 0;if(o>=u)return 1;if(f<0||f>1||u<=0)return NaN;o=i.floor(o);var h=f,v=o+1,I=u-o,m=v+I,p=i.exp(r.gammaln(m)-r.gammaln(I)-r.gammaln(v)+v*i.log(h)+I*i.log(1-h));return h<(v+1)/(m+2)?l=p*c(h,v,I,g):l=1-p*c(1-h,I,v,g),i.round((1-l)*(1/g))/(1/g)}}),r.extend(r.negbin,{pdf:function(o,u,f){return o!==o>>>0?!1:o<0?0:r.combination(o+u-1,u-1)*i.pow(1-f,o)*i.pow(f,u)},cdf:function(o,u,f){var l=0,g=0;if(o<0)return 0;for(;g<=o;g++)l+=r.negbin.pdf(g,u,f);return l}}),r.extend(r.hypgeom,{pdf:function(o,u,f,l){if(o!==o|0)return!1;if(o<0||o<f-(u-l))return 0;if(o>l||o>f)return 0;if(f*2>u)return l*2>u?r.hypgeom.pdf(u-f-l+o,u,u-f,u-l):r.hypgeom.pdf(l-o,u,u-f,l);if(l*2>u)return r.hypgeom.pdf(f-o,u,f,u-l);if(f<l)return r.hypgeom.pdf(o,u,l,f);for(var g=1,h=0,v=0;v<o;v++){for(;g>1&&h<l;)g*=1-f/(u-h),h++;g*=(l-v)*(f-v)/((v+1)*(u-f-l+v+1))}for(;h<l;h++)g*=1-f/(u-h);return i.min(1,i.max(0,g))},cdf:function(o,u,f,l){if(o<0||o<f-(u-l))return 0;if(o>=l||o>=f)return 1;if(f*2>u)return l*2>u?r.hypgeom.cdf(u-f-l+o,u,u-f,u-l):1-r.hypgeom.cdf(l-o-1,u,u-f,l);if(l*2>u)return 1-r.hypgeom.cdf(f-o-1,u,f,u-l);if(f<l)return r.hypgeom.cdf(o,u,l,f);for(var g=1,h=1,v=0,I=0;I<o;I++){for(;g>1&&v<l;){var m=1-f/(u-v);h*=m,g*=m,v++}h*=(l-I)*(f-I)/((I+1)*(u-f-l+I+1)),g+=h}for(;v<l;v++)g*=1-f/(u-v);return i.min(1,i.max(0,g))}}),r.extend(r.poisson,{pdf:function(o,u){return u<0||o%1!==0||o<0?0:i.pow(u,o)*i.exp(-u)/r.factorial(o)},cdf:function(o,u){var f=[],l=0;if(o<0)return 0;for(;l<=o;l++)f.push(r.poisson.pdf(l,u));return r.sum(f)},mean:function(s){return s},variance:function(s){return s},sampleSmall:function(o){var u=1,f=0,l=i.exp(-o);do f++,u*=r._random_fn();while(u>l);return f-1},sampleLarge:function(o){var u=o,f,l,g,h,v,I,m,p,w,T;for(h=i.sqrt(u),v=i.log(u),m=.931+2.53*h,I=-.059+.02483*m,p=1.1239+1.1328/(m-3.4),w=.9277-3.6224/(m-2);;){if(l=i.random()-.5,g=i.random(),T=.5-i.abs(l),f=i.floor((2*I/T+m)*l+u+.43),T>=.07&&g<=w)return f;if(!(f<0||T<.013&&g>T)&&i.log(g)+i.log(p)-i.log(I/(T*T)+m)<=-u+f*v-r.loggam(f+1))return f}},sample:function(o){return o<10?this.sampleSmall(o):this.sampleLarge(o)}}),r.extend(r.triangular,{pdf:function(o,u,f,l){return f<=u||l<u||l>f?NaN:o<u||o>f?0:o<l?2*(o-u)/((f-u)*(l-u)):o===l?2/(f-u):2*(f-o)/((f-u)*(f-l))},cdf:function(o,u,f,l){return f<=u||l<u||l>f?NaN:o<=u?0:o>=f?1:o<=l?i.pow(o-u,2)/((f-u)*(l-u)):1-i.pow(f-o,2)/((f-u)*(f-l))},inv:function(o,u,f,l){return f<=u||l<u||l>f?NaN:o<=(l-u)/(f-u)?u+(f-u)*i.sqrt(o*((l-u)/(f-u))):u+(f-u)*(1-i.sqrt((1-o)*(1-(l-u)/(f-u))))},mean:function(o,u,f){return(o+u+f)/3},median:function(o,u,f){if(f<=(o+u)/2)return u-i.sqrt((u-o)*(u-f))/i.sqrt(2);if(f>(o+u)/2)return o+i.sqrt((u-o)*(f-o))/i.sqrt(2)},mode:function(o,u,f){return f},sample:function(o,u,f){var l=r._random_fn();return l<(f-o)/(u-o)?o+i.sqrt(l*(u-o)*(f-o)):u-i.sqrt((1-l)*(u-o)*(u-f))},variance:function(o,u,f){return(o*o+u*u+f*f-o*u-o*f-u*f)/18}}),r.extend(r.arcsine,{pdf:function(o,u,f){return f<=u?NaN:o<=u||o>=f?0:2/i.PI*i.pow(i.pow(f-u,2)-i.pow(2*o-u-f,2),-.5)},cdf:function(o,u,f){return o<u?0:o<f?2/i.PI*i.asin(i.sqrt((o-u)/(f-u))):1},inv:function(s,o,u){return o+(.5-.5*i.cos(i.PI*s))*(u-o)},mean:function(o,u){return u<=o?NaN:(o+u)/2},median:function(o,u){return u<=o?NaN:(o+u)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(o,u){return(o+u)/2+(u-o)/2*i.sin(2*i.PI*r.uniform.sample(0,1))},variance:function(o,u){return u<=o?NaN:i.pow(u-o,2)/8}});function a(s){return s/i.abs(s)}r.extend(r.laplace,{pdf:function(o,u,f){return f<=0?0:i.exp(-i.abs(o-u)/f)/(2*f)},cdf:function(o,u,f){return f<=0?0:o<u?.5*i.exp((o-u)/f):1-.5*i.exp(-(o-u)/f)},mean:function(s){return s},median:function(s){return s},mode:function(s){return s},variance:function(s,o){return 2*o*o},sample:function(o,u){var f=r._random_fn()-.5;return o-u*a(f)*i.log(1-2*i.abs(f))}});function E(s,o,u){var f=12,l=6,g=-30,h=-50,v=60,I=8,m=3,p=2,w=3,T=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],C=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],L=s*.5;if(L>=I)return 1;var y=2*r.normal.cdf(L,0,1,1,0)-1;y>=i.exp(h/u)?y=i.pow(y,u):y=0;var P;s>m?P=p:P=w;for(var q=L,H=(I-L)/P,Q=q+H,z=0,X=u-1,gn=1;gn<=P;gn++){for(var ln=0,x=.5*(Q+q),Vn=.5*(Q-q),hn=1;hn<=f;hn++){var dn,vn;l<hn?(dn=f-hn+1,vn=T[dn-1]):(dn=hn,vn=-T[dn-1]);var wn=Vn*vn,_=x+wn,Bn=_*_;if(Bn>v)break;var xn=2*r.normal.cdf(_,0,1,1,0),Ze=2*r.normal.cdf(_,s,1,1,0),zn=xn*.5-Ze*.5;zn>=i.exp(g/X)&&(zn=C[dn-1]*i.exp(-(.5*Bn))*i.pow(zn,X),ln+=zn)}ln*=2*Vn*u/i.sqrt(2*i.PI),z+=ln,q=Q,Q+=H}return y+=z,y<=i.exp(g/o)?0:(y=i.pow(y,o),y>=1?1:y)}function d(s,o,u){var f=.322232421088,l=.099348462606,g=-1,h=.588581570495,v=-.342242088547,I=.531103462366,m=-.204231210125,p=.10353775285,w=-453642210148e-16,T=.0038560700634,C=.8832,L=.2368,y=1.214,P=1.208,q=1.4142,H=120,Q=.5-.5*s,z=i.sqrt(i.log(1/(Q*Q))),X=z+((((z*w+m)*z+v)*z+g)*z+f)/((((z*T+p)*z+I)*z+h)*z+l);u<H&&(X+=(X*X*X+X)/u/4);var gn=C-L*X;return u<H&&(gn+=-y/u+P*X/u),X*(gn*i.log(o-1)+q)}r.extend(r.tukey,{cdf:function(o,u,f){var l=1,g=u,h=16,v=8,I=-30,m=1e-14,p=100,w=800,T=5e3,C=25e3,L=1,y=.5,P=.25,q=.125,H=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],Q=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(o<=0)return 0;if(f<2||l<1||g<2)return NaN;if(!Number.isFinite(o))return 1;if(f>C)return E(o,l,g);var z=f*.5,X=z*i.log(f)-f*i.log(2)-r.gammaln(z),gn=z-1,ln=f*.25,x;f<=p?x=L:f<=w?x=y:f<=T?x=P:x=q,X+=i.log(x);for(var Vn=0,hn=1;hn<=50;hn++){for(var dn=0,vn=(2*hn-1)*x,wn=1;wn<=h;wn++){var _,Bn;v<wn?(_=wn-v-1,Bn=X+gn*i.log(vn+H[_]*x)-(H[_]*x+vn)*ln):(_=wn-1,Bn=X+gn*i.log(vn-H[_]*x)+(H[_]*x-vn)*ln);var xn;if(Bn>=I){v<wn?xn=o*i.sqrt((H[_]*x+vn)*.5):xn=o*i.sqrt((-(H[_]*x)+vn)*.5);var Ze=E(xn,l,g),zn=Ze*Q[_]*i.exp(Bn);dn+=zn}}if(hn*x>=1&&dn<=m)break;Vn+=dn}if(dn>m)throw new Error("tukey.cdf failed to converge");return Vn>1&&(Vn=1),Vn},inv:function(s,o,u){var f=1,l=o,g=1e-4,h=50;if(u<2||f<1||l<2)return NaN;if(s<0||s>1)return NaN;if(s===0)return 0;if(s===1)return 1/0;var v=d(s,l,u),I=r.tukey.cdf(v,o,u)-s,m;I>0?m=i.max(0,v-1):m=v+1;for(var p=r.tukey.cdf(m,o,u)-s,w,T=1;T<h;T++){w=m-p*(m-v)/(p-I),I=p,v=m,w<0&&(w=0,p=-s),p=r.tukey.cdf(w,o,u)-s,m=w;var C=i.abs(m-v);if(C<g)return w}throw new Error("tukey.inv failed to converge")}})}(t,Math),function(r,i){var c=Array.prototype.push,a=r.utils.isArray;function E(d){return a(d)||d instanceof r}r.extend({add:function(s,o){return E(o)?(E(o[0])||(o=[o]),r.map(s,function(u,f,l){return u+o[f][l]})):r.map(s,function(u){return u+o})},subtract:function(s,o){return E(o)?(E(o[0])||(o=[o]),r.map(s,function(u,f,l){return u-o[f][l]||0})):r.map(s,function(u){return u-o})},divide:function(s,o){return E(o)?(E(o[0])||(o=[o]),r.multiply(s,r.inv(o))):r.map(s,function(u){return u/o})},multiply:function(s,o){var u,f,l,g,h,v,I,m;if(s.length===void 0&&o.length===void 0)return s*o;if(h=s.length,v=s[0].length,I=r.zeros(h,l=E(o)?o[0].length:v),m=0,E(o)){for(;m<l;m++)for(u=0;u<h;u++){for(g=0,f=0;f<v;f++)g+=s[u][f]*o[f][m];I[u][m]=g}return h===1&&m===1?I[0][0]:I}return r.map(s,function(p){return p*o})},outer:function(s,o){return r.multiply(s.map(function(u){return[u]}),[o])},dot:function(s,o){E(s[0])||(s=[s]),E(o[0])||(o=[o]);for(var u=s[0].length===1&&s.length!==1?r.transpose(s):s,f=o[0].length===1&&o.length!==1?r.transpose(o):o,l=[],g=0,h=u.length,v=u[0].length,I,m;g<h;g++){for(l[g]=[],I=0,m=0;m<v;m++)I+=u[g][m]*f[g][m];l[g]=I}return l.length===1?l[0]:l},pow:function(s,o){return r.map(s,function(u){return i.pow(u,o)})},exp:function(s){return r.map(s,function(o){return i.exp(o)})},log:function(s){return r.map(s,function(o){return i.log(o)})},abs:function(s){return r.map(s,function(o){return i.abs(o)})},norm:function(s,o){var u=0,f=0;for(isNaN(o)&&(o=2),E(s[0])&&(s=s[0]);f<s.length;f++)u+=i.pow(i.abs(s[f]),o);return i.pow(u,1/o)},angle:function(s,o){return i.acos(r.dot(s,o)/(r.norm(s)*r.norm(o)))},aug:function(s,o){var u=[],f;for(f=0;f<s.length;f++)u.push(s[f].slice());for(f=0;f<u.length;f++)c.apply(u[f],o[f]);return u},inv:function(s){for(var o=s.length,u=s[0].length,f=r.identity(o,u),l=r.gauss_jordan(s,f),g=[],h=0,v;h<o;h++)for(g[h]=[],v=u;v<l[0].length;v++)g[h][v-u]=l[h][v];return g},det:function d(s){if(s.length===2)return s[0][0]*s[1][1]-s[0][1]*s[1][0];for(var o=0,u=0;u<s.length;u++){for(var f=[],l=1;l<s.length;l++){f[l-1]=[];for(var g=0;g<s.length;g++)g<u?f[l-1][g]=s[l][g]:g>u&&(f[l-1][g-1]=s[l][g])}var h=u%2?-1:1;o+=d(f)*s[0][u]*h}return o},gauss_elimination:function(s,o){var u=0,f=0,l=s.length,g=s[0].length,h=1,v=0,I=[],m,p,w,T;for(s=r.aug(s,o),m=s[0].length,u=0;u<l;u++){for(p=s[u][u],f=u,T=u+1;T<g;T++)p<i.abs(s[T][u])&&(p=s[T][u],f=T);if(f!=u)for(T=0;T<m;T++)w=s[u][T],s[u][T]=s[f][T],s[f][T]=w;for(f=u+1;f<l;f++)for(h=s[f][u]/s[u][u],T=u;T<m;T++)s[f][T]=s[f][T]-h*s[u][T]}for(u=l-1;u>=0;u--){for(v=0,f=u+1;f<=l-1;f++)v=v+I[f]*s[u][f];I[u]=(s[u][m-1]-v)/s[u][u]}return I},gauss_jordan:function(s,o){var u=r.aug(s,o),f=u.length,l=u[0].length,g=0,h,v,I;for(v=0;v<f;v++){var m=v;for(I=v+1;I<f;I++)i.abs(u[I][v])>i.abs(u[m][v])&&(m=I);var p=u[v];for(u[v]=u[m],u[m]=p,I=v+1;I<f;I++)for(g=u[I][v]/u[v][v],h=v;h<l;h++)u[I][h]-=u[v][h]*g}for(v=f-1;v>=0;v--){for(g=u[v][v],I=0;I<v;I++)for(h=l-1;h>v-1;h--)u[I][h]-=u[v][h]*u[I][v]/g;for(u[v][v]/=g,h=f;h<l;h++)u[v][h]/=g}return u},triaUpSolve:function(s,o){var u=s[0].length,f=r.zeros(1,u)[0],l,g=!1;return o[0].length!=null&&(o=o.map(function(h){return h[0]}),g=!0),r.arange(u-1,-1,-1).forEach(function(h){l=r.arange(h+1,u).map(function(v){return f[v]*s[h][v]}),f[h]=(o[h]-r.sum(l))/s[h][h]}),g?f.map(function(h){return[h]}):f},triaLowSolve:function(s,o){var u=s[0].length,f=r.zeros(1,u)[0],l,g=!1;return o[0].length!=null&&(o=o.map(function(h){return h[0]}),g=!0),r.arange(u).forEach(function(h){l=r.arange(h).map(function(v){return s[h][v]*f[v]}),f[h]=(o[h]-r.sum(l))/s[h][h]}),g?f.map(function(h){return[h]}):f},lu:function(s){var o=s.length,u=r.identity(o),f=r.zeros(s.length,s[0].length),l;return r.arange(o).forEach(function(g){f[0][g]=s[0][g]}),r.arange(1,o).forEach(function(g){r.arange(g).forEach(function(h){l=r.arange(h).map(function(v){return u[g][v]*f[v][h]}),u[g][h]=(s[g][h]-r.sum(l))/f[h][h]}),r.arange(g,o).forEach(function(h){l=r.arange(g).map(function(v){return u[g][v]*f[v][h]}),f[g][h]=s[l.length][h]-r.sum(l)})}),[u,f]},cholesky:function(s){var o=s.length,u=r.zeros(s.length,s[0].length),f;return r.arange(o).forEach(function(l){f=r.arange(l).map(function(g){return i.pow(u[l][g],2)}),u[l][l]=i.sqrt(s[l][l]-r.sum(f)),r.arange(l+1,o).forEach(function(g){f=r.arange(l).map(function(h){return u[l][h]*u[g][h]}),u[g][l]=(s[l][g]-r.sum(f))/u[l][l]})}),u},gauss_jacobi:function(s,o,u,f){for(var l=0,g=0,h=s.length,v=[],I=[],m=[],p,w,T,C;l<h;l++)for(v[l]=[],I[l]=[],m[l]=[],g=0;g<h;g++)l>g?(v[l][g]=s[l][g],I[l][g]=m[l][g]=0):l<g?(I[l][g]=s[l][g],v[l][g]=m[l][g]=0):(m[l][g]=s[l][g],v[l][g]=I[l][g]=0);for(T=r.multiply(r.multiply(r.inv(m),r.add(v,I)),-1),w=r.multiply(r.inv(m),o),p=u,C=r.add(r.multiply(T,u),w),l=2;i.abs(r.norm(r.subtract(C,p)))>f;)p=C,C=r.add(r.multiply(T,p),w),l++;return C},gauss_seidel:function(s,o,u,f){for(var l=0,g=s.length,h=[],v=[],I=[],m,p,w,T,C;l<g;l++)for(h[l]=[],v[l]=[],I[l]=[],m=0;m<g;m++)l>m?(h[l][m]=s[l][m],v[l][m]=I[l][m]=0):l<m?(v[l][m]=s[l][m],h[l][m]=I[l][m]=0):(I[l][m]=s[l][m],h[l][m]=v[l][m]=0);for(T=r.multiply(r.multiply(r.inv(r.add(I,h)),v),-1),w=r.multiply(r.inv(r.add(I,h)),o),p=u,C=r.add(r.multiply(T,u),w),l=2;i.abs(r.norm(r.subtract(C,p)))>f;)p=C,C=r.add(r.multiply(T,p),w),l=l+1;return C},SOR:function(s,o,u,f,l){for(var g=0,h=s.length,v=[],I=[],m=[],p,w,T,C,L;g<h;g++)for(v[g]=[],I[g]=[],m[g]=[],p=0;p<h;p++)g>p?(v[g][p]=s[g][p],I[g][p]=m[g][p]=0):g<p?(I[g][p]=s[g][p],v[g][p]=m[g][p]=0):(m[g][p]=s[g][p],v[g][p]=I[g][p]=0);for(C=r.multiply(r.inv(r.add(m,r.multiply(v,l))),r.subtract(r.multiply(m,1-l),r.multiply(I,l))),T=r.multiply(r.multiply(r.inv(r.add(m,r.multiply(v,l))),o),l),w=u,L=r.add(r.multiply(C,u),T),g=2;i.abs(r.norm(r.subtract(L,w)))>f;)w=L,L=r.add(r.multiply(C,w),T),g++;return L},householder:function(s){for(var o=s.length,u=s[0].length,f=0,l=[],g=[],h,v,I,m,p;f<o-1;f++){for(h=0,m=f+1;m<u;m++)h+=s[m][f]*s[m][f];for(p=s[f+1][f]>0?-1:1,h=p*i.sqrt(h),v=i.sqrt((h*h-s[f+1][f]*h)/2),l=r.zeros(o,1),l[f+1][0]=(s[f+1][f]-h)/(2*v),I=f+2;I<o;I++)l[I][0]=s[I][f]/(2*v);g=r.subtract(r.identity(o,u),r.multiply(r.multiply(l,r.transpose(l)),2)),s=r.multiply(g,r.multiply(s,g))}return s},QR:function(){var d=r.sum,s=r.arange;function o(u){var f=u.length,l=u[0].length,g=r.zeros(l,l);u=r.copy(u);var h,v,I;for(v=0;v<l;v++){for(g[v][v]=i.sqrt(d(s(f).map(function(m){return u[m][v]*u[m][v]}))),h=0;h<f;h++)u[h][v]=u[h][v]/g[v][v];for(I=v+1;I<l;I++)for(g[v][I]=d(s(f).map(function(m){return u[m][v]*u[m][I]})),h=0;h<f;h++)u[h][I]=u[h][I]-u[h][v]*g[v][I]}return[u,g]}return o}(),lstsq:function(){function d(o){o=r.copy(o);var u=o.length,f=r.identity(u);return r.arange(u-1,-1,-1).forEach(function(l){r.sliceAssign(f,{row:l},r.divide(r.slice(f,{row:l}),o[l][l])),r.sliceAssign(o,{row:l},r.divide(r.slice(o,{row:l}),o[l][l])),r.arange(l).forEach(function(g){var h=r.multiply(o[g][l],-1),v=r.slice(o,{row:g}),I=r.multiply(r.slice(o,{row:l}),h);r.sliceAssign(o,{row:g},r.add(v,I));var m=r.slice(f,{row:g}),p=r.multiply(r.slice(f,{row:l}),h);r.sliceAssign(f,{row:g},r.add(m,p))})}),f}function s(o,u){var f=!1;u[0].length===void 0&&(u=u.map(function(C){return[C]}),f=!0);var l=r.QR(o),g=l[0],h=l[1],v=o[0].length,I=r.slice(g,{col:{end:v}}),m=r.slice(h,{row:{end:v}}),p=d(m),w=r.transpose(I);w[0].length===void 0&&(w=[w]);var T=r.multiply(r.multiply(p,w),u);return T.length===void 0&&(T=[[T]]),f?T.map(function(C){return C[0]}):T}return s}(),jacobi:function(s){for(var o=1,u=s.length,f=r.identity(u,u),l=[],g,h,v,I,m,p,w,T;o===1;){for(p=s[0][1],I=0,m=1,h=0;h<u;h++)for(v=0;v<u;v++)h!=v&&p<i.abs(s[h][v])&&(p=i.abs(s[h][v]),I=h,m=v);for(s[I][I]===s[m][m]?w=s[I][m]>0?i.PI/4:-i.PI/4:w=i.atan(2*s[I][m]/(s[I][I]-s[m][m]))/2,T=r.identity(u,u),T[I][I]=i.cos(w),T[I][m]=-i.sin(w),T[m][I]=i.sin(w),T[m][m]=i.cos(w),f=r.multiply(f,T),g=r.multiply(r.multiply(r.inv(T),s),T),s=g,o=0,h=1;h<u;h++)for(v=1;v<u;v++)h!=v&&i.abs(s[h][v])>.001&&(o=1)}for(h=0;h<u;h++)l.push(s[h][h]);return[f,l]},rungekutta:function(s,o,u,f,l,g){var h,v,I,m,p;if(g===2)for(;f<=u;)h=o*s(f,l),v=o*s(f+o,l+h),I=l+(h+v)/2,l=I,f=f+o;if(g===4)for(;f<=u;)h=o*s(f,l),v=o*s(f+o/2,l+h/2),m=o*s(f+o/2,l+v/2),p=o*s(f+o,l+m),I=l+(h+2*v+2*m+p)/6,l=I,f=f+o;return l},romberg:function(s,o,u,f){for(var l=0,g=(u-o)/2,h=[],v=[],I=[],m,p,w,T,C;l<f/2;){for(C=s(o),w=o,T=0;w<=u;w=w+g,T++)h[T]=w;for(m=h.length,w=1;w<m-1;w++)C+=(w%2!==0?4:2)*s(h[w]);C=g/3*(C+s(u)),I[l]=C,g/=2,l++}for(p=I.length,m=1;p!==1;){for(w=0;w<p-1;w++)v[w]=(i.pow(4,m)*I[w+1]-I[w])/(i.pow(4,m)-1);p=v.length,I=v,v=[],m++}return I},richardson:function(s,o,u,f){function l(L,y){for(var P=0,q=L.length,H;P<q;P++)L[P]===y&&(H=P);return H}for(var g=i.abs(u-s[l(s,u)+1]),h=0,v=[],I=[],m,p,w,T,C;f>=g;)m=l(s,u+f),p=l(s,u),v[h]=(o[m]-2*o[p]+o[2*p-m])/(f*f),f/=2,h++;for(T=v.length,w=1;T!=1;){for(C=0;C<T-1;C++)I[C]=(i.pow(4,w)*v[C+1]-v[C])/(i.pow(4,w)-1);T=I.length,v=I,I=[],w++}return v},simpson:function(s,o,u,f){for(var l=(u-o)/f,g=s(o),h=[],v=o,I=0,m=1,p;v<=u;v=v+l,I++)h[I]=v;for(p=h.length;m<p-1;m++)g+=(m%2!==0?4:2)*s(h[m]);return l/3*(g+s(u))},hermite:function(s,o,u,f){for(var l=s.length,g=0,h=0,v=[],I=[],m=[],p=[],w;h<l;h++){for(v[h]=1,w=0;w<l;w++)h!=w&&(v[h]*=(f-s[w])/(s[h]-s[w]));for(I[h]=0,w=0;w<l;w++)h!=w&&(I[h]+=1/(s[h]-s[w]));m[h]=(1-2*(f-s[h])*I[h])*(v[h]*v[h]),p[h]=(f-s[h])*(v[h]*v[h]),g+=m[h]*o[h]+p[h]*u[h]}return g},lagrange:function(s,o,u){for(var f=0,l=0,g,h,v=s.length;l<v;l++){for(h=o[l],g=0;g<v;g++)l!=g&&(h*=(u-s[g])/(s[l]-s[g]));f+=h}return f},cubic_spline:function(s,o,u){for(var f=s.length,l=0,g,h=[],v=[],I=[],m=[],p=[],w=[],T=[];l<f-1;l++)p[l]=s[l+1]-s[l];for(I[0]=0,l=1;l<f-1;l++)I[l]=3/p[l]*(o[l+1]-o[l])-3/p[l-1]*(o[l]-o[l-1]);for(l=1;l<f-1;l++)h[l]=[],v[l]=[],h[l][l-1]=p[l-1],h[l][l]=2*(p[l-1]+p[l]),h[l][l+1]=p[l],v[l][0]=I[l];for(m=r.multiply(r.inv(h),v),g=0;g<f-1;g++)w[g]=(o[g+1]-o[g])/p[g]-p[g]*(m[g+1][0]+2*m[g][0])/3,T[g]=(m[g+1][0]-m[g][0])/(3*p[g]);for(g=0;g<f&&!(s[g]>u);g++);return g-=1,o[g]+(u-s[g])*w[g]+r.sq(u-s[g])*m[g]+(u-s[g])*r.sq(u-s[g])*T[g]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(s){var o=s.length,u=s[0].length,f=0,l,g,h=[],v=[],I=[],m=[],p=[],w=[],T=[],C=[],L=[],y=[];for(f=0;f<o;f++)h[f]=r.sum(s[f])/u;for(f=0;f<u;f++)for(T[f]=[],l=0;l<o;l++)T[f][l]=s[l][f]-h[l];for(T=r.transpose(T),f=0;f<o;f++)for(C[f]=[],l=0;l<o;l++)C[f][l]=r.dot([T[f]],[T[l]])/(u-1);for(I=r.jacobi(C),L=I[0],v=I[1],y=r.transpose(L),f=0;f<v.length;f++)for(l=f;l<v.length;l++)v[f]<v[l]&&(g=v[f],v[f]=v[l],v[l]=g,m=y[f],y[f]=y[l],y[l]=m);for(w=r.transpose(T),f=0;f<o;f++)for(p[f]=[],l=0;l<w.length;l++)p[f][l]=r.dot([y[f]],[w[l]]);return[s,v,y,p]}}),function(d){for(var s=0;s<d.length;s++)(function(o){r.fn[o]=function(u,f){var l=this;return f?(setTimeout(function(){f.call(l,r.fn[o].call(l,u))},15),this):typeof r[o](this,u)=="number"?r[o](this,u):r(r[o](this,u))}})(d[s])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(t,Math),function(r,i){var c=[].slice,a=r.utils.isNumber,E=r.utils.isArray;r.extend({zscore:function(){var o=c.call(arguments);return a(o[1])?(o[0]-o[1])/o[2]:(o[0]-r.mean(o[1]))/r.stdev(o[1],o[2])},ztest:function(){var o=c.call(arguments),u;return E(o[1])?(u=r.zscore(o[0],o[1],o[3]),o[2]===1?r.normal.cdf(-i.abs(u),0,1):r.normal.cdf(-i.abs(u),0,1)*2):o.length>2?(u=r.zscore(o[0],o[1],o[2]),o[3]===1?r.normal.cdf(-i.abs(u),0,1):r.normal.cdf(-i.abs(u),0,1)*2):(u=o[0],o[1]===1?r.normal.cdf(-i.abs(u),0,1):r.normal.cdf(-i.abs(u),0,1)*2)}}),r.extend(r.fn,{zscore:function(o,u){return(o-this.mean())/this.stdev(u)},ztest:function(o,u,f){var l=i.abs(this.zscore(o,f));return u===1?r.normal.cdf(-l,0,1):r.normal.cdf(-l,0,1)*2}}),r.extend({tscore:function(){var o=c.call(arguments);return o.length===4?(o[0]-o[1])/(o[2]/i.sqrt(o[3])):(o[0]-r.mean(o[1]))/(r.stdev(o[1],!0)/i.sqrt(o[1].length))},ttest:function(){var o=c.call(arguments),u;return o.length===5?(u=i.abs(r.tscore(o[0],o[1],o[2],o[3])),o[4]===1?r.studentt.cdf(-u,o[3]-1):r.studentt.cdf(-u,o[3]-1)*2):a(o[1])?(u=i.abs(o[0]),o[2]==1?r.studentt.cdf(-u,o[1]-1):r.studentt.cdf(-u,o[1]-1)*2):(u=i.abs(r.tscore(o[0],o[1])),o[2]==1?r.studentt.cdf(-u,o[1].length-1):r.studentt.cdf(-u,o[1].length-1)*2)}}),r.extend(r.fn,{tscore:function(o){return(o-this.mean())/(this.stdev(!0)/i.sqrt(this.cols()))},ttest:function(o,u){return u===1?1-r.studentt.cdf(i.abs(this.tscore(o)),this.cols()-1):r.studentt.cdf(-i.abs(this.tscore(o)),this.cols()-1)*2}}),r.extend({anovafscore:function(){var o=c.call(arguments),u,f,l,g,h,v,I,m;if(o.length===1){for(h=new Array(o[0].length),I=0;I<o[0].length;I++)h[I]=o[0][I];o=h}for(f=new Array,I=0;I<o.length;I++)f=f.concat(o[I]);for(l=r.mean(f),u=0,I=0;I<o.length;I++)u=u+o[I].length*i.pow(r.mean(o[I])-l,2);for(u/=o.length-1,v=0,I=0;I<o.length;I++)for(g=r.mean(o[I]),m=0;m<o[I].length;m++)v+=i.pow(o[I][m]-g,2);return v/=f.length-o.length,u/v},anovaftest:function(){var o=c.call(arguments),u,f,l,g;if(a(o[0]))return 1-r.centralF.cdf(o[0],o[1],o[2]);var h=r.anovafscore(o);for(u=o.length-1,l=0,g=0;g<o.length;g++)l=l+o[g].length;return f=l-u-1,1-r.centralF.cdf(h,u,f)},ftest:function(o,u,f){return 1-r.centralF.cdf(o,u,f)}}),r.extend(r.fn,{anovafscore:function(){return r.anovafscore(this.toArray())},anovaftes:function(){var o=0,u;for(u=0;u<this.length;u++)o=o+this[u].length;return r.ftest(this.anovafscore(),this.length-1,o-this.length)}}),r.extend({qscore:function(){var o=c.call(arguments),u,f,l,g,h;return a(o[0])?(u=o[0],f=o[1],l=o[2],g=o[3],h=o[4]):(u=r.mean(o[0]),f=r.mean(o[1]),l=o[0].length,g=o[1].length,h=o[2]),i.abs(u-f)/(h*i.sqrt((1/l+1/g)/2))},qtest:function(){var o=c.call(arguments),u;o.length===3?(u=o[0],o=o.slice(1)):o.length===7?(u=r.qscore(o[0],o[1],o[2],o[3],o[4]),o=o.slice(5)):(u=r.qscore(o[0],o[1],o[2]),o=o.slice(3));var f=o[0],l=o[1];return 1-r.tukey.cdf(u,l,f-l)},tukeyhsd:function(o){for(var u=r.pooledstdev(o),f=o.map(function(m){return r.mean(m)}),l=o.reduce(function(m,p){return m+p.length},0),g=[],h=0;h<o.length;++h)for(var v=h+1;v<o.length;++v){var I=r.qtest(f[h],f[v],o[h].length,o[v].length,u,l,o.length);g.push([[h,v],I])}return g}}),r.extend({normalci:function(){var o=c.call(arguments),u=new Array(2),f;return o.length===4?f=i.abs(r.normal.inv(o[1]/2,0,1)*o[2]/i.sqrt(o[3])):f=i.abs(r.normal.inv(o[1]/2,0,1)*r.stdev(o[2])/i.sqrt(o[2].length)),u[0]=o[0]-f,u[1]=o[0]+f,u},tci:function(){var o=c.call(arguments),u=new Array(2),f;return o.length===4?f=i.abs(r.studentt.inv(o[1]/2,o[3]-1)*o[2]/i.sqrt(o[3])):f=i.abs(r.studentt.inv(o[1]/2,o[2].length-1)*r.stdev(o[2],!0)/i.sqrt(o[2].length)),u[0]=o[0]-f,u[1]=o[0]+f,u},significant:function(o,u){return o<u}}),r.extend(r.fn,{normalci:function(o,u){return r.normalci(o,u,this.toArray())},tci:function(o,u){return r.tci(o,u,this.toArray())}});function d(s,o,u,f){if(s>1||u>1||s<=0||u<=0)throw new Error("Proportions should be greater than 0 and less than 1");var l=(s*o+u*f)/(o+f),g=i.sqrt(l*(1-l)*(1/o+1/f));return(s-u)/g}r.extend(r.fn,{oneSidedDifferenceOfProportions:function(o,u,f,l){var g=d(o,u,f,l);return r.ztest(g,1)},twoSidedDifferenceOfProportions:function(o,u,f,l){var g=d(o,u,f,l);return r.ztest(g,2)}})}(t,Math),t.models=function(){function r(d){var s=d[0].length,o=t.arange(s).map(function(u){var f=t.arange(s).filter(function(l){return l!==u});return i(t.col(d,u).map(function(l){return l[0]}),t.col(d,f))});return o}function i(d,s){var o=d.length,u=s[0].length-1,f=o-u-1,l=t.lstsq(s,d),g=t.multiply(s,l.map(function(T){return[T]})).map(function(T){return T[0]}),h=t.subtract(d,g),v=t.mean(d),I=t.sum(g.map(function(T){return Math.pow(T-v,2)})),m=t.sum(d.map(function(T,C){return Math.pow(T-g[C],2)})),p=I+m,w=I/p;return{exog:s,endog:d,nobs:o,df_model:u,df_resid:f,coef:l,predict:g,resid:h,ybar:v,SST:p,SSE:I,SSR:m,R2:w}}function c(d){var s=r(d.exog),o=Math.sqrt(d.SSR/d.df_resid),u=s.map(function(v){var I=v.SST,m=v.R2;return o/Math.sqrt(I*(1-m))}),f=d.coef.map(function(v,I){return(v-0)/u[I]}),l=f.map(function(v){var I=t.studentt.cdf(v,d.df_resid);return(I>.5?1-I:I)*2}),g=t.studentt.inv(.975,d.df_resid),h=d.coef.map(function(v,I){var m=g*u[I];return[v-m,v+m]});return{se:u,t:f,p:l,sigmaHat:o,interval95:h}}function a(d){var s=d.R2/d.df_model/((1-d.R2)/d.df_resid),o=function(f,l,g){return t.beta.cdf(f/(g/l+f),l/2,g/2)},u=1-o(s,d.df_model,d.df_resid);return{F_statistic:s,pvalue:u}}function E(d,s){var o=i(d,s),u=c(o),f=a(o),l=1-(1-o.R2)*((o.nobs-1)/o.df_resid);return o.t=u,o.f=f,o.adjust_R2=l,o}return{ols:E}}(),t.extend({buildxmatrix:function(){for(var i=new Array(arguments.length),c=0;c<arguments.length;c++){var a=[1];i[c]=a.concat(arguments[c])}return t(i)},builddxmatrix:function(){for(var i=new Array(arguments[0].length),c=0;c<arguments[0].length;c++){var a=[1];i[c]=a.concat(arguments[0][c])}return t(i)},buildjxmatrix:function(i){for(var c=new Array(i.length),a=0;a<i.length;a++)c[a]=i[a];return t.builddxmatrix(c)},buildymatrix:function(i){return t(i).transpose()},buildjymatrix:function(i){return i.transpose()},matrixmult:function(i,c){var a,E,d,s,o;if(i.cols()==c.rows()){if(c.rows()>1){for(s=[],a=0;a<i.rows();a++)for(s[a]=[],E=0;E<c.cols();E++){for(o=0,d=0;d<i.cols();d++)o+=i.toArray()[a][d]*c.toArray()[d][E];s[a][E]=o}return t(s)}for(s=[],a=0;a<i.rows();a++)for(s[a]=[],E=0;E<c.cols();E++){for(o=0,d=0;d<i.cols();d++)o+=i.toArray()[a][d]*c.toArray()[E];s[a][E]=o}return t(s)}},regress:function(i,c){var a=t.xtranspxinv(i),E=i.transpose(),d=t.matrixmult(t(a),E);return t.matrixmult(d,c)},regresst:function(i,c,a){var E=t.regress(i,c),d={};d.anova={};var s=t.jMatYBar(i,E);d.yBar=s;var o=c.mean();d.anova.residuals=t.residuals(c,s),d.anova.ssr=t.ssr(s,o),d.anova.msr=d.anova.ssr/(i[0].length-1),d.anova.sse=t.sse(c,s),d.anova.mse=d.anova.sse/(c.length-(i[0].length-1)-1),d.anova.sst=t.sst(c,o),d.anova.mst=d.anova.sst/(c.length-1),d.anova.r2=1-d.anova.sse/d.anova.sst,d.anova.r2<0&&(d.anova.r2=0),d.anova.fratio=d.anova.msr/d.anova.mse,d.anova.pvalue=t.anovaftest(d.anova.fratio,i[0].length-1,c.length-(i[0].length-1)-1),d.anova.rmse=Math.sqrt(d.anova.mse),d.anova.r2adj=1-d.anova.mse/d.anova.mst,d.anova.r2adj<0&&(d.anova.r2adj=0),d.stats=new Array(i[0].length);for(var u=t.xtranspxinv(i),f,l,g,h=0;h<E.length;h++)f=Math.sqrt(d.anova.mse*Math.abs(u[h][h])),l=Math.abs(E[h]/f),g=t.ttest(l,c.length-i[0].length-1,a),d.stats[h]=[E[h],f,l,g];return d.regress=E,d},xtranspx:function(i){return t.matrixmult(i.transpose(),i)},xtranspxinv:function(i){var c=t.matrixmult(i.transpose(),i),a=t.inv(c);return a},jMatYBar:function(i,c){var a=t.matrixmult(i,c);return new t(a)},residuals:function(i,c){return t.matrixsubtract(i,c)},ssr:function(i,c){for(var a=0,E=0;E<i.length;E++)a+=Math.pow(i[E]-c,2);return a},sse:function(i,c){for(var a=0,E=0;E<i.length;E++)a+=Math.pow(i[E]-c[E],2);return a},sst:function(i,c){for(var a=0,E=0;E<i.length;E++)a+=Math.pow(i[E]-c,2);return a},matrixsubtract:function(i,c){for(var a=new Array(i.length),E=0;E<i.length;E++){a[E]=new Array(i[E].length);for(var d=0;d<i[E].length;d++)a[E][d]=i[E][d]-c[E][d]}return t(a)}}),t.jStat=t,t})})(je);var It=je.exports;const V=be(It);var _e={};(function(n){(function(e){e(typeof DO_NOT_EXPORT_BESSEL>"u"?n:{})})(function(e){e.version="1.0.2";var t=Math;function r(o,u){for(var f=0,l=0;f<o.length;++f)l=u*l+o[f];return l}function i(o,u,f,l,g){if(u===0)return f;if(u===1)return l;for(var h=2/o,v=l,I=1;I<u;++I)v=l*I*h+g*f,f=l,l=v;return v}function c(o,u,f,l,g){return function(v,I){if(l){if(v===0)return l==1?-1/0:1/0;if(v<0)return NaN}if(I===0)return o(v);if(I===1)return u(v);if(I<0)return NaN;I|=0;var m=o(v),p=u(v);return i(v,I,m,p,g)}}var a=function(){var o=.636619772,u=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),f=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),l=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),g=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function h(T){var C=0,L=0,y=0,P=T*T;if(T<8)L=r(u,P),y=r(f,P),C=L/y;else{var q=T-.785398164;P=64/P,L=r(l,P),y=r(g,P),C=t.sqrt(o/T)*(t.cos(q)*L-t.sin(q)*y*8/T)}return C}var v=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),I=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),m=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),p=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function w(T){var C=0,L=0,y=0,P=T*T,q=t.abs(T)-2.356194491;return Math.abs(T)<8?(L=T*r(v,P),y=r(I,P),C=L/y):(P=64/P,L=r(m,P),y=r(p,P),C=t.sqrt(o/t.abs(T))*(t.cos(q)*L-t.sin(q)*y*8/t.abs(T)),T<0&&(C=-C)),C}return function T(C,L){if(L=Math.round(L),!isFinite(C))return isNaN(C)?C:0;if(L<0)return(L%2?-1:1)*T(C,-L);if(C<0)return(L%2?-1:1)*T(-C,L);if(L===0)return h(C);if(L===1)return w(C);if(C===0)return 0;var y=0;if(C>L)y=i(C,L,h(C),w(C),-1);else{for(var P=2*t.floor((L+t.floor(t.sqrt(40*L)))/2),q=!1,H=0,Q=0,z=1,X=0,gn=2/C,ln=P;ln>0;ln--)X=ln*gn*z-H,H=z,z=X,t.abs(z)>1e10&&(z*=1e-10,H*=1e-10,y*=1e-10,Q*=1e-10),q&&(Q+=z),q=!q,ln==L&&(y=H);Q=2*Q-z,y/=Q}return y}}(),E=function(){var o=.636619772,u=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),f=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),l=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),g=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse();function h(T){var C=0,L=0,y=0,P=T*T,q=T-.785398164;return T<8?(L=r(u,P),y=r(f,P),C=L/y+o*a(T,0)*t.log(T)):(P=64/P,L=r(l,P),y=r(g,P),C=t.sqrt(o/T)*(t.sin(q)*L+t.cos(q)*y*8/T)),C}var v=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),I=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),m=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),p=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function w(T){var C=0,L=0,y=0,P=T*T,q=T-2.356194491;return T<8?(L=T*r(v,P),y=r(I,P),C=L/y+o*(a(T,1)*t.log(T)-1/T)):(P=64/P,L=r(m,P),y=r(p,P),C=t.sqrt(o/T)*(t.sin(q)*L+t.cos(q)*y*8/T)),C}return c(h,w,"BESSELY",1,-1)}(),d=function(){var o=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),u=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function f(v){return v<=3.75?r(o,v*v/(3.75*3.75)):t.exp(t.abs(v))/t.sqrt(t.abs(v))*r(u,3.75/t.abs(v))}var l=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),g=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function h(v){return v<3.75?v*r(l,v*v/(3.75*3.75)):(v<0?-1:1)*t.exp(t.abs(v))/t.sqrt(t.abs(v))*r(g,3.75/t.abs(v))}return function v(I,m){if(m=Math.round(m),m===0)return f(I);if(m===1)return h(I);if(m<0)return NaN;if(t.abs(I)===0)return 0;if(I==1/0)return 1/0;var p=0,w,T=2/t.abs(I),C=0,L=1,y=0,P=2*t.round((m+t.round(t.sqrt(40*m)))/2);for(w=P;w>0;w--)y=w*T*L+C,C=L,L=y,t.abs(L)>1e10&&(L*=1e-10,C*=1e-10,p*=1e-10),w==m&&(p=C);return p*=v(I,0)/L,I<0&&m%2?-p:p}}(),s=function(){var o=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),u=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function f(v){return v<=2?-t.log(v/2)*d(v,0)+r(o,v*v/4):t.exp(-v)/t.sqrt(v)*r(u,2/v)}var l=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),g=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function h(v){return v<=2?t.log(v/2)*d(v,1)+1/v*r(l,v*v/4):t.exp(-v)/t.sqrt(v)*r(g,2/v)}return c(f,h,"BESSELK",2,1)}();e.besselj=a,e.bessely=E,e.besseli=d,e.besselk=s})})(_e);const jn=be(_e),Ie=new Error("#NULL!"),Z=new Error("#DIV/0!"),A=new Error("#VALUE!"),Un=new Error("#REF!"),_n=new Error("#NAME?"),R=new Error("#NUM!"),U=new Error("#N/A"),me=new Error("#ERROR!"),nr=new Error("#GETTING_DATA");var mt=Object.freeze({__proto__:null,data:nr,div0:Z,error:me,na:U,name:_n,nil:Ie,num:R,ref:Un,value:A});function Wn(n){const e=[];return J(n,t=>{e.push(t)}),e}function J(n,e){let t=-1;const r=n.length;for(;++t<r&&e(n[t],t,n)!==!1;);return n}function we(n){let e=n.length,t;for(;e--;)if(t=n[e],typeof t!="number"){if(t===!0){n[e]=1;continue}if(t===!1){n[e]=0;continue}if(typeof t=="string"){const r=N(t);n[e]=r instanceof Error?0:r}}return n}function er(n,e){if(!n)return A;(!n.every(i=>Array.isArray(i))||n.length===0)&&(n=[[...n]]),n.map((i,c)=>{i.map((a,E)=>{a||(n[c][E]=0)})});const t=n.reduce((i,c,a)=>c.length>n[i].length?a:i,0),r=n[t].length;return n.map(i=>[...i,...Array(r-i.length).fill(e||0)])}function M(){let n;if(arguments.length===1){const e=arguments[0];n=Tt(e)?Wn.apply(null,arguments):[e]}else n=Array.from(arguments);for(;!At(n);)n=Te(n);return n}function Te(n){return!n||!n.reduce?[n]:n.reduce((e,t)=>{const r=Array.isArray(e),i=Array.isArray(t);return r&&i?e.concat(t):r?(e.push(t),e):i?[e].concat(t):[e,t]})}function wt(n,e){return e=e||1,!n||typeof n.slice!="function"?n:n.slice(0,n.length-e)}function Tt(n){return n!=null&&typeof n.length=="number"&&typeof n!="string"}function At(n){if(!n)return!1;for(let e=0;e<n.length;++e)if(Array.isArray(n[e]))return!1;return!0}function W(n,e){return e=e||1,!n||typeof n.slice!="function"?n:n.slice(e)}function ne(n){return n?n[0].map((e,t)=>n.map(r=>r[t])):A}function tn(n,e){let t=null;return J(n,(r,i)=>{if(r[0]===e)return t=i,!1}),t??A}function k(){for(let n=0;n<arguments.length;n++)if(arguments[n]instanceof Error)return arguments[n]}function O(){let n=arguments.length;for(;n--;)if(arguments[n]instanceof Error)return!0;return!1}function rr(n){return Math.round(n*1e14)/1e14}function Fn(){return M.apply(null,arguments).filter(e=>typeof e=="number")}function Ct(n){n<60&&(n+=1);const t=Math.floor(n-25569)*86400,r=new Date(t*1e3),i=n-Math.floor(n)+1e-7;let c=Math.floor(86400*i);const a=c%60;c-=a;const E=Math.floor(c/(60*60)),d=Math.floor(c/60)%60;let s=r.getUTCDate(),o=r.getUTCMonth();return n>=60&&n<61&&(s=29,o=1),new Date(r.getUTCFullYear(),o,s,E,d,a)}function Ae(n){if(typeof n=="boolean"||n instanceof Error)return n;if(typeof n=="number")return n!==0;if(typeof n=="string"){const e=n.toUpperCase();if(e==="TRUE")return!0;if(e==="FALSE")return!1}return n instanceof Date&&!isNaN(n)?!0:A}function G(n){if(!isNaN(n)){if(n instanceof Date)return new Date(n);const e=parseFloat(n);return e<0||e>=2958466?R:Ct(e)}return typeof n=="string"&&(n=/(\d{4})-(\d\d?)-(\d\d?)$/.test(n)?new Date(n+"T00:00:00.000"):new Date(n),!isNaN(n))?n:A}function tr(n){let e=n.length,t;for(;e--;){if(t=G(n[e]),t===A)return t;n[e]=t}return n}function N(n){return n instanceof Error?n:n==null?0:(typeof n=="boolean"&&(n=+n),!isNaN(n)&&n!==""?parseFloat(n):A)}function B(n){let e;if(!n||(e=n.length)===0)return A;let t;for(;e--;){if(n[e]instanceof Error)return n[e];if(t=N(n[e]),t instanceof Error)return t;n[e]=t}return n}function K(n){return n instanceof Error?n:n==null?"":n.toString()}function ee(){let n=arguments.length;for(;n--;)if(typeof arguments[n]=="string")return!0;return!1}function kn(n){return n!=null}const Rt="=",Dt=[">",">=","<","<=","=","<>"],or="operator",ir="literal",Ot=[or,ir],re=or,En=ir;function cn(n,e){if(Ot.indexOf(e)===-1)throw new Error("Unsupported token type: "+e);return{value:n,type:e}}function Lt(n){return typeof n!="string"||/^\d+(\.\d+)?$/.test(n)&&(n=n.indexOf(".")===-1?parseInt(n,10):parseFloat(n)),n}function Mt(n){const e=n.length,t=[];let r=0,i="",c="";for(;r<e;){const a=n.charAt(r);switch(a){case">":case"<":case"=":c=c+a,i.length>0&&(t.push(i),i="");break;default:c.length>0&&(t.push(c),c=""),i=i+a;break}r++}return i.length>0&&t.push(i),c.length>0&&t.push(c),t}function yt(n){let e="";const t=[];for(let r=0;r<n.length;r++){const i=n[r];r===0&&Dt.indexOf(i)>=0?t.push(cn(i,re)):e+=i}return e.length>0&&t.push(cn(Lt(e),En)),t.length>0&&t[0].type!==re&&t.unshift(cn(Rt,re)),t}function Pt(n){const e=[];let t;for(let r=0;r<n.length;r++){const i=n[r];switch(i.type){case re:t=i.value;break;case En:e.push(i.value);break}}return Vt(e,t)}function Vt(n,e){let t=!1;switch(e){case">":t=n[0]>n[1];break;case">=":t=n[0]>=n[1];break;case"<":t=n[0]<n[1];break;case"<=":t=n[0]<=n[1];break;case"=":t=n[0]==n[1];break;case"<>":t=n[0]!=n[1];break}return t}function Tn(n){return yt(Mt(n))}const An=Pt;function Bt(){throw new Error("CELL is not implemented")}const ur={};ur.TYPE=n=>{switch(n){case Ie:return 1;case Z:return 2;case A:return 3;case Un:return 4;case _n:return 5;case R:return 6;case U:return 7;case nr:return 8}return U};function qt(){throw new Error("INFO is not implemented")}function Ut(n){return n===null}function fr(n){return[A,Un,Z,R,_n,Ie].indexOf(n)>=0||typeof n=="number"&&(isNaN(n)||!isFinite(n))}function te(n){return fr(n)||n===U}function Ft(n){return!(Math.floor(Math.abs(n))&1)}function kt(){throw new Error("ISFORMULA is not implemented")}function sr(n){return n===!0||n===!1}function Gt(n){return n===U}function Ht(n){return typeof n!="string"}function oe(n){return typeof n=="number"&&!isNaN(n)&&isFinite(n)}function Yt(n){return!!(Math.floor(Math.abs(n))&1)}function $t(){throw new Error("ISREF is not implemented")}function lr(n){return typeof n=="string"}function zt(n){return oe(n)?n:n instanceof Date?n.getTime():n===!0?1:n===!1?0:te(n)?n:0}function Wt(){return U}function Kt(){throw new Error("SHEET is not implemented")}function Xt(){throw new Error("SHEETS is not implemented")}function Qt(n){if(oe(n))return 1;if(lr(n))return 2;if(sr(n))return 4;if(te(n))return 16;if(Array.isArray(n))return 64}function Zt(){if(arguments.length<2)return U;const n=arguments[0];return n<1||n>254||arguments.length<n+1?A:arguments[n]}function Jt(n,e){if(arguments.length!==2)return U;if(e<0)return R;if(!(n instanceof Array)||typeof e!="number")return A;if(n.length!==0)return V.col(n,e)}function St(n){return arguments.length!==1?U:n instanceof Array?n.length===0?0:V.cols(n):A}function bt(n,e,t,r){return cr(n,ne(e),t,r)}function xt(n,e,t){const r=k(n,e,t);if(r)return r;if(!Array.isArray(n))return A;const i=n.length>0&&!Array.isArray(n[0]);return i&&!t?(t=e,e=1):(t=t||1,e=e||1),t<0||e<0?A:i&&e===1&&t<=n.length?n[t-1]:e<=n.length&&t<=n[e-1].length?n[e-1][t-1]:Un}function jt(n,e,t){e=M(e),t=t?M(t):e;const r=typeof n=="number";let i=U;for(let c=0;c<e.length;c++){if(e[c]===n)return t[c];if(r&&e[c]<=n||typeof e[c]=="string"&&e[c].localeCompare(n)<0)i=t[c];else if(r&&e[c]>n)return i}return i}function _t(n,e,t){if(!n||!e||(arguments.length===2&&(t=1),e=M(e),!(e instanceof Array))||t!==-1&&t!==0&&t!==1)return U;let r,i;for(let c=0;c<e.length;c++)if(t===1){if(e[c]===n)return c+1;e[c]<n&&(i?e[c]>i&&(r=c+1,i=e[c]):(r=c+1,i=e[c]))}else if(t===0){if(typeof n=="string"&&typeof e[c]=="string"){const a=n.toLowerCase().replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\");if(new RegExp("^"+a+"$").test(e[c].toLowerCase()))return c+1}else if(e[c]===n)return c+1}else if(t===-1){if(e[c]===n)return c+1;e[c]>n&&(i?e[c]<i&&(r=c+1,i=e[c]):(r=c+1,i=e[c]))}return r||U}function no(n){return arguments.length!==1?U:n instanceof Array?n.length===0?0:V.rows(n):A}function eo(n,e=1,t=1,r=!1){if(!n||!Array.isArray(n))return U;if(n.length===0)return 0;if(e=N(e),!e||e<1||(t=N(t),t!==1&&t!==-1))return A;if(r=Ae(r),typeof r!="boolean")return _n;const i=E=>E.sort((d,s)=>(d=K(d[e-1]),s=K(s[e-1]),t===1?d<s?t*-1:t:d>s?t:t*-1)),c=er(n),a=r?ne(c):c;return e>=1&&e<=a[0].length?r?ne(i(a)):i(a):A}function ro(n){if(!n)return U;const e=er(n);return ne(e)}function Ce(){const n=[];for(let e=0;e<arguments.length;++e){let t=!1;const r=arguments[e];for(let i=0;i<n.length&&(t=n[i]===r,!t);++i);t||n.push(r)}return n}function cr(n,e,t,r){if(!e||!t)return U;r=!(r===0||r===!1);let i=U;const c=typeof n=="number";let a=!1;for(let E=0;E<e.length;E++){const d=e[E];if(d[0]===n){i=t<d.length+1?d[t-1]:Un;break}else!a&&(c&&r&&d[0]<=n||r&&typeof d[0]=="string"&&d[0].localeCompare(n)<0)&&(i=t<d.length+1?d[t-1]:Un);c&&d[0]>n&&(a=!0)}return i}const to=2.5066282746310002;function oo(){const e=M(arguments).filter(kn);if(e.length===0)return R;const t=B(e);return t instanceof Error?t:V.sum(V(t).subtract(V.mean(t)).abs()[0])/t.length}function Cn(){const e=M(arguments).filter(kn);if(e.length===0)return Z;const t=k.apply(void 0,e);if(t)return t;const r=Fn(e),i=r.length;let c=0,a=0,E;for(let d=0;d<i;d++)c+=r[d],a+=1;return E=c/a,isNaN(E)&&(E=R),E}function Re(){const e=M(arguments).filter(kn);if(e.length===0)return Z;const t=k.apply(void 0,e);if(t)return t;const r=e,i=r.length;let c=0,a=0,E;for(let d=0;d<i;d++){const s=r[d];typeof s=="number"&&(c+=s),s===!0&&c++,s!==null&&a++}return E=c/a,isNaN(E)&&(E=R),E}function io(n,e,t){if(arguments.length<=1)return U;t=t||n;const i=M(t).filter(kn);if(t=B(i),n=M(n),t instanceof Error)return t;let c=0,a=0;const E=e===void 0||e==="*",d=E?null:Tn(e+"");for(let s=0;s<n.length;s++){const o=n[s];if(E)a+=t[s],c++;else{const u=[cn(o,En)].concat(d);An(u)&&(a+=t[s],c++)}}return a/c}function uo(){const n=Wn(arguments),e=(n.length-1)/2,t=M(n[0]);let r=0,i=0;for(let a=0;a<t.length;a++){let E=!1;for(let d=0;d<e;d++){const s=n[2*d+1][a],o=n[2*d+2],u=o===void 0||o==="*";let f=!1;if(u)f=!0;else{const l=Tn(o+""),g=[cn(s,En)].concat(l);f=An(g)}if(!f){E=!1;break}E=!0}E&&(i+=t[a],r++)}const c=i/r;return isNaN(c)?0:c}const Kn={};Kn.DIST=function(n,e,t,r,i,c){return arguments.length<4||(i=i===void 0?0:i,c=c===void 0?1:c,n=N(n),e=N(e),t=N(t),i=N(i),c=N(c),O(n,e,t,i,c))?A:(n=(n-i)/(c-i),r?V.beta.cdf(n,e,t):V.beta.pdf(n,e,t))},Kn.INV=(n,e,t,r,i)=>(r=r===void 0?0:r,i=i===void 0?1:i,n=N(n),e=N(e),t=N(t),r=N(r),i=N(i),O(n,e,t,r,i)?A:V.beta.inv(n,e,t)*(i-r)+r);const Gn={};Gn.DIST=(n,e,t,r)=>(n=N(n),e=N(e),t=N(t),r=N(r),O(n,e,t,r)?A:r?V.binomial.cdf(n,e,t):V.binomial.pdf(n,e,t)),Gn.DIST.RANGE=(n,e,t,r)=>{if(r=r===void 0?t:r,n=N(n),e=N(e),t=N(t),r=N(r),O(n,e,t,r))return A;let i=0;for(let c=t;c<=r;c++)i+=$n(n,c)*Math.pow(e,c)*Math.pow(1-e,n-c);return i},Gn.INV=(n,e,t)=>{if(n=N(n),e=N(e),t=N(t),O(n,e,t))return A;let r=0;for(;r<=n;){if(V.binomial.cdf(r,n,e)>=t)return r;r++}};const un={};un.DIST=(n,e,t)=>(n=N(n),e=N(e),O(n,e)?A:t?V.chisquare.cdf(n,e):V.chisquare.pdf(n,e)),un.DIST.RT=(n,e)=>!n|!e?U:n<1||e>Math.pow(10,10)?R:typeof n!="number"||typeof e!="number"?A:1-V.chisquare.cdf(n,e),un.INV=(n,e)=>(n=N(n),e=N(e),O(n,e)?A:V.chisquare.inv(n,e)),un.INV.RT=(n,e)=>!n|!e?U:n<0||n>1||e<1||e>Math.pow(10,10)?R:typeof n!="number"||typeof e!="number"?A:V.chisquare.inv(1-n,e),un.TEST=function(n,e){if(arguments.length!==2)return U;if(!(n instanceof Array)||!(e instanceof Array)||n.length!==e.length||n[0]&&e[0]&&n[0].length!==e[0].length)return A;const t=n.length;let r,i,c;for(i=0;i<t;i++)n[i]instanceof Array||(r=n[i],n[i]=[],n[i].push(r)),e[i]instanceof Array||(r=e[i],e[i]=[],e[i].push(r));const a=n[0].length,E=a===1?t-1:(t-1)*(a-1);let d=0;const s=Math.PI;for(i=0;i<t;i++)for(c=0;c<a;c++)d+=Math.pow(n[i][c]-e[i][c],2)/e[i][c];function o(u,f){let l=Math.exp(-.5*u);f%2===1&&(l=l*Math.sqrt(2*u/s));let g=f;for(;g>=2;)l=l*u/g,g=g-2;let h=l,v=f;for(;h>1e-10*l;)v=v+2,h=h*u/v,l=l+h;return 1-l}return Math.round(o(d,E)*1e6)/1e6};const De={};De.NORM=(n,e,t)=>(n=N(n),e=N(e),t=N(t),O(n,e,t)?A:V.normalci(1,n,e,t)[1]-1),De.T=(n,e,t)=>(n=N(n),e=N(e),t=N(t),O(n,e,t)?A:V.tci(1,n,e,t)[1]-1);function fo(n,e){return n=B(M(n)),e=B(M(e)),O(n,e)?A:V.corrcoeff(n,e)}function Xn(){const n=M(arguments);return Fn(n).length}function Qn(){const n=M(arguments);return n.length-ar(n)}function ar(){const n=M(arguments);let e=0,t;for(let r=0;r<n.length;r++)t=n[r],(t==null||t==="")&&e++;return e}function so(n,e){if(n=M(n),e===void 0||e==="*")return n.length;let r=0;const i=Tn(e+"");for(let c=0;c<n.length;c++){const a=n[c],E=[cn(a,En)].concat(i);An(E)&&r++}return r}function lo(){const n=Wn(arguments),e=new Array(M(n[0]).length);for(let r=0;r<e.length;r++)e[r]=!0;for(let r=0;r<n.length;r+=2){const i=M(n[r]),c=n[r+1];if(!(c===void 0||c==="*")){const E=Tn(c+"");for(let d=0;d<i.length;d++){const s=i[d],o=[cn(s,En)].concat(E);e[d]=e[d]&&An(o)}}}let t=0;for(let r=0;r<e.length;r++)e[r]&&t++;return t}const Hn={};Hn.P=(n,e)=>{if(n=B(M(n)),e=B(M(e)),O(n,e))return A;const t=V.mean(n),r=V.mean(e);let i=0;const c=n.length;for(let a=0;a<c;a++)i+=(n[a]-t)*(e[a]-r);return i/c},Hn.S=(n,e)=>(n=B(M(n)),e=B(M(e)),O(n,e)?A:V.covariance(n,e));function co(){const n=B(M(arguments));if(n instanceof Error)return n;const e=V.mean(n);let t=0;for(let r=0;r<n.length;r++)t+=Math.pow(n[r]-e,2);return t}const Oe={};Oe.DIST=(n,e,t)=>(n=N(n),e=N(e),O(n,e)?A:t?V.exponential.cdf(n,e):V.exponential.pdf(n,e));const fn={};fn.DIST=(n,e,t,r)=>(n=N(n),e=N(e),t=N(t),O(n,e,t)?A:r?V.centralF.cdf(n,e,t):V.centralF.pdf(n,e,t)),fn.DIST.RT=function(n,e,t){return arguments.length!==3?U:n<0||e<1||t<1?R:typeof n!="number"||typeof e!="number"||typeof t!="number"?A:1-V.centralF.cdf(n,e,t)},fn.INV=(n,e,t)=>(n=N(n),e=N(e),t=N(t),O(n,e,t)?A:n<=0||n>1?R:V.centralF.inv(n,e,t)),fn.INV.RT=function(n,e,t){return arguments.length!==3?U:n<0||n>1||e<1||e>Math.pow(10,10)||t<1||t>Math.pow(10,10)?R:typeof n!="number"||typeof e!="number"||typeof t!="number"?A:V.centralF.inv(1-n,e,t)},fn.TEST=(n,e)=>{if(!n||!e||!(n instanceof Array)||!(e instanceof Array))return U;if(n.length<2||e.length<2)return Z;const t=(E,d)=>{let s=0;for(let o=0;o<E.length;o++)s+=Math.pow(E[o]-d,2);return s},r=In(n)/n.length,i=In(e)/e.length,c=t(n,r)/(n.length-1),a=t(e,i)/(e.length-1);return c/a};function ao(n){return n=N(n),n instanceof Error?n:Math.log((1+n)/(1-n))/2}function go(n){if(n=N(n),n instanceof Error)return n;const e=Math.exp(2*n);return(e-1)/(e+1)}function gr(n,e,t){if(n=N(n),e=B(M(e)),t=B(M(t)),O(n,e,t))return A;const r=V.mean(t),i=V.mean(e),c=t.length;let a=0,E=0;for(let o=0;o<c;o++)a+=(t[o]-r)*(e[o]-i),E+=Math.pow(t[o]-r,2);const d=a/E;return i-d*r+d*n}function ho(n,e){if(n=B(M(n)),e=B(M(e)),O(n,e))return A;const t=n.length,r=e.length,i=[];for(let c=0;c<=r;c++){i[c]=0;for(let a=0;a<t;a++)c===0?n[a]<=e[0]&&(i[0]+=1):c<r?n[a]>e[c-1]&&n[a]<=e[c]&&(i[c]+=1):c===r&&n[a]>e[r-1]&&(i[r]+=1)}return i}function Zn(n){return n=N(n),n instanceof Error?n:n===0||parseInt(n,10)===n&&n<0?R:V.gammafn(n)}Zn.DIST=function(n,e,t,r){return arguments.length!==4?U:n<0||e<=0||t<=0||typeof n!="number"||typeof e!="number"||typeof t!="number"?A:r?V.gamma.cdf(n,e,t,!0):V.gamma.pdf(n,e,t,!1)},Zn.INV=function(n,e,t){return arguments.length!==3?U:n<0||n>1||e<=0||t<=0?R:typeof n!="number"||typeof e!="number"||typeof t!="number"?A:V.gamma.inv(n,e,t)};function Le(n){return n=N(n),n instanceof Error?n:V.gammaln(n)}Le.PRECISE=function(n){return arguments.length!==1?U:n<=0?R:typeof n!="number"?A:V.gammaln(n)};function vo(n){return n=N(n),n instanceof Error?n:V.normal.cdf(n,0,1)-.5}function Eo(){const n=B(M(arguments));return n instanceof Error?n:V.geomean(n)}function po(n,e,t,r){if(n=B(n),n instanceof Error)return n;let i;if(e===void 0)for(e=[],i=1;i<=n.length;i++)e.push(i);if(t===void 0)for(t=[],i=1;i<=n.length;i++)t.push(i);if(e=B(e),t=B(t),O(e,t))return A;r===void 0&&(r=!0);const c=n.length;let a=0,E=0,d=0,s=0;for(i=0;i<c;i++){const l=e[i],g=Math.log(n[i]);a+=l,E+=g,d+=l*g,s+=l*l}a/=c,E/=c,d/=c,s/=c;let o,u;r?(o=(d-a*E)/(s-a*a),u=E-o*a):(o=d/s,u=0);const f=[];for(i=0;i<t.length;i++)f.push(Math.exp(u+o*t[i]));return f}function No(){const n=B(M(arguments));if(n instanceof Error)return n;const e=n.length;let t=0;for(let r=0;r<e;r++)t+=1/n[r];return e/t}const Me={};Me.DIST=(n,e,t,r,i)=>{if(n=N(n),e=N(e),t=N(t),r=N(r),O(n,e,t,r))return A;function c(E,d,s,o){return $n(s,E)*$n(o-s,d-E)/$n(o,d)}function a(E,d,s,o){let u=0;for(let f=0;f<=E;f++)u+=c(f,d,s,o);return u}return i?a(n,e,t,r):c(n,e,t,r)};function Io(n,e){return n=B(n),e=B(e),O(n,e)?A:n.length!==e.length?U:gr(0,n,e)}function mo(){const n=B(M(arguments));if(n instanceof Error)return n;const e=V.mean(n),t=n.length;let r=0;for(let i=0;i<t;i++)r+=Math.pow(n[i]-e,4);return r=r/Math.pow(V.stdev(n,!0),4),t*(t+1)/((t-1)*(t-2)*(t-3))*r-3*(t-1)*(t-1)/((t-2)*(t-3))}function hr(n,e){return n=B(M(n)),e=N(e),O(n,e)?n:e<0||n.length<e?A:n.sort((t,r)=>r-t)[e-1]}function ye(n,e){if(n=B(M(n)),e=B(M(e)),O(n,e))return A;const t=V.mean(n),r=V.mean(e),i=e.length;let c=0,a=0;for(let s=0;s<i;s++)c+=(e[s]-r)*(n[s]-t),a+=Math.pow(e[s]-r,2);const E=c/a,d=t-E*r;return[E,d]}function wo(n,e){if(n=B(M(n)),e=B(M(e)),O(n,e)||n.length!==e.length)return A;for(let r=0;r<n.length;r++)n[r]=Math.log(n[r]);const t=ye(n,e);return t[0]=Math.round(Math.exp(t[0])*1e6)/1e6,t[1]=Math.round(Math.exp(t[1])*1e6)/1e6,t}const Yn={};Yn.DIST=(n,e,t,r)=>(n=N(n),e=N(e),t=N(t),O(n,e,t)?A:r?V.lognormal.cdf(n,e,t):V.lognormal.pdf(n,e,t)),Yn.INV=(n,e,t)=>(n=N(n),e=N(e),t=N(t),O(n,e,t)?A:V.lognormal.inv(n,e,t));function ie(){const n=M(arguments),e=k.apply(void 0,n);if(e)return e;const t=Fn(n);return t.length===0?0:Math.max.apply(Math,t)}function To(){const n=M(arguments),e=k.apply(void 0,n);if(e)return e;let t=we(n);return t=t.map(r=>r??0),t.length===0?0:Math.max.apply(Math,t)}function dr(){const n=M(arguments),e=k.apply(void 0,n);if(e)return e;const t=we(n);let r=V.median(t);return isNaN(r)&&(r=R),r}function ue(){const n=M(arguments),e=k.apply(void 0,n);if(e)return e;const t=Fn(n);return t.length===0?0:Math.min.apply(Math,t)}function Ao(){const n=M(arguments),e=k.apply(void 0,n);if(e)return e;let t=we(n);return t=t.map(r=>r??0),t.length===0?0:Math.min.apply(Math,t)}const Rn={};Rn.MULT=function(){const n=B(M(arguments));if(n instanceof Error)return n;const e=n.length,t={};let r=[],i=0,c;for(let a=0;a<e;a++)c=n[a],t[c]=t[c]?t[c]+1:1,t[c]>i&&(i=t[c],r=[]),t[c]===i&&(r[r.length]=c);return r},Rn.SNGL=function(){const n=B(M(arguments));return n instanceof Error?n:Rn.MULT(n).sort((e,t)=>e-t)[0]};const Pe={};Pe.DIST=(n,e,t,r)=>(n=N(n),e=N(e),t=N(t),O(n,e,t)?A:r?V.negbin.cdf(n,e,t):V.negbin.pdf(n,e,t));const sn={};sn.DIST=(n,e,t,r)=>(n=N(n),e=N(e),t=N(t),O(n,e,t)?A:t<=0?R:r?V.normal.cdf(n,e,t):V.normal.pdf(n,e,t)),sn.INV=(n,e,t)=>(n=N(n),e=N(e),t=N(t),O(n,e,t)?A:V.normal.inv(n,e,t)),sn.S={},sn.S.DIST=(n,e)=>(n=N(n),n instanceof Error?A:e?V.normal.cdf(n,0,1):V.normal.pdf(n,0,1)),sn.S.INV=n=>(n=N(n),n instanceof Error?A:V.normal.inv(n,0,1));function vr(n,e){if(e=B(M(e)),n=B(M(n)),O(e,n))return A;const t=V.mean(n),r=V.mean(e),i=n.length;let c=0,a=0,E=0;for(let d=0;d<i;d++)c+=(n[d]-t)*(e[d]-r),a+=Math.pow(n[d]-t,2),E+=Math.pow(e[d]-r,2);return c/Math.sqrt(a*E)}const nn={};nn.EXC=(n,e)=>{if(n=B(M(n)),e=N(e),O(n,e))return A;n=n.sort((c,a)=>c-a);const t=n.length;if(e<1/(t+1)||e>1-1/(t+1))return R;const r=e*(t+1)-1,i=Math.floor(r);return rr(r===i?n[r]:n[i]+(r-i)*(n[i+1]-n[i]))},nn.INC=(n,e)=>{if(n=B(M(n)),e=N(e),O(n,e))return A;n=n.sort((c,a)=>c-a);const t=n.length,r=e*(t-1),i=Math.floor(r);return rr(r===i?n[r]:n[i]+(r-i)*(n[i+1]-n[i]))};const Jn={};Jn.EXC=(n,e,t)=>{if(t=t===void 0?3:t,n=B(M(n)),e=N(e),t=N(t),O(n,e,t))return A;n=n.sort((o,u)=>o-u);const r=Ce.apply(null,n),i=n.length,c=r.length,a=Math.pow(10,t);let E=0,d=!1,s=0;for(;!d&&s<c;)e===r[s]?(E=(n.indexOf(r[s])+1)/(i+1),d=!0):e>=r[s]&&(e<r[s+1]||s===c-1)&&(E=(n.indexOf(r[s])+1+(e-r[s])/(r[s+1]-r[s]))/(i+1),d=!0),s++;return Math.floor(E*a)/a},Jn.INC=(n,e,t)=>{if(t=t===void 0?3:t,n=B(M(n)),e=N(e),t=N(t),O(n,e,t))return A;n=n.sort((o,u)=>o-u);const r=Ce.apply(null,n),i=n.length,c=r.length,a=Math.pow(10,t);let E=0,d=!1,s=0;for(;!d&&s<c;)e===r[s]?(E=n.indexOf(r[s])/(i-1),d=!0):e>=r[s]&&(e<r[s+1]||s===c-1)&&(E=(n.indexOf(r[s])+(e-r[s])/(r[s+1]-r[s]))/(i-1),d=!0),s++;return Math.floor(E*a)/a};function Co(n,e){return n=N(n),e=N(e),O(n,e)?A:Nn(n)/Nn(n-e)}function Ro(n,e){return n=N(n),e=N(e),O(n,e)?A:Math.pow(n,e)}function Do(n){return n=N(n),n instanceof Error?A:Math.exp(-.5*n*n)/to}const Ve={};Ve.DIST=(n,e,t)=>(n=N(n),e=N(e),O(n,e)?A:t?V.poisson.cdf(n,e):V.poisson.pdf(n,e));function Oo(n,e,t,r){if(t===void 0)return 0;if(r=r===void 0?t:r,n=B(M(n)),e=B(M(e)),t=N(t),r=N(r),O(n,e,t,r))return A;if(t===r)return n.indexOf(t)>=0?e[n.indexOf(t)]:0;const i=n.sort((E,d)=>E-d),c=i.length;let a=0;for(let E=0;E<c;E++)i[E]>=t&&i[E]<=r&&(a+=e[n.indexOf(i[E])]);return a}const Dn={};Dn.EXC=(n,e)=>{if(n=B(M(n)),e=N(e),O(n,e))return A;switch(e){case 1:return nn.EXC(n,.25);case 2:return nn.EXC(n,.5);case 3:return nn.EXC(n,.75);default:return R}},Dn.INC=(n,e)=>{if(n=B(M(n)),e=N(e),O(n,e))return A;switch(e){case 1:return nn.INC(n,.25);case 2:return nn.INC(n,.5);case 3:return nn.INC(n,.75);default:return R}};const Sn={};Sn.AVG=(n,e,t)=>{if(n=N(n),e=B(M(e)),O(n,e))return A;e=M(e),t=t||!1;const r=t?(a,E)=>a-E:(a,E)=>E-a;e=e.sort(r);const i=e.length;let c=0;for(let a=0;a<i;a++)e[a]===n&&c++;return c>1?(2*e.indexOf(n)+c+1)/2:e.indexOf(n)+1},Sn.EQ=(n,e,t)=>{if(n=N(n),e=B(M(e)),O(n,e))return A;t=t||!1;const r=t?(i,c)=>i-c:(i,c)=>c-i;return e=e.sort(r),e.indexOf(n)+1};function Lo(n,e){if(arguments.length!==2)return U;if(e<0)return R;if(!(n instanceof Array)||typeof e!="number")return A;if(n.length!==0)return V.row(n,e)}function Mo(n,e){return n=B(M(n)),e=B(M(e)),O(n,e)?A:Math.pow(vr(n,e),2)}function Be(){const n=B(M(arguments));if(n instanceof Error)return n;const e=V.mean(n),t=n.length;let r=0;for(let i=0;i<t;i++)r+=Math.pow(n[i]-e,3);return t*r/((t-1)*(t-2)*Math.pow(V.stdev(n,!0),3))}Be.P=function(){const n=B(M(arguments));if(n instanceof Error)return n;const e=V.mean(n),t=n.length;let r=0,i=0;for(let c=0;c<t;c++)i+=Math.pow(n[c]-e,3),r+=Math.pow(n[c]-e,2);return i=i/t,r=r/t,i/Math.pow(r,3/2)};function yo(n,e){if(n=B(M(n)),e=B(M(e)),O(n,e))return A;const t=V.mean(e),r=V.mean(n),i=e.length;let c=0,a=0;for(let E=0;E<i;E++)c+=(e[E]-t)*(n[E]-r),a+=Math.pow(e[E]-t,2);return c/a}function Er(n,e){return n=B(M(n)),e=N(e),O(n,e)?n:n.sort((t,r)=>t-r)[e-1]}function Po(n,e,t){return n=N(n),e=N(e),t=N(t),O(n,e,t)?A:(n-e)/t}const j={};j.P=function(){const n=b.P.apply(this,arguments);let e=Math.sqrt(n);return isNaN(e)&&(e=R),e},j.S=function(){const n=b.S.apply(this,arguments);return Math.sqrt(n)};function Vo(){const n=pr.apply(this,arguments);return Math.sqrt(n)}function Bo(){const n=Nr.apply(this,arguments);let e=Math.sqrt(n);return isNaN(e)&&(e=R),e}function qo(n,e){if(n=B(M(n)),e=B(M(e)),O(n,e))return A;const t=V.mean(e),r=V.mean(n),i=e.length;let c=0,a=0,E=0;for(let d=0;d<i;d++)c+=Math.pow(n[d]-r,2),a+=(e[d]-t)*(n[d]-r),E+=Math.pow(e[d]-t,2);return Math.sqrt((c-a*a/E)/(i-2))}const en={};en.DIST=(n,e,t)=>t!==1&&t!==2?R:t===1?en.DIST.RT(n,e):en.DIST["2T"](n,e),en.DIST["2T"]=function(n,e){return arguments.length!==2?U:n<0||e<1?R:typeof n!="number"||typeof e!="number"?A:(1-V.studentt.cdf(n,e))*2},en.DIST.RT=function(n,e){return arguments.length!==2?U:n<0||e<1?R:typeof n!="number"||typeof e!="number"?A:1-V.studentt.cdf(n,e)},en.INV=(n,e)=>(n=N(n),e=N(e),O(n,e)?A:V.studentt.inv(n,e)),en.INV["2T"]=(n,e)=>(n=N(n),e=N(e),n<=0||n>1||e<1?R:O(n,e)?A:Math.abs(V.studentt.inv(n/2,e))),en.TEST=(n,e)=>{if(n=B(M(n)),e=B(M(e)),O(n,e))return A;const t=V.mean(n),r=V.mean(e);let i=0,c=0,a;for(a=0;a<n.length;a++)i+=Math.pow(n[a]-t,2);for(a=0;a<e.length;a++)c+=Math.pow(e[a]-r,2);i=i/(n.length-1),c=c/(e.length-1);const E=Math.abs(t-r)/Math.sqrt(i/n.length+c/e.length);return en.DIST["2T"](E,n.length+e.length-2)};function Uo(n,e,t){if(n=B(M(n)),e=B(M(e)),t=B(M(t)),O(n,e,t))return A;const r=ye(n,e),i=r[0],c=r[1],a=[];return t.forEach(E=>{a.push(i*E+c)}),a}function Fo(n,e){if(n=B(M(n)),e=N(e),O(n,e))return A;const t=On(n.length*e,2)/2;return V.mean(wt(W(n.sort((r,i)=>r-i),t),t))}const b={};b.P=function(){const n=Fn(M(arguments)),e=n.length;let t=0;const r=Cn(n);let i;for(let c=0;c<e;c++)t+=Math.pow(n[c]-r,2);return i=t/e,isNaN(i)&&(i=R),i},b.S=function(){const n=Fn(M(arguments)),e=n.length;let t=0;const r=Cn(n);for(let i=0;i<e;i++)t+=Math.pow(n[i]-r,2);return t/(e-1)};function pr(){const n=M(arguments),e=n.length;let t=0,r=0;const i=Re(n);for(let c=0;c<e;c++){const a=n[c];typeof a=="number"?t+=Math.pow(a-i,2):a===!0?t+=Math.pow(1-i,2):t+=Math.pow(0-i,2),a!==null&&r++}return t/(r-1)}function Nr(){const n=M(arguments),e=n.length;let t=0,r=0;const i=Re(n);let c;for(let a=0;a<e;a++){const E=n[a];typeof E=="number"?t+=Math.pow(E-i,2):E===!0?t+=Math.pow(1-i,2):t+=Math.pow(0-i,2),E!==null&&r++}return c=t/r,isNaN(c)&&(c=R),c}const qe={};qe.DIST=(n,e,t,r)=>(n=N(n),e=N(e),t=N(t),O(n,e,t)?A:r?1-Math.exp(-Math.pow(n/t,e)):Math.pow(n,e-1)*Math.exp(-Math.pow(n/t,e))*e/Math.pow(t,e));const Ue={};Ue.TEST=(n,e,t)=>{if(n=B(M(n)),e=N(e),O(n,e))return A;t=t||j.S(n);const r=n.length;return 1-sn.S.DIST((Cn(n)-e)/(t/Math.sqrt(r)),!0)};function ko(n){return n=N(n),n instanceof Error?n:Math.abs(n)}function Go(n){if(n=N(n),n instanceof Error)return n;let e=Math.acos(n);return isNaN(e)&&(e=R),e}function Ho(n){if(n=N(n),n instanceof Error)return n;let e=Math.log(n+Math.sqrt(n*n-1));return isNaN(e)&&(e=R),e}function Yo(n){return n=N(n),n instanceof Error?n:Math.atan(1/n)}function $o(n){if(n=N(n),n instanceof Error)return n;let e=.5*Math.log((n+1)/(n-1));return isNaN(e)&&(e=R),e}function zo(n,e,t,r){if(n=N(n),e=N(n),O(n,e))return A;switch(n){case 1:return Cn(t);case 2:return Xn(t);case 3:return Qn(t);case 4:return ie(t);case 5:return ue(t);case 6:return se(t);case 7:return j.S(t);case 8:return j.P(t);case 9:return In(t);case 10:return b.S(t);case 11:return b.P(t);case 12:return dr(t);case 13:return Rn.SNGL(t);case 14:return hr(t,r);case 15:return Er(t,r);case 16:return nn.INC(t,r);case 17:return Dn.INC(t,r);case 18:return nn.EXC(t,r);case 19:return Dn.EXC(t,r)}}function Wo(n){if(n==null)return 0;if(n instanceof Error)return n;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(n))return A;let e=0;return n.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,t=>{e+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[t]}),e}function Ko(n){if(n=N(n),n instanceof Error)return n;let e=Math.asin(n);return isNaN(e)&&(e=R),e}function Xo(n){return n=N(n),n instanceof Error?n:Math.log(n+Math.sqrt(n*n+1))}function Qo(n){return n=N(n),n instanceof Error?n:Math.atan(n)}function Zo(n,e){n=N(n),e=N(e);const t=k(n,e);return t||Math.atan2(n,e)}function Jo(n){if(n=N(n),n instanceof Error)return n;let e=Math.log((1+n)/(1-n))/2;return isNaN(e)&&(e=R),e}function So(n,e,t){n=N(n),e=N(e),t=N(t);const r=k(n,e,t);if(r)return r;if(e===0)return R;const i=n.toString(e);return new Array(Math.max(t+1-i.length,0)).join("0")+i}function pn(n,e,t){n=N(n),e=N(e),t=N(t);const r=k(n,e,t);if(r)return r;if(e===0)return 0;e=Math.abs(e);const i=-Math.floor(Math.log(e)/Math.log(10));return n>=0?an(Math.ceil(n/e)*e,i):t===0?-an(Math.floor(Math.abs(n)/e)*e,i):-an(Math.ceil(Math.abs(n)/e)*e,i)}pn.MATH=pn,pn.PRECISE=pn;function $n(n,e){n=N(n),e=N(e);const t=k(n,e);return t||(n<e?R:Nn(n)/(Nn(e)*Nn(n-e)))}function bo(n,e){n=N(n),e=N(e);const t=k(n,e);return t||(n<e?R:n===0&&e===0?1:$n(n+e-1,n-1))}function xo(n){return n=N(n),n instanceof Error?n:Math.cos(n)}function jo(n){return n=N(n),n instanceof Error?n:(Math.exp(n)+Math.exp(-n))/2}function _o(n){return n=N(n),n instanceof Error?n:n===0?Z:1/Math.tan(n)}function ni(n){if(n=N(n),n instanceof Error)return n;if(n===0)return Z;const e=Math.exp(2*n);return(e+1)/(e-1)}function ei(n){return n=N(n),n instanceof Error?n:n===0?Z:1/Math.sin(n)}function ri(n){return n=N(n),n instanceof Error?n:n===0?Z:2/(Math.exp(n)-Math.exp(-n))}function ti(n,e){if(arguments.length<1)return A;n=N(n),e=N(e);const t=k(n,e);return t||(e===0?R:parseInt(n,e))}function oi(n){return n=N(n),n instanceof Error?n:n*180/Math.PI}function ii(n){return n=N(n),n instanceof Error?n:pn(n,-2,-1)}function ui(n){return arguments.length<1?U:arguments.length>1?me:(n=N(n),n instanceof Error||(n=Math.exp(n)),n)}const fe=[];function Nn(n){if(n=N(n),n instanceof Error)return n;const e=Math.floor(n);return e===0||e===1?1:(fe[e]>0||(fe[e]=Nn(e-1)*e),fe[e])}function Ir(n){if(n=N(n),n instanceof Error)return n;const e=Math.floor(n);return e<=0?1:e*Ir(e-2)}function On(n,e){n=N(n),e=N(e);const t=k(n,e);if(t)return t;if(e===0)return 0;if(!(n>=0&&e>0)&&!(n<=0&&e<0))return R;e=Math.abs(e);const r=-Math.floor(Math.log(e)/Math.log(10));return n>=0?an(Math.floor(n/e)*e,r):-an(Math.ceil(Math.abs(n)/e),r)}On.MATH=(n,e,t)=>{if(e instanceof Error)return e;e=e===void 0?0:e,n=N(n),e=N(e),t=N(t);const r=k(n,e,t);if(r)return r;if(e===0)return 0;e=e?Math.abs(e):1;const i=-Math.floor(Math.log(e)/Math.log(10));return n>=0?an(Math.floor(n/e)*e,i):t===0||t===void 0?-an(Math.ceil(Math.abs(n)/e)*e,i):-an(Math.floor(Math.abs(n)/e)*e,i)},On.PRECISE=On.MATH;function fi(){const n=B(M(arguments));if(n instanceof Error)return n;const e=n.length,t=n[0];let r=t<0?-t:t;for(let i=1;i<e;i++){const c=n[i];let a=c<0?-c:c;for(;r&&a;)r>a?r%=a:a%=r;r+=a}return r}function si(n){return n=N(n),n instanceof Error?n:Math.floor(n)}const li={CEILING:pn};function ci(){const n=B(M(arguments));if(n instanceof Error)return n;for(var e,t,r,i,c=1;(r=n.pop())!==void 0;){if(r===0)return 0;for(;r>1;){if(r%2){for(e=3,t=Math.floor(Math.sqrt(r));e<=t&&r%e;e+=2);i=e<=t?e:r}else i=2;for(r/=i,c*=i,e=n.length;e;n[--e]%i===0&&(n[e]/=i)===1&&n.splice(e,1));}}return c}function ai(n){return n=N(n),n instanceof Error?n:n===0?R:Math.log(n)}function gi(n,e){n=N(n),e=N(e);const t=k(n,e);return t||(n===0||e===0?R:Math.log(n)/Math.log(e))}function hi(n){return n=N(n),n instanceof Error?n:n===0?R:Math.log(n)/Math.log(10)}function di(n,e){return!Array.isArray(n)||!Array.isArray(e)||n.some(r=>!r.length)||e.some(r=>!r.length)||Te(n).some(r=>typeof r!="number")||Te(e).some(r=>typeof r!="number")||n[0].length!==e.length?A:Array(n.length).fill(0).map(()=>Array(e[0].length).fill(0)).map((r,i)=>r.map((c,a)=>n[i].reduce((E,d,s)=>E+d*e[s][a],0)))}function vi(n,e){n=N(n),e=N(e);const t=k(n,e);if(t)return t;if(e===0)return Z;let r=Math.abs(n%e);return r=n<0?e-r:r,e>0?r:-r}function Ei(n,e){n=N(n),e=N(e);const t=k(n,e);return t||(n*e===0?0:n*e<0?R:Math.round(n/e)*e)}function pi(){const n=B(M(arguments));if(n instanceof Error)return n;let e=0,t=1;for(let r=0;r<n.length;r++)e+=n[r],t*=Nn(n[r]);return Nn(e)/t}function Ni(n){return arguments.length>1?U:(n=parseInt(n),!n||n<=0?A:Array(n).fill(0).map(()=>Array(n).fill(0)).map((e,t)=>(e[t]=1,e)))}function Ii(n){if(n=N(n),n instanceof Error)return n;let e=Math.ceil(Math.abs(n));return e=e&1?e:e+1,n>=0?e:-e}function mi(){return Math.PI}function mr(n,e){n=N(n),e=N(e);const t=k(n,e);if(t)return t;if(n===0&&e===0)return R;const r=Math.pow(n,e);return isNaN(r)?R:r}function se(){const e=M(arguments).filter(i=>i!=null);if(e.length===0)return 0;const t=B(e);if(t instanceof Error)return t;let r=1;for(let i=0;i<t.length;i++)r*=t[i];return r}function wi(n,e){n=N(n),e=N(e);const t=k(n,e);return t||parseInt(n/e,10)}function Ti(n){return n=N(n),n instanceof Error?n:n*Math.PI/180}function Ai(){return Math.random()}function Ci(n,e){n=N(n),e=N(e);const t=k(n,e);return t||n+Math.ceil((e-n+1)*Math.random())-1}function Ri(n){if(n=N(n),n instanceof Error)return n;const e=String(n).split(""),t=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let r="",i=3;for(;i--;)r=(t[+e.pop()+i*10]||"")+r;return new Array(+e.join("")+1).join("M")+r}function an(n,e){n=N(n),e=N(e);const t=k(n,e);return t||+(Math.round(+(n+"e"+e))+"e"+e*-1)}function Di(n,e){n=N(n),e=N(e);const t=k(n,e);return t||(n>0?1:-1)*Math.floor(Math.abs(n)*Math.pow(10,e))/Math.pow(10,e)}function Oi(n,e){n=N(n),e=N(e);const t=k(n,e);return t||(n>0?1:-1)*Math.ceil(Math.abs(n)*Math.pow(10,e))/Math.pow(10,e)}function Li(n){return n=N(n),n instanceof Error?n:1/Math.cos(n)}function Mi(n){return n=N(n),n instanceof Error?n:2/(Math.exp(n)+Math.exp(-n))}function yi(n,e,t,r){if(n=N(n),e=N(e),t=N(t),r=B(r),O(n,e,t,r))return A;let i=r[0]*Math.pow(n,e);for(let c=1;c<r.length;c++)i+=r[c]*Math.pow(n,e+c*t);return i}function Pi(n){return n=N(n),n instanceof Error?n:n<0?-1:n===0?0:1}function Vi(n){return n=N(n),n instanceof Error?n:Math.sin(n)}function Bi(n){return n=N(n),n instanceof Error?n:(Math.exp(n)-Math.exp(-n))/2}function qi(n){return n=N(n),n instanceof Error?n:n<0?R:Math.sqrt(n)}function Ui(n){return n=N(n),n instanceof Error?n:Math.sqrt(n*Math.PI)}function Fi(n,e){if(n=N(n),n instanceof Error)return n;switch(n){case 1:return Cn(e);case 2:return Xn(e);case 3:return Qn(e);case 4:return ie(e);case 5:return ue(e);case 6:return se(e);case 7:return j.S(e);case 8:return j.P(e);case 9:return In(e);case 10:return b.S(e);case 11:return b.P(e);case 101:return Cn(e);case 102:return Xn(e);case 103:return Qn(e);case 104:return ie(e);case 105:return ue(e);case 106:return se(e);case 107:return j.S(e);case 108:return j.P(e);case 109:return In(e);case 110:return b.S(e);case 111:return b.P(e)}}function In(){let n=0;return J(Wn(arguments),e=>{if(n instanceof Error)return!1;if(e instanceof Error)n=e;else if(typeof e=="number")n+=e;else if(typeof e=="string"){const t=parseFloat(e);!isNaN(t)&&(n+=t)}else if(Array.isArray(e)){const t=In.apply(null,e);t instanceof Error?n=t:n+=t}}),n}function ki(n,e,t){if(n=M(n),t=t?M(t):n,n instanceof Error)return n;if(e==null||e instanceof Error)return 0;let r=0;const i=e==="*",c=i?null:Tn(e+"");for(let a=0;a<n.length;a++){const E=n[a],d=t[a];if(i)r+=E;else{const s=[cn(E,En)].concat(c);r+=An(s)?d:0}}return r}function Gi(){const n=Wn(arguments),e=B(M(n.shift()));if(e instanceof Error)return e;const t=n,r=t.length/2;for(let c=0;c<r;c++)t[c*2]=M(t[c*2]);let i=0;for(let c=0;c<e.length;c++){let a=!1;for(let E=0;E<r;E++){const d=t[E*2][c],s=t[E*2+1],o=s===void 0||s==="*";let u=!1;if(o)u=!0;else{const f=Tn(s+""),l=[cn(d,En)].concat(f);u=An(l)}if(!u){a=!1;break}a=!0}a&&(i+=e[c])}return i}function Hi(){if(!arguments||arguments.length===0)return A;const n=arguments.length+1;let e=0,t,r,i,c;for(let a=0;a<arguments[0].length;a++)if(arguments[0][a]instanceof Array)for(let E=0;E<arguments[0][a].length;E++){for(t=1,r=1;r<n;r++){const d=arguments[r-1][a][E];if(d instanceof Error)return d;if(c=N(d),c instanceof Error)return c;t*=c}e+=t}else{for(t=1,r=1;r<n;r++){const E=arguments[r-1][a];if(E instanceof Error)return E;if(i=N(E),i instanceof Error)return i;t*=i}e+=t}return e}function Yi(){const n=B(M(arguments));if(n instanceof Error)return n;let e=0;const t=n.length;for(let r=0;r<t;r++)e+=oe(n[r])?n[r]*n[r]:0;return e}function $i(n,e){if(n=B(M(n)),e=B(M(e)),O(n,e))return A;let t=0;for(let r=0;r<n.length;r++)t+=n[r]*n[r]-e[r]*e[r];return t}function zi(n,e){if(n=B(M(n)),e=B(M(e)),O(n,e))return A;let t=0;n=B(M(n)),e=B(M(e));for(let r=0;r<n.length;r++)t+=n[r]*n[r]+e[r]*e[r];return t}function Wi(n,e){if(n=B(M(n)),e=B(M(e)),O(n,e))return A;let t=0;n=M(n),e=M(e);for(let r=0;r<n.length;r++)t+=Math.pow(n[r]-e[r],2);return t}function Ki(n){return n=N(n),n instanceof Error?n:Math.tan(n)}function Xi(n){if(n=N(n),n instanceof Error)return n;const e=Math.exp(2*n);return(e-1)/(e+1)}function Qi(n,e){n=N(n),e=N(e);const t=k(n,e);return t||(n>0?1:-1)*Math.floor(Math.abs(n)*Math.pow(10,e))/Math.pow(10,e)}function Zi(n,e){if(arguments.length!==2)return U;n=N(n),e=N(e);const t=k(n,e);return t||n+e}function Ji(n,e){if(arguments.length!==2)return U;n=N(n),e=N(e);const t=k(n,e);return t||(e===0?Z:n/e)}function Si(n,e){return arguments.length!==2?U:n instanceof Error?n:e instanceof Error?e:(n===null&&(n=void 0),e===null&&(e=void 0),n===e)}function bi(n,e){if(arguments.length!==2)return U;if(n instanceof Error)return n;if(e instanceof Error)return e;ee(n,e)?(n=K(n),e=K(e)):(n=N(n),e=N(e));const t=k(n,e);return t||n>e}function xi(n,e){if(arguments.length!==2)return U;ee(n,e)?(n=K(n),e=K(e)):(n=N(n),e=N(e));const t=k(n,e);return t||n>=e}function ji(n,e){if(arguments.length!==2)return U;ee(n,e)?(n=K(n),e=K(e)):(n=N(n),e=N(e));const t=k(n,e);return t||n<e}function _i(n,e){if(arguments.length!==2)return U;ee(n,e)?(n=K(n),e=K(e)):(n=N(n),e=N(e));const t=k(n,e);return t||n<=e}function nu(n,e){if(arguments.length!==2)return U;n=N(n),e=N(e);const t=k(n,e);return t||n-e}function eu(n,e){if(arguments.length!==2)return U;n=N(n),e=N(e);const t=k(n,e);return t||n*e}function ru(n,e){return arguments.length!==2?U:n instanceof Error?n:e instanceof Error?e:(n===null&&(n=void 0),e===null&&(e=void 0),n!==e)}function tu(n,e){return arguments.length!==2?U:mr(n,e)}var ou=Object.freeze({__proto__:null,ADD:Zi,DIVIDE:Ji,EQ:Si,GT:bi,GTE:xi,LT:ji,LTE:_i,MINUS:nu,MULTIPLY:eu,NE:ru,POW:tu});const iu=new Date(Date.UTC(1900,0,1)),uu=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],fu=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],le=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function su(n,e,t){let r;return n=N(n),e=N(e),t=N(t),O(n,e,t)?r=A:(r=new Date(n,e-1,t),r.getFullYear()<0&&(r=R)),r}function Ln(n,e,t){t=t.toUpperCase(),n=G(n),e=G(e);const r=n.getFullYear(),i=n.getMonth(),c=n.getDate(),a=e.getFullYear(),E=e.getMonth(),d=e.getDate();let s;switch(t){case"Y":s=Math.floor(ke(n,e));break;case"D":s=Mn(e,n);break;case"M":s=E-i+12*(a-r),d<c&&s--;break;case"MD":c<=d?s=d-c:(E===0?(n.setFullYear(a-1),n.setMonth(12)):(n.setFullYear(a),n.setMonth(E-1)),s=Mn(e,n));break;case"YM":s=E-i+12*(a-r),d<c&&s--,s=s%12;break;case"YD":E>i||E===i&&d<c?n.setFullYear(a):n.setFullYear(a-1),s=Mn(e,n);break}return s}function lu(n){if(typeof n!="string")return A;const e=Date.parse(n);return isNaN(e)?A:new Date(n)}function cu(n){const e=G(n);return e instanceof Error?e:e.getDate()}function ce(n){const e=new Date(n);return e.setHours(0,0,0,0),e}function Mn(n,e){return n=G(n),e=G(e),n instanceof Error?n:e instanceof Error?e:Tr(ce(n))-Tr(ce(e))}function mn(n,e,t){if(t=Ae(t||"false"),n=G(n),e=G(e),n instanceof Error)return n;if(e instanceof Error)return e;if(t instanceof Error)return t;const r=n.getMonth();let i=e.getMonth(),c,a;if(t)c=n.getDate()===31?30:n.getDate(),a=e.getDate()===31?30:e.getDate();else{const E=new Date(n.getFullYear(),r+1,0).getDate(),d=new Date(e.getFullYear(),i+1,0).getDate();c=n.getDate()===E?30:n.getDate(),e.getDate()===d?c<30?(i++,a=1):a=30:a=e.getDate()}return 360*(e.getFullYear()-n.getFullYear())+30*(i-r)+(a-c)}function au(n,e){return n=G(n),n instanceof Error?n:isNaN(e)?A:(e=parseInt(e,10),n.setMonth(n.getMonth()+e),n)}function gu(n,e){return n=G(n),n instanceof Error?n:isNaN(e)?A:(e=parseInt(e,10),new Date(n.getFullYear(),n.getMonth()+e+1,0))}function hu(n){return n=G(n),n instanceof Error?n:n.getHours()}function wr(n){if(n=G(n),n instanceof Error)return n;n=ce(n),n.setDate(n.getDate()+4-(n.getDay()||7));const e=new Date(n.getFullYear(),0,1);return Math.ceil(((n-e)/864e5+1)/7)}function du(n){return n=G(n),n instanceof Error?n:n.getMinutes()}function vu(n){return n=G(n),n instanceof Error?n:n.getMonth()+1}function ae(n,e,t){return ae.INTL(n,e,1,t)}ae.INTL=(n,e,t,r)=>{if(n=G(n),n instanceof Error)return n;if(e=G(e),e instanceof Error)return e;let i=!1;const c=[],a=[1,2,3,4,5,6,0],E=new RegExp("^[0|1]{7}$");if(t===void 0)t=le[1];else if(typeof t=="string"&&E.test(t)){i=!0,t=t.split("");for(let u=0;u<t.length;u++)t[u]==="1"&&c.push(a[u])}else t=le[t];if(!(t instanceof Array))return A;r===void 0?r=[]:r instanceof Array||(r=[r]);for(let u=0;u<r.length;u++){const f=G(r[u]);if(f instanceof Error)return f;r[u]=f}const d=Math.round((e-n)/(1e3*60*60*24))+1;let s=d;const o=n;for(let u=0;u<d;u++){const f=new Date().getTimezoneOffset()>0?o.getUTCDay():o.getDay();let l=i?c.includes(f):f===t[0]||f===t[1];for(let g=0;g<r.length;g++){const h=r[g];if(h.getDate()===o.getDate()&&h.getMonth()===o.getMonth()&&h.getFullYear()===o.getFullYear()){l=!0;break}}l&&s--,o.setDate(o.getDate()+1)}return s};function Eu(){return new Date}function pu(n){return n=G(n),n instanceof Error?n:n.getSeconds()}function Nu(n,e,t){return n=N(n),e=N(e),t=N(t),O(n,e,t)?A:n<0||e<0||t<0?R:(3600*n+60*e+t)/86400}function Iu(n){return n=G(n),n instanceof Error?n:(3600*n.getHours()+60*n.getMinutes()+n.getSeconds())/86400}function mu(){return ce(new Date)}function wu(n,e){if(n=G(n),n instanceof Error)return n;e===void 0&&(e=1);const t=n.getDay();return fu[e][t]}function Tu(n,e){if(n=G(n),n instanceof Error)return n;if(e===void 0&&(e=1),e===21)return wr(n);const t=uu[e];let r=new Date(n.getFullYear(),0,1);const i=r.getDay()<t?1:0;return r-=Math.abs(r.getDay()-t)*24*60*60*1e3,Math.floor((n-r)/(1e3*60*60*24)/7+1)+i}function ge(n,e,t){return ge.INTL(n,e,1,t)}ge.INTL=(n,e,t,r)=>{if(n=G(n),n instanceof Error)return n;if(e=N(e),e instanceof Error)return e;if(e<0)return R;if(t===void 0?t=le[1]:t=le[t],!(t instanceof Array))return A;r===void 0?r=[]:r instanceof Array||(r=[r]);for(let c=0;c<r.length;c++){const a=G(r[c]);if(a instanceof Error)return a;r[c]=a}let i=0;for(;i<e;){n.setDate(n.getDate()+1);const c=n.getDay();if(!(c===t[0]||c===t[1])){for(let a=0;a<r.length;a++){const E=r[a];if(E.getDate()===n.getDate()&&E.getMonth()===n.getMonth()&&E.getFullYear()===n.getFullYear()){i--;break}}i++}}return n};function Au(n){return n=G(n),n instanceof Error?n:n.getFullYear()}function Fe(n){return new Date(n,1,29).getMonth()===1}function he(n,e){return Math.ceil((e-n)/1e3/60/60/24)}function ke(n,e,t){if(n=G(n),n instanceof Error)return n;if(e=G(e),e instanceof Error)return e;t=t||0;let r=n.getDate();const i=n.getMonth()+1,c=n.getFullYear();let a=e.getDate();const E=e.getMonth()+1,d=e.getFullYear();switch(t){case 0:return r===31&&a===31?(r=30,a=30):r===31?r=30:r===30&&a===31&&(a=30),(a+E*30+d*360-(r+i*30+c*360))/360;case 1:{const s=(g,h)=>{const v=g.getFullYear(),I=new Date(v,2,1);if(Fe(v)&&g<I&&h>=I)return!0;const m=h.getFullYear(),p=new Date(m,2,1);return Fe(m)&&h>=p&&g<p};let o=365;if(c===d||c+1===d&&(i>E||i===E&&r>=a))return(c===d&&Fe(c)||s(n,e)||E===1&&a===29)&&(o=366),he(n,e)/o;const u=d-c+1,l=(new Date(d+1,0,1)-new Date(c,0,1))/1e3/60/60/24/u;return he(n,e)/l}case 2:return he(n,e)/360;case 3:return he(n,e)/365;case 4:return(a+E*30+d*360-(r+i*30+c*360))/360}}function Tr(n){const e=n>-22038912e5?2:1;return Math.ceil((n-iu)/864e5)+e}function Cu(){throw new Error("ASC is not implemented")}function Ru(){throw new Error("BAHTTEXT is not implemented")}function Ar(n){return n=N(n),n===0?A:n instanceof Error?n:String.fromCharCode(n)}function Du(n){if(O(n))return n;n=n||"";const e=/[\0-\x1F]/g;return n.replace(e,"")}function Cr(n){if(O(n))return n;n=n||"";let e=n.charCodeAt(0);return isNaN(e)&&(e=A),e}function Rr(){const n=M(arguments),e=k.apply(void 0,n);if(e)return e;let t=0;for(;(t=n.indexOf(!0))>-1;)n[t]="TRUE";let r=0;for(;(r=n.indexOf(!1))>-1;)n[r]="FALSE";return n.join("")}const Ou=Rr;function Lu(){throw new Error("DBCS is not implemented")}function Mu(n,e=2){if(n=N(n),isNaN(n))return A;n=an(n,e);const t={style:"currency",currency:"USD",minimumFractionDigits:e>=0?e:0,maximumFractionDigits:e>=0?e:0},r=n.toLocaleString("en-US",t);return n<0?"$("+r.slice(2)+")":r}function yu(n,e){if(arguments.length!==2)return U;const t=k(n,e);return t||(n=K(n),e=K(e),n===e)}function Pu(n,e,t){if(arguments.length<2)return U;n=K(n),e=K(e),t=t===void 0?0:t;const r=e.indexOf(n,t-1);return r===-1?A:r+1}function Dr(n,e=2,t=!1){if(n=N(n),isNaN(n)||(e=N(e),isNaN(e)))return A;if(e<0){const r=Math.pow(10,-e);n=Math.round(n/r)*r}else n=n.toFixed(e);if(t)n=n.toString().replace(/,/g,"");else{const r=n.toString().split(".");r[0]=r[0].replace(/\B(?=(\d{3})+$)/g,","),n=r.join(".")}return n}function Vu(n,e){const t=k(n,e);return t||(n=K(n),e=e===void 0?1:e,e=N(e),e instanceof Error||typeof n!="string"?A:n.substring(0,e))}function Bu(n){return arguments.length===0?me:n instanceof Error?n:Array.isArray(n)?A:K(n).length}function qu(n){return arguments.length!==1?A:(n=K(n),O(n)?n:n.toLowerCase())}function Uu(n,e,t){if(e==null)return A;if(e=N(e),t=N(t),O(e,t)||typeof n!="string")return t;const r=e-1,i=r+t;return n.substring(r,i)}function Fu(n,e,t){return n=kn(n)?n:"",typeof n=="number"?n:typeof n!="string"?U:(e=typeof e>"u"?".":e,t=typeof t>"u"?",":t,Number(n.replace(e,".").replace(t,"")))}function ku(){throw new Error("PRONETIC is not implemented")}function Gu(n){return O(n)?n:isNaN(n)&&typeof n=="number"?A:(n=K(n),n.replace(/\w\S*/g,e=>e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()))}function Hu(n,e,t,r){return e=N(e),t=N(t),O(e,t)||typeof n!="string"||typeof r!="string"?A:n.substr(0,e-1)+r+n.substr(e-1+t)}function rn(n,e){const t=k(n,e);return t||(n=K(n),e=N(e),e instanceof Error?e:new Array(e+1).join(n))}function Yu(n,e){const t=k(n,e);return t||(n=K(n),e=e===void 0?1:e,e=N(e),e instanceof Error?e:n.substring(n.length-e))}function $u(n,e,t){let r;return typeof n!="string"||typeof e!="string"?A:(t=t===void 0?0:t,r=e.toLowerCase().indexOf(n.toLowerCase(),t-1)+1,r===0?A:r)}function zu(n,e,t,r){if(arguments.length<3)return U;if(!n||!e)return n;if(r===void 0)return n.split(e).join(t);{if(r=Math.floor(Number(r)),Number.isNaN(r)||r<=0)return A;let i=0,c=0;for(;i>-1&&n.indexOf(e,i)>-1;)if(i=n.indexOf(e,i+1),c++,i>-1&&c===r)return n.substring(0,i)+t+n.substring(i+e.length);return n}}function Wu(n){return n instanceof Error||typeof n=="string"?n:""}function Ku(n,e){if(n===void 0||n instanceof Error||e instanceof Error)return U;if(e==null)return"";if(typeof e=="number")return String(e);if(typeof e!="string")return A;const t=e.startsWith("$")?"$":"",r=e.endsWith("%");e=e.replace(/%/g,"").replace(/\$/g,"");const i=e.split(".")[1].match(/0/g).length,c=!e.includes(",");return r&&(n=n*100),n=Dr(n,i,c),n.startsWith("-")?(n=n.replace("-",""),n="-"+t+n):n=t+n,r&&(n=n+"%"),n}function Xu(n,e,...t){if(typeof e!="boolean"&&(e=Ae(e)),arguments.length<3)return U;n=n??"";let r=M(t),i=e?r.filter(c=>c):r;if(Array.isArray(n)){n=M(n);let c=i.map(E=>[E]),a=0;for(let E=0;E<c.length-1;E++)c[E].push(n[a]),a++,a===n.length&&(a=0);return i=M(c),i.join("")}return i.join(n)}function Qu(n){return n=K(n),n instanceof Error?n:n.replace(/\s+/g," ").trim()}const Zu=Ar,Ju=Cr;function Su(n){return n=K(n),n instanceof Error?n:n.toUpperCase()}function bu(n){const e=k(n);if(e)return e;if(typeof n=="number")return n;if(kn(n)||(n=""),typeof n!="string")return A;const t=/(%)$/.test(n)||/^(%)/.test(n);if(n=n.replace(/^[^0-9-]{0,3}/,""),n=n.replace(/[^0-9]{0,3}$/,""),n=n.replace(/[ ,]/g,""),n==="")return 0;let r=Number(n);return isNaN(r)?A:(r=r||0,t&&(r=r*.01),r)}function Ge(n){return/^[01]{1,10}$/.test(n)}function xu(n,e){return n=N(n),e=N(e),O(n,e)?A:jn.besseli(n,e)}function ju(n,e){return n=N(n),e=N(e),O(n,e)?A:jn.besselj(n,e)}function _u(n,e){return n=N(n),e=N(e),O(n,e)?A:jn.besselk(n,e)}function nf(n,e){return n=N(n),e=N(e),O(n,e)?A:jn.bessely(n,e)}function ef(n){if(!Ge(n))return R;const e=parseInt(n,2),t=n.toString();return t.length===10&&t.substring(0,1)==="1"?parseInt(t.substring(1),2)-512:e}function rf(n,e){if(!Ge(n))return R;const t=n.toString();if(t.length===10&&t.substring(0,1)==="1")return(0xfffffffe00+parseInt(t.substring(1),2)).toString(16);const r=parseInt(n,2).toString(16);return e===void 0?r:isNaN(e)?A:e<0?R:(e=Math.floor(e),e>=r.length?rn("0",e-r.length)+r:R)}function tf(n,e){if(!Ge(n))return R;const t=n.toString();if(t.length===10&&t.substring(0,1)==="1")return(1073741312+parseInt(t.substring(1),2)).toString(8);const r=parseInt(n,2).toString(8);return e===void 0?r:isNaN(e)?A:e<0?R:(e=Math.floor(e),e>=r.length?rn("0",e-r.length)+r:R)}function of(n,e){return n=N(n),e=N(e),O(n,e)?A:n<0||e<0||Math.floor(n)!==n||Math.floor(e)!==e||n>0xffffffffffff||e>0xffffffffffff?R:n&e}function uf(n,e){return n=N(n),e=N(e),O(n,e)?A:n<0||Math.floor(n)!==n||n>0xffffffffffff||Math.abs(e)>53?R:e>=0?n<<e:n>>-e}function ff(n,e){return n=N(n),e=N(e),O(n,e)?A:n<0||e<0||Math.floor(n)!==n||Math.floor(e)!==e||n>0xffffffffffff||e>0xffffffffffff?R:n|e}function sf(n,e){return n=N(n),e=N(e),O(n,e)?A:n<0||Math.floor(n)!==n||n>0xffffffffffff||Math.abs(e)>53?R:e>=0?n>>e:n<<-e}function lf(n,e){return n=N(n),e=N(e),O(n,e)?A:n<0||e<0||Math.floor(n)!==n||Math.floor(e)!==e||n>0xffffffffffff||e>0xffffffffffff?R:n^e}function S(n,e,t){if(n=N(n),e=N(e),O(n,e))return n;if(t=t===void 0?"i":t,t!=="i"&&t!=="j")return A;if(n===0&&e===0)return 0;if(n===0)return e===1?t:e.toString()+t;if(e===0)return n.toString();{const r=e>0?"+":"";return n.toString()+r+(e===1?t:e.toString()+t)}}function cf(n,e,t){if(n=N(n),n instanceof Error)return n;const r=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ngstrm","",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ngstrm","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestrke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ngstrm","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],i={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},c={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};let a=null,E=null,d=e,s=t,o=1,u=1,f;for(let l=0;l<r.length;l++)f=r[l][2]===null?[]:r[l][2],(r[l][1]===d||f.indexOf(d)>=0)&&(a=r[l]),(r[l][1]===s||f.indexOf(s)>=0)&&(E=r[l]);if(a===null){const l=i[e.substring(0,2)];let g=c[e.substring(0,1)];e.substring(0,2)==="da"&&(g=["dekao",10,"da"]),l?(o=l[2],d=e.substring(2)):g&&(o=g[1],d=e.substring(g[2].length));for(let h=0;h<r.length;h++)f=r[h][2]===null?[]:r[h][2],(r[h][1]===d||f.indexOf(d)>=0)&&(a=r[h])}if(E===null){const l=i[t.substring(0,2)];let g=c[t.substring(0,1)];t.substring(0,2)==="da"&&(g=["dekao",10,"da"]),l?(u=l[2],s=t.substring(2)):g&&(u=g[1],s=t.substring(g[2].length));for(let h=0;h<r.length;h++)f=r[h][2]===null?[]:r[h][2],(r[h][1]===s||f.indexOf(s)>=0)&&(E=r[h])}return a===null||E===null||a[3]!==E[3]?U:n*a[6]*o/(E[6]*u)}function af(n,e){if(n=N(n),n instanceof Error)return n;if(!/^-?[0-9]{1,3}$/.test(n)||n<-512||n>511)return R;if(n<0)return"1"+rn("0",9-(512+n).toString(2).length)+(512+n).toString(2);const t=parseInt(n,10).toString(2);return typeof e>"u"?t:isNaN(e)?A:e<0?R:(e=Math.floor(e),e>=t.length?rn("0",e-t.length)+t:R)}function gf(n,e){if(n=N(n),n instanceof Error)return n;if(!/^-?[0-9]{1,12}$/.test(n)||n<-549755813888||n>549755813887)return R;if(n<0)return(1099511627776+n).toString(16);const t=parseInt(n,10).toString(16);return typeof e>"u"?t:isNaN(e)?A:e<0?R:(e=Math.floor(e),e>=t.length?rn("0",e-t.length)+t:R)}function hf(n,e){if(n=N(n),n instanceof Error)return n;if(!/^-?[0-9]{1,9}$/.test(n)||n<-536870912||n>536870911)return R;if(n<0)return(1073741824+n).toString(8);const t=parseInt(n,10).toString(8);return typeof e>"u"?t:isNaN(e)?A:e<0?R:(e=Math.floor(e),e>=t.length?rn("0",e-t.length)+t:R)}function df(n,e){return e=e===void 0?0:e,n=N(n),e=N(e),O(n,e)?A:n===e?1:0}function He(n,e){return e=e===void 0?0:e,n=N(n),e=N(e),O(n,e)?A:V.erf(n)}He.PRECISE=()=>{throw new Error("ERF.PRECISE is not implemented")};function Ye(n){return isNaN(n)?A:V.erfc(n)}Ye.PRECISE=()=>{throw new Error("ERFC.PRECISE is not implemented")};function vf(n,e){return e=e||0,n=N(n),O(e,n)?n:n>=e?1:0}function Ef(n,e){if(!/^[0-9A-Fa-f]{1,10}$/.test(n))return R;const t=n.length===10&&n.substring(0,1).toLowerCase()==="f",r=t?parseInt(n,16)-1099511627776:parseInt(n,16);if(r<-512||r>511)return R;if(t)return"1"+rn("0",9-(512+r).toString(2).length)+(512+r).toString(2);const i=r.toString(2);return e===void 0?i:isNaN(e)?A:e<0?R:(e=Math.floor(e),e>=i.length?rn("0",e-i.length)+i:R)}function pf(n){if(!/^[0-9A-Fa-f]{1,10}$/.test(n))return R;const e=parseInt(n,16);return e>=549755813888?e-1099511627776:e}function Nf(n,e){if(!/^[0-9A-Fa-f]{1,10}$/.test(n))return R;const t=parseInt(n,16);if(t>536870911&&t<0xffe0000000)return R;if(t>=0xffe0000000)return(t-0xffc0000000).toString(8);const r=t.toString(8);return e===void 0?r:isNaN(e)?A:e<0?R:(e=Math.floor(e),e>=r.length?rn("0",e-r.length)+r:R)}function $e(n){const e=$(n),t=Y(n);return O(e,t)?A:Math.sqrt(Math.pow(e,2)+Math.pow(t,2))}function Y(n){if(n===void 0||n===!0||n===!1)return A;if(n===0||n==="0")return 0;if(["i","j"].indexOf(n)>=0)return 1;n=n+"",n=n.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");let e=n.indexOf("+"),t=n.indexOf("-");e===0&&(e=n.indexOf("+",1)),t===0&&(t=n.indexOf("-",1));const r=n.substring(n.length-1,n.length),i=r==="i"||r==="j";return e>=0||t>=0?i?e>=0?isNaN(n.substring(0,e))||isNaN(n.substring(e+1,n.length-1))?R:Number(n.substring(e+1,n.length-1)):isNaN(n.substring(0,t))||isNaN(n.substring(t+1,n.length-1))?R:-Number(n.substring(t+1,n.length-1)):R:i?isNaN(n.substring(0,n.length-1))?R:n.substring(0,n.length-1):isNaN(n)?R:0}function ze(n){const e=$(n),t=Y(n);return O(e,t)?A:e===0&&t===0?Z:e===0&&t>0?Math.PI/2:e===0&&t<0?-Math.PI/2:t===0&&e>0?0:t===0&&e<0?-Math.PI:e>0?Math.atan(t/e):e<0&&t>=0?Math.atan(t/e)+Math.PI:Math.atan(t/e)-Math.PI}function If(n){const e=$(n),t=Y(n);if(O(e,t))return A;let r=n.substring(n.length-1);return r=r==="i"||r==="j"?r:"i",t!==0?S(e,-t,r):n}function de(n){const e=$(n),t=Y(n);if(O(e,t))return A;let r=n.substring(n.length-1);return r=r==="i"||r==="j"?r:"i",S(Math.cos(e)*(Math.exp(t)+Math.exp(-t))/2,-Math.sin(e)*(Math.exp(t)-Math.exp(-t))/2,r)}function Or(n){const e=$(n),t=Y(n);if(O(e,t))return A;let r=n.substring(n.length-1);return r=r==="i"||r==="j"?r:"i",S(Math.cos(t)*(Math.exp(e)+Math.exp(-e))/2,Math.sin(t)*(Math.exp(e)-Math.exp(-e))/2,r)}function mf(n){const e=$(n),t=Y(n);return O(e,t)?A:yn(de(n),ve(n))}function yn(n,e){const t=$(n),r=Y(n),i=$(e),c=Y(e);if(O(t,r,i,c))return A;const a=n.substring(n.length-1),E=e.substring(e.length-1);let d="i";if((a==="j"||E==="j")&&(d="j"),i===0&&c===0)return R;const s=i*i+c*c;return S((t*i+r*c)/s,(r*i-t*c)/s,d)}function wf(n){const e=$(n),t=Y(n);if(O(e,t))return A;let r=n.substring(n.length-1);r=r==="i"||r==="j"?r:"i";const i=Math.exp(e);return S(i*Math.cos(t),i*Math.sin(t),r)}function Tf(n){const e=$(n),t=Y(n);if(O(e,t))return A;let r=n.substring(n.length-1);return r=r==="i"||r==="j"?r:"i",S(Math.log(Math.sqrt(e*e+t*t)),Math.atan(t/e),r)}function Af(n){const e=$(n),t=Y(n);if(O(e,t))return A;let r=n.substring(n.length-1);return r=r==="i"||r==="j"?r:"i",S(Math.log(Math.sqrt(e*e+t*t))/Math.log(10),Math.atan(t/e)/Math.log(10),r)}function Cf(n){const e=$(n),t=Y(n);if(O(e,t))return A;let r=n.substring(n.length-1);return r=r==="i"||r==="j"?r:"i",S(Math.log(Math.sqrt(e*e+t*t))/Math.log(2),Math.atan(t/e)/Math.log(2),r)}function Rf(n,e){e=N(e);const t=$(n),r=Y(n);if(O(e,t,r))return A;let i=n.substring(n.length-1);i=i==="i"||i==="j"?i:"i";const c=Math.pow($e(n),e),a=ze(n);return S(c*Math.cos(e*a),c*Math.sin(e*a),i)}function Df(){let n=arguments[0];if(!arguments.length)return A;for(let e=1;e<arguments.length;e++){const t=$(n),r=Y(n),i=$(arguments[e]),c=Y(arguments[e]);if(O(t,r,i,c))return A;n=S(t*i-r*c,t*c+r*i)}return n}function $(n){if(n===void 0||n===!0||n===!1)return A;if(n===0||n==="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(n)>=0)return 0;n=n+"";let e=n.indexOf("+"),t=n.indexOf("-");e===0&&(e=n.indexOf("+",1)),t===0&&(t=n.indexOf("-",1));const r=n.substring(n.length-1,n.length),i=r==="i"||r==="j";return e>=0||t>=0?i?e>=0?isNaN(n.substring(0,e))||isNaN(n.substring(e+1,n.length-1))?R:Number(n.substring(0,e)):isNaN(n.substring(0,t))||isNaN(n.substring(t+1,n.length-1))?R:Number(n.substring(0,t)):R:i?isNaN(n.substring(0,n.length-1))?R:0:isNaN(n)?R:n}function Of(n){if(n===!0||n===!1)return A;const e=$(n),t=Y(n);return O(e,t)?A:yn("1",de(n))}function Lf(n){const e=$(n),t=Y(n);return O(e,t)?A:yn("1",Or(n))}function ve(n){const e=$(n),t=Y(n);if(O(e,t))return A;let r=n.substring(n.length-1);return r=r==="i"||r==="j"?r:"i",S(Math.sin(e)*(Math.exp(t)+Math.exp(-t))/2,Math.cos(e)*(Math.exp(t)-Math.exp(-t))/2,r)}function Lr(n){const e=$(n),t=Y(n);if(O(e,t))return A;let r=n.substring(n.length-1);return r=r==="i"||r==="j"?r:"i",S(Math.cos(t)*(Math.exp(e)-Math.exp(-e))/2,Math.sin(t)*(Math.exp(e)+Math.exp(-e))/2,r)}function Mf(n){const e=$(n),t=Y(n);if(O(e,t))return A;let r=n.substring(n.length-1);r=r==="i"||r==="j"?r:"i";const i=Math.sqrt($e(n)),c=ze(n);return S(i*Math.cos(c/2),i*Math.sin(c/2),r)}function yf(n){if(n===!0||n===!1)return A;const e=$(n),t=Y(n);return O(e,t)?R:yn("1",ve(n))}function Pf(n){if(n===!0||n===!1)return A;const e=$(n),t=Y(n);return O(e,t)?R:yn("1",Lr(n))}function Vf(n,e){const t=$(n),r=Y(n),i=$(e),c=Y(e);if(O(t,r,i,c))return A;const a=n.substring(n.length-1),E=e.substring(e.length-1);let d="i";return(a==="j"||E==="j")&&(d="j"),S(t-i,r-c,d)}function Bf(){if(!arguments.length)return A;const n=M(arguments);let e=n[0];for(let t=1;t<n.length;t++){const r=$(e),i=Y(e),c=$(n[t]),a=Y(n[t]);if(O(r,i,c,a))return A;e=S(r+c,i+a)}return e}function qf(n){if(n===!0||n===!1)return A;const e=$(n),t=Y(n);return O(e,t)?A:yn(ve(n),de(n))}function Uf(n,e){if(!/^[0-7]{1,10}$/.test(n))return R;const t=n.length===10&&n.substring(0,1)==="7",r=t?parseInt(n,8)-1073741824:parseInt(n,8);if(r<-512||r>511)return R;if(t)return"1"+rn("0",9-(512+r).toString(2).length)+(512+r).toString(2);const i=r.toString(2);return typeof e>"u"?i:isNaN(e)?A:e<0?R:(e=Math.floor(e),e>=i.length?rn("0",e-i.length)+i:R)}function Ff(n){if(!/^[0-7]{1,10}$/.test(n))return R;const e=parseInt(n,8);return e>=536870912?e-1073741824:e}function kf(n,e){if(!/^[0-7]{1,10}$/.test(n))return R;const t=parseInt(n,8);if(t>=536870912)return"ff"+(t+3221225472).toString(16);const r=t.toString(16);return e===void 0?r:isNaN(e)?A:e<0?R:(e=Math.floor(e),e>=r.length?rn("0",e-r.length)+r:R)}const Gf=Kn.DIST,Hf=Kn.INV,Yf=Gn.DIST,$f=pn.MATH,zf=pn.PRECISE,Wf=un.DIST,Kf=un.DIST.RT,Xf=un.INV,Qf=un.INV.RT,Zf=un.TEST,Jf=Hn.P,Sf=Hn.P,bf=Hn.S,xf=Gn.INV,jf=Ye.PRECISE,_f=He.PRECISE,ns=Oe.DIST,es=fn.DIST,rs=fn.DIST.RT,ts=fn.INV,os=fn.INV.RT,is=On.MATH,us=On.PRECISE,fs=fn.TEST,ss=Zn.DIST,ls=Zn.INV,cs=Le.PRECISE,as=Me.DIST,gs=Yn.INV,hs=Yn.DIST,ds=Yn.INV,vs=Rn.MULT,Es=Rn.SNGL,ps=Pe.DIST,Ns=ae.INTL,Is=sn.DIST,ms=sn.INV,ws=sn.S.DIST,Ts=sn.S.INV,As=nn.EXC,Cs=nn.INC,Rs=Jn.EXC,Ds=Jn.INC,Os=Ve.DIST,Ls=Dn.EXC,Ms=Dn.INC,ys=Sn.AVG,Ps=Sn.EQ,Vs=Be.P,Bs=j.P,qs=j.S,Us=en.DIST,Fs=en.DIST.RT,ks=en.INV,Gs=en.TEST,Hs=b.P,Ys=b.S,$s=qe.DIST,zs=ge.INTL,Ws=Ue.TEST;function We(n){const e=[];return J(n,t=>{t&&e.push(t)}),e}function on(n,e){const t={};for(let c=1;c<n[0].length;++c)t[c]=!0;let r=e[0].length;for(let c=1;c<e.length;++c)e[c].length>r&&(r=e[c].length);for(let c=1;c<n.length;++c)for(let a=1;a<n[c].length;++a){let E=!1,d=!1;for(let s=0;s<e.length;++s){const o=e[s];if(o.length<r)continue;const u=o[0];if(n[c][0]===u){d=!0;for(let f=1;f<o.length;++f)if(!E)if(o[f]===void 0||o[f]==="*")E=!0;else{const g=Tn(o[f]+""),h=[cn(n[c][a],En)].concat(g);E=An(h)}}}d&&(t[a]=t[a]&&E)}const i=[];for(let c=0;c<n[0].length;++c)t[c]&&i.push(c-1);return i}function Ks(n,e,t){if(isNaN(e)&&typeof e!="string")return A;const r=on(n,t);let i=[];if(typeof e=="string"){const a=tn(n,e);i=W(n[a])}else i=W(n[e]);let c=0;return J(r,a=>{c+=i[a]}),r.length===0?Z:c/r.length}function Xs(n,e,t){if(isNaN(e)&&typeof e!="string")return A;const r=on(n,t);let i=[];if(typeof e=="string"){const a=tn(n,e);i=W(n[a])}else i=W(n[e]);const c=[];return J(r,a=>{c.push(i[a])}),Xn(c)}function Qs(n,e,t){if(isNaN(e)&&typeof e!="string")return A;const r=on(n,t);let i=[];if(typeof e=="string"){const a=tn(n,e);i=W(n[a])}else i=W(n[e]);const c=[];return J(r,a=>{c.push(i[a])}),Qn(c)}function Zs(n,e,t){if(isNaN(e)&&typeof e!="string")return A;const r=on(n,t);let i=[];if(typeof e=="string"){const c=tn(n,e);i=W(n[c])}else i=W(n[e]);return r.length===0?A:r.length>1?R:i[r[0]]}function Js(n,e,t){if(isNaN(e)&&typeof e!="string")return A;const r=on(n,t);let i=[];if(typeof e=="string"){const a=tn(n,e);i=W(n[a])}else i=W(n[e]);let c=i[r[0]];return J(r,a=>{c<i[a]&&(c=i[a])}),c}function Ss(n,e,t){if(isNaN(e)&&typeof e!="string")return A;const r=on(n,t);let i=[];if(typeof e=="string"){const a=tn(n,e);i=W(n[a])}else i=W(n[e]);let c=i[r[0]];return J(r,a=>{c>i[a]&&(c=i[a])}),c}function bs(n,e,t){if(isNaN(e)&&typeof e!="string")return A;const r=on(n,t);let i=[];if(typeof e=="string"){const E=tn(n,e);i=W(n[E])}else i=W(n[e]);let c=[];J(r,E=>{c.push(i[E])}),c=We(c);let a=1;return J(c,E=>{a*=E}),a}function xs(n,e,t){if(isNaN(e)&&typeof e!="string")return A;const r=on(n,t);let i=[];if(typeof e=="string"){const a=tn(n,e);i=W(n[a])}else i=W(n[e]);let c=[];return J(r,a=>{c.push(i[a])}),c=We(c),j.S(c)}function js(n,e,t){if(isNaN(e)&&typeof e!="string")return A;const r=on(n,t);let i=[];if(typeof e=="string"){const a=tn(n,e);i=W(n[a])}else i=W(n[e]);let c=[];return J(r,a=>{c.push(i[a])}),c=We(c),j.P(c)}function _s(n,e,t){if(isNaN(e)&&typeof e!="string")return A;const r=on(n,t);let i=[];if(typeof e=="string"){const a=tn(n,e);i=W(n[a])}else i=W(n[e]);const c=[];return J(r,a=>{c.push(i[a])}),In(c)}function nl(n,e,t){if(isNaN(e)&&typeof e!="string")return A;const r=on(n,t);let i=[];if(typeof e=="string"){const a=tn(n,e);i=W(n[a])}else i=W(n[e]);const c=[];return J(r,a=>{c.push(i[a])}),b.S(c)}function el(n,e,t){if(isNaN(e)&&typeof e!="string")return A;const r=on(n,t);let i=[];if(typeof e=="string"){const a=tn(n,e);i=W(n[a])}else i=W(n[e]);const c=[];return J(r,a=>{c.push(i[a])}),b.P(c)}function Ke(n){return n&&n.getTime&&!isNaN(n.getTime())}function Xe(n){return n instanceof Date?n:new Date(n)}function rl(n,e,t,r,i,c,a){return n=Xe(n),e=Xe(e),t=Xe(t),!Ke(n)||!Ke(e)||!Ke(t)?A:r<=0||i<=0||[1,2,4].indexOf(c)===-1||[0,1,2,3,4].indexOf(a)===-1||t<=n?R:(i=i||0,a=a||0,i*r*ke(n,t,a))}function tl(){throw new Error("ACCRINTM is not implemented")}function ol(){throw new Error("AMORDEGRC is not implemented")}function il(){throw new Error("AMORLINC is not implemented")}function ul(){throw new Error("COUPDAYBS is not implemented")}function fl(){throw new Error("COUPDAYS is not implemented")}function sl(){throw new Error("COUPDAYSNC is not implemented")}function ll(){throw new Error("COUPNCD is not implemented")}function cl(){throw new Error("COUPNUM is not implemented")}function al(){throw new Error("COUPPCD is not implemented")}function gl(n,e,t,r,i,c){if(n=N(n),e=N(e),t=N(t),O(n,e,t))return A;if(n<=0||e<=0||t<=0||r<1||i<1||r>i||c!==0&&c!==1)return R;const a=bn(n,e,t,0,c);let E=0;r===1&&(c===0&&(E=-t),r++);for(let d=r;d<=i;d++)E+=c===1?Pn(n,d-2,a,t,1)-a:Pn(n,d-1,a,t,0);return E*=n,E}function hl(n,e,t,r,i,c){if(n=N(n),e=N(e),t=N(t),O(n,e,t))return A;if(n<=0||e<=0||t<=0||r<1||i<1||r>i||c!==0&&c!==1)return R;const a=bn(n,e,t,0,c);let E=0;r===1&&(E=c===0?a+t*n:a,r++);for(let d=r;d<=i;d++)E+=c>0?a-(Pn(n,d-2,a,t,1)-a)*n:a-Pn(n,d-1,a,t,0)*n;return E}function dl(n,e,t,r,i){if(i=i===void 0?12:i,n=N(n),e=N(e),t=N(t),r=N(r),i=N(i),O(n,e,t,r,i))return A;if(n<0||e<0||t<0||r<0||[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(i)===-1||r>t)return R;if(e>=n)return 0;const c=(1-Math.pow(e/n,1/t)).toFixed(3),a=n*c*i/12;let E=a,d=0;const s=r===t?t-1:r;for(let o=2;o<=s;o++)d=(n-E)*c,E+=d;return r===1?a:r===t?(n-E)*c:d}function vl(n,e,t,r,i){if(i=i===void 0?2:i,n=N(n),e=N(e),t=N(t),r=N(r),i=N(i),O(n,e,t,r,i))return A;if(n<0||e<0||t<0||r<0||i<=0||r>t)return R;if(e>=n)return 0;let c=0,a=0;for(let E=1;E<=r;E++)a=Math.min((n-c)*(i/t),n-e-c),c+=a;return a}function El(n,e,t,r,i){if(n=G(n),e=G(e),t=N(t),r=N(r),i=N(i),i=i||0,O(n,e,t,r,i))return A;if(t<=0||r<=0)return R;if(n>=e)return A;let c,a;switch(i){case 0:c=360,a=mn(n,e,!1);break;case 1:c=365,a=Ln(n,e,"D");break;case 2:c=360,a=Ln(n,e,"D");break;case 3:c=365,a=Ln(n,e,"D");break;case 4:c=360,a=mn(n,e,!0);break;default:return R}return(r-t)/r*c/a}function pl(n,e){if(n=N(n),e=N(e),O(n,e))return A;if(e<0)return R;if(e>=0&&e<1)return Z;e=parseInt(e,10);let t=parseInt(n,10);t+=n%1*Math.pow(10,Math.ceil(Math.log(e)/Math.LN10))/e;const r=Math.pow(10,Math.ceil(Math.log(e)/Math.LN2)+1);return t=Math.round(t*r)/r,t}function Nl(n,e){if(n=N(n),e=N(e),O(n,e))return A;if(e<0)return R;if(e>=0&&e<1)return Z;e=parseInt(e,10);let t=parseInt(n,10);return t+=n%1*Math.pow(10,-Math.ceil(Math.log(e)/Math.LN10))*e,t}function Il(){throw new Error("DURATION is not implemented")}function ml(n,e){return n=N(n),e=N(e),O(n,e)?A:n<=0||e<1?R:(e=parseInt(e,10),Math.pow(1+n/e,e)-1)}function Pn(n,e,t,r,i){if(r=r||0,i=i||0,n=N(n),e=N(e),t=N(t),r=N(r),i=N(i),O(n,e,t,r,i))return A;let c;if(n===0)c=r+t*e;else{const a=Math.pow(1+n,e);c=i===1?r*a+t*(1+n)*(a-1)/n:r*a+t*(a-1)/n}return-c}function wl(n,e){if(n=N(n),e=B(M(e)),O(n,e))return A;const t=e.length;let r=n;for(let i=0;i<t;i++)r*=1+e[i];return r}function Tl(){throw new Error("INTRATE is not implemented")}function Mr(n,e,t,r,i,c){if(i=i||0,c=c||0,n=N(n),e=N(e),t=N(t),r=N(r),i=N(i),c=N(c),O(n,e,t,r,i,c))return A;const a=bn(n,t,r,i,c);return(e===1?c===1?0:-r:c===1?Pn(n,e-2,a,r,1)-a:Pn(n,e-1,a,r,0))*n}function Al(n,e){if(e=e||0,n=B(M(n)),e=N(e),O(n,e))return A;const t=(l,g,h)=>{const v=h+1;let I=l[0];for(let m=1;m<l.length;m++)I+=l[m]/Math.pow(v,(g[m]-g[0])/365);return I},r=(l,g,h)=>{const v=h+1;let I=0;for(let m=1;m<l.length;m++){const p=(g[m]-g[0])/365;I-=p*l[m]/Math.pow(v,p+1)}return I},i=[];let c=!1,a=!1;for(let l=0;l<n.length;l++)i[l]=l===0?0:i[l-1]+365,n[l]>0&&(c=!0),n[l]<0&&(a=!0);if(!c||!a)return R;e=e===void 0?.1:e;let E=e;const d=1e-10;let s,o,u,f=!0;do u=t(n,i,E),s=E-u/r(n,i,E),o=Math.abs(s-E),E=s,f=o>d&&Math.abs(u)>d;while(f);return E}function Cl(n,e,t,r){return n=N(n),e=N(e),t=N(t),r=N(r),O(n,e,t,r)?A:r*n*(e/t-1)}function Rl(){throw new Error("MDURATION is not implemented")}function Dl(n,e,t){if(n=B(M(n)),e=N(e),t=N(t),O(n,e,t))return A;const r=n.length,i=[],c=[];for(let d=0;d<r;d++)n[d]<0?i.push(n[d]):c.push(n[d]);const a=-Qe(t,c)*Math.pow(1+t,r-1),E=Qe(e,i)*(1+e);return Math.pow(a/E,1/(r-1))-1}function Ol(n,e){return n=N(n),e=N(e),O(n,e)?A:n<=0||e<1?R:(e=parseInt(e,10),(Math.pow(n+1,1/e)-1)*e)}function Ll(n,e,t,r,i){if(i=i===void 0?0:i,r=r===void 0?0:r,n=N(n),e=N(e),t=N(t),r=N(r),i=N(i),O(n,e,t,r,i))return A;if(n===0)return-(t+r)/e;{const c=e*(1+n*i)-r*n,a=t*n+e*(1+n*i);return Math.log(c/a)/Math.log(1+n)}}function Qe(){const n=B(M(arguments));if(n instanceof Error)return n;const e=n[0];let t=0;for(let r=1;r<n.length;r++)t+=n[r]/Math.pow(1+e,r);return t}function Ml(){throw new Error("ODDFPRICE is not implemented")}function yl(){throw new Error("ODDFYIELD is not implemented")}function Pl(){throw new Error("ODDLPRICE is not implemented")}function Vl(){throw new Error("ODDLYIELD is not implemented")}function Bl(n,e,t){return n=N(n),e=N(e),t=N(t),O(n,e,t)?A:n<=0?R:(Math.log(t)-Math.log(e))/Math.log(1+n)}function bn(n,e,t,r,i){if(r=r||0,i=i||0,n=N(n),e=N(e),t=N(t),r=N(r),i=N(i),O(n,e,t,r,i))return A;let c;if(n===0)c=(t+r)/e;else{const a=Math.pow(1+n,e);c=i===1?(r*n/(a-1)+t*n/(1-1/a))/(1+n):r*n/(a-1)+t*n/(1-1/a)}return-c}function ql(n,e,t,r,i,c){return i=i||0,c=c||0,n=N(n),t=N(t),r=N(r),i=N(i),c=N(c),O(n,t,r,i,c)?A:bn(n,t,r,i,c)-Mr(n,e,t,r,i,c)}function Ul(){throw new Error("PRICE is not implemented")}function Fl(n,e,t,r,i){if(n=G(n),e=G(e),t=N(t),r=N(r),i=N(i),i=i||0,O(n,e,t,r,i))return A;if(t<=0||r<=0)return R;if(n>=e)return A;let c,a;switch(i){case 0:c=360,a=mn(n,e,!1);break;case 1:c=365,a=Ln(n,e,"D");break;case 2:c=360,a=Ln(n,e,"D");break;case 3:c=365,a=Ln(n,e,"D");break;case 4:c=360,a=mn(n,e,!0);break;default:return R}return r-t*r*a/c}function kl(){throw new Error("PRICEMAT is not implemented")}function Gl(n,e,t,r,i){return r=r||0,i=i||0,n=N(n),e=N(e),t=N(t),r=N(r),i=N(i),O(n,e,t,r,i)?A:n===0?-t*e-r:((1-Math.pow(1+n,e))/n*t*(1+n*i)-r)/Math.pow(1+n,e)}function Hl(n,e,t,r,i,c){if(c=c===void 0?.01:c,r=r===void 0?0:r,i=i===void 0?0:i,n=N(n),e=N(e),t=N(t),r=N(r),i=N(i),c=N(c),O(n,e,t,r,i,c))return A;const a=1e-10,E=20;let d=c;i=i?1:0;for(let s=0;s<E;s++){if(d<=-1)return R;let o,u;if(Math.abs(d)<a?o=t*(1+n*d)+e*(1+d*i)*n+r:(u=Math.pow(1+d,n),o=t*u+e*(1/d+i)*(u-1)+r),Math.abs(o)<a)return d;let f;if(Math.abs(d)<a)f=t*n+e*i*n;else{u=Math.pow(1+d,n);const l=n*Math.pow(1+d,n-1);f=t*l+e*(1/d+i)*l+e*(-1/(d*d))*(u-1)}d-=o/f}return d}function Yl(){throw new Error("RECEIVED is not implemented")}function $l(n,e,t){return n=N(n),e=N(e),t=N(t),O(n,e,t)?A:n===0||e===0?R:Math.pow(t/e,1/n)-1}function zl(n,e,t){return n=N(n),e=N(e),t=N(t),O(n,e,t)?A:t===0?R:(n-e)/t}function Wl(n,e,t,r){return n=N(n),e=N(e),t=N(t),r=N(r),O(n,e,t,r)?A:t===0||r<1||r>t?R:(r=parseInt(r,10),(n-e)*(t-r+1)*2/(t*(t+1)))}function Kl(n,e,t){return n=G(n),e=G(e),t=N(t),O(n,e,t)?A:t<=0||n>e||e-n>365*24*60*60*1e3?R:365*t/(360-t*mn(n,e,!1))}function Xl(n,e,t){return n=G(n),e=G(e),t=N(t),O(n,e,t)?A:t<=0||n>e||e-n>365*24*60*60*1e3?R:100*(1-t*mn(n,e,!1)/360)}function Ql(n,e,t){return n=G(n),e=G(e),t=N(t),O(n,e,t)?A:t<=0||n>e||e-n>365*24*60*60*1e3?R:(100-t)*360/(t*mn(n,e,!1))}function Zl(){throw new Error("VDB is not implemented")}function Jl(n,e,t){if(n=B(M(n)),e=tr(M(e)),t=N(t),O(n,e,t))return A;const r=(l,g,h)=>{const v=h+1;let I=l[0];for(let m=1;m<l.length;m++)I+=l[m]/Math.pow(v,Mn(g[m],g[0])/365);return I},i=(l,g,h)=>{const v=h+1;let I=0;for(let m=1;m<l.length;m++){const p=Mn(g[m],g[0])/365;I-=p*l[m]/Math.pow(v,p+1)}return I};let c=!1,a=!1;for(let l=0;l<n.length;l++)n[l]>0&&(c=!0),n[l]<0&&(a=!0);if(!c||!a)return R;t=t||.1;let E=t;const d=1e-10;let s,o,u,f=!0;do u=r(n,e,E),s=E-u/i(n,e,E),o=Math.abs(s-E),E=s,f=o>d&&Math.abs(u)>d;while(f);return E}function Sl(n,e,t){if(n=N(n),e=B(M(e)),t=tr(M(t)),O(n,e,t))return A;let r=0;for(let i=0;i<e.length;i++)r+=e[i]/Math.pow(1+n,Mn(t[i],t[0])/365);return r}function bl(){throw new Error("YIELD is not implemented")}function xl(){throw new Error("YIELDDISC is not implemented")}function jl(){throw new Error("YIELDMAT is not implemented")}function _l(){const n=M(arguments);let e=A;for(let t=0;t<n.length;t++){if(n[t]instanceof Error)return n[t];n[t]===void 0||n[t]===null||typeof n[t]=="string"||(e===A&&(e=!0),n[t]||(e=!1))}return e}function n0(){return!1}function e0(n,e,t){return n instanceof Error?n:(e=arguments.length>=2?e:!0,e==null&&(e=0),t=arguments.length===3?t:!1,t==null&&(t=0),n?e:t)}function r0(){for(let n=0;n<arguments.length/2;n++)if(arguments[n*2])return arguments[n*2+1];return U}function t0(n,e){return te(n)?e:n}function o0(n,e){return n===U?e:n}function i0(n){return typeof n=="string"?A:n instanceof Error?n:!n}function u0(){const n=M(arguments);let e=A;for(let t=0;t<n.length;t++){if(n[t]instanceof Error)return n[t];n[t]===void 0||n[t]===null||typeof n[t]=="string"||(e===A&&(e=!1),n[t]&&(e=!0))}return e}function f0(){return!0}function s0(){const n=M(arguments);let e=A;for(let t=0;t<n.length;t++){if(n[t]instanceof Error)return n[t];n[t]===void 0||n[t]===null||typeof n[t]=="string"||(e===A&&(e=0),n[t]&&e++)}return e===A?e:!!(Math.floor(Math.abs(e))&1)}function l0(){let n;if(arguments.length>0){const e=arguments[0],t=arguments.length-1,r=Math.floor(t/2);let i=!1;const c=t%2!==0,a=t%2===0?null:arguments[arguments.length-1];if(r){for(let E=0;E<r;E++)if(e===arguments[E*2+1]){n=arguments[E*2+2],i=!0;break}}i||(n=c?a:U)}else n=A;return n}const c0=Object.freeze(Object.defineProperty({__proto__:null,ABS:ko,ACCRINT:rl,ACCRINTM:tl,ACOS:Go,ACOSH:Ho,ACOT:Yo,ACOTH:$o,AGGREGATE:zo,AMORDEGRC:ol,AMORLINC:il,AND:_l,ARABIC:Wo,ASC:Cu,ASIN:Ko,ASINH:Xo,ATAN:Qo,ATAN2:Zo,ATANH:Jo,AVEDEV:oo,AVERAGE:Cn,AVERAGEA:Re,AVERAGEIF:io,AVERAGEIFS:uo,BAHTTEXT:Ru,BASE:So,BESSELI:xu,BESSELJ:ju,BESSELK:_u,BESSELY:nf,BETA:Kn,BETADIST:Gf,BETAINV:Hf,BIN2DEC:ef,BIN2HEX:rf,BIN2OCT:tf,BINOM:Gn,BINOMDIST:Yf,BITAND:of,BITLSHIFT:uf,BITOR:ff,BITRSHIFT:sf,BITXOR:lf,CEILING:pn,CEILINGMATH:$f,CEILINGPRECISE:zf,CELL:Bt,CHAR:Ar,CHIDIST:Wf,CHIDISTRT:Kf,CHIINV:Xf,CHIINVRT:Qf,CHISQ:un,CHITEST:Zf,CHOOSE:Zt,CLEAN:Du,CODE:Cr,COLUMN:Jt,COLUMNS:St,COMBIN:$n,COMBINA:bo,COMPLEX:S,CONCAT:Ou,CONCATENATE:Rr,CONFIDENCE:De,CONVERT:cf,CORREL:fo,COS:xo,COSH:jo,COT:_o,COTH:ni,COUNT:Xn,COUNTA:Qn,COUNTBLANK:ar,COUNTIF:so,COUNTIFS:lo,COUPDAYBS:ul,COUPDAYS:fl,COUPDAYSNC:sl,COUPNCD:ll,COUPNUM:cl,COUPPCD:al,COVAR:Jf,COVARIANCE:Hn,COVARIANCEP:Sf,COVARIANCES:bf,CRITBINOM:xf,CSC:ei,CSCH:ri,CUMIPMT:gl,CUMPRINC:hl,DATE:su,DATEDIF:Ln,DATEVALUE:lu,DAVERAGE:Ks,DAY:cu,DAYS:Mn,DAYS360:mn,DB:dl,DBCS:Lu,DCOUNT:Xs,DCOUNTA:Qs,DDB:vl,DEC2BIN:af,DEC2HEX:gf,DEC2OCT:hf,DECIMAL:ti,DEGREES:oi,DELTA:df,DEVSQ:co,DGET:Zs,DISC:El,DMAX:Js,DMIN:Ss,DOLLAR:Mu,DOLLARDE:pl,DOLLARFR:Nl,DPRODUCT:bs,DSTDEV:xs,DSTDEVP:js,DSUM:_s,DURATION:Il,DVAR:nl,DVARP:el,EDATE:au,EFFECT:ml,EOMONTH:gu,ERF:He,ERFC:Ye,ERFCPRECISE:jf,ERFPRECISE:_f,ERROR:ur,EVEN:ii,EXACT:yu,EXP:ui,EXPON:Oe,EXPONDIST:ns,F:fn,FACT:Nn,FACTDOUBLE:Ir,FALSE:n0,FDIST:es,FDISTRT:rs,FIND:Pu,FINV:ts,FINVRT:os,FISHER:ao,FISHERINV:go,FIXED:Dr,FLOOR:On,FLOORMATH:is,FLOORPRECISE:us,FORECAST:gr,FREQUENCY:ho,FTEST:fs,FV:Pn,FVSCHEDULE:wl,GAMMA:Zn,GAMMADIST:ss,GAMMAINV:ls,GAMMALN:Le,GAMMALNPRECISE:cs,GAUSS:vo,GCD:fi,GEOMEAN:Eo,GESTEP:vf,GROWTH:po,HARMEAN:No,HEX2BIN:Ef,HEX2DEC:pf,HEX2OCT:Nf,HLOOKUP:bt,HOUR:hu,HYPGEOM:Me,HYPGEOMDIST:as,IF:e0,IFERROR:t0,IFNA:o0,IFS:r0,IMABS:$e,IMAGINARY:Y,IMARGUMENT:ze,IMCONJUGATE:If,IMCOS:de,IMCOSH:Or,IMCOT:mf,IMCSC:yf,IMCSCH:Pf,IMDIV:yn,IMEXP:wf,IMLN:Tf,IMLOG10:Af,IMLOG2:Cf,IMPOWER:Rf,IMPRODUCT:Df,IMREAL:$,IMSEC:Of,IMSECH:Lf,IMSIN:ve,IMSINH:Lr,IMSQRT:Mf,IMSUB:Vf,IMSUM:Bf,IMTAN:qf,INDEX:xt,INFO:qt,INT:si,INTERCEPT:Io,INTRATE:Tl,IPMT:Mr,IRR:Al,ISBLANK:Ut,ISERR:fr,ISERROR:te,ISEVEN:Ft,ISFORMULA:kt,ISLOGICAL:sr,ISNA:Gt,ISNONTEXT:Ht,ISNUMBER:oe,ISO:li,ISODD:Yt,ISOWEEKNUM:wr,ISPMT:Cl,ISREF:$t,ISTEXT:lr,KURT:mo,LARGE:hr,LCM:ci,LEFT:Vu,LEN:Bu,LINEST:ye,LN:ai,LOG:gi,LOG10:hi,LOGEST:wo,LOGINV:gs,LOGNORM:Yn,LOGNORMDIST:hs,LOGNORMINV:ds,LOOKUP:jt,LOWER:qu,MATCH:_t,MAX:ie,MAXA:To,MDURATION:Rl,MEDIAN:dr,MID:Uu,MIN:ue,MINA:Ao,MINUTE:du,MIRR:Dl,MMULT:di,MOD:vi,MODE:Rn,MODEMULT:vs,MODESNGL:Es,MONTH:vu,MROUND:Ei,MULTINOMIAL:pi,MUNIT:Ni,N:zt,NA:Wt,NEGBINOM:Pe,NEGBINOMDIST:ps,NETWORKDAYS:ae,NETWORKDAYSINTL:Ns,NOMINAL:Ol,NORM:sn,NORMDIST:Is,NORMINV:ms,NORMSDIST:ws,NORMSINV:Ts,NOT:i0,NOW:Eu,NPER:Ll,NPV:Qe,NUMBERVALUE:Fu,OCT2BIN:Uf,OCT2DEC:Ff,OCT2HEX:kf,ODD:Ii,ODDFPRICE:Ml,ODDFYIELD:yl,ODDLPRICE:Pl,ODDLYIELD:Vl,OR:u0,PDURATION:Bl,PEARSON:vr,PERCENTILE:nn,PERCENTILEEXC:As,PERCENTILEINC:Cs,PERCENTRANK:Jn,PERCENTRANKEXC:Rs,PERCENTRANKINC:Ds,PERMUT:Co,PERMUTATIONA:Ro,PHI:Do,PI:mi,PMT:bn,POISSON:Ve,POISSONDIST:Os,POWER:mr,PPMT:ql,PRICE:Ul,PRICEDISC:Fl,PRICEMAT:kl,PROB:Oo,PRODUCT:se,PRONETIC:ku,PROPER:Gu,PV:Gl,QUARTILE:Dn,QUARTILEEXC:Ls,QUARTILEINC:Ms,QUOTIENT:wi,RADIANS:Ti,RAND:Ai,RANDBETWEEN:Ci,RANK:Sn,RANKAVG:ys,RANKEQ:Ps,RATE:Hl,RECEIVED:Yl,REPLACE:Hu,REPT:rn,RIGHT:Yu,ROMAN:Ri,ROUND:an,ROUNDDOWN:Di,ROUNDUP:Oi,ROW:Lo,ROWS:no,RRI:$l,RSQ:Mo,SEARCH:$u,SEC:Li,SECH:Mi,SECOND:pu,SERIESSUM:yi,SHEET:Kt,SHEETS:Xt,SIGN:Pi,SIN:Vi,SINH:Bi,SKEW:Be,SKEWP:Vs,SLN:zl,SLOPE:yo,SMALL:Er,SORT:eo,SQRT:qi,SQRTPI:Ui,STANDARDIZE:Po,STDEV:j,STDEVA:Vo,STDEVP:Bs,STDEVPA:Bo,STDEVS:qs,STEYX:qo,SUBSTITUTE:zu,SUBTOTAL:Fi,SUM:In,SUMIF:ki,SUMIFS:Gi,SUMPRODUCT:Hi,SUMSQ:Yi,SUMX2MY2:$i,SUMX2PY2:zi,SUMXMY2:Wi,SWITCH:l0,SYD:Wl,T:Wu,TAN:Ki,TANH:Xi,TBILLEQ:Kl,TBILLPRICE:Xl,TBILLYIELD:Ql,TDIST:Us,TDISTRT:Fs,TEXT:Ku,TEXTJOIN:Xu,TIME:Nu,TIMEVALUE:Iu,TINV:ks,TODAY:mu,TRANSPOSE:ro,TREND:Uo,TRIM:Qu,TRIMMEAN:Fo,TRUE:f0,TRUNC:Qi,TTEST:Gs,TYPE:Qt,UNICHAR:Zu,UNICODE:Ju,UNIQUE:Ce,UPPER:Su,VALUE:bu,VAR:b,VARA:pr,VARP:Hs,VARPA:Nr,VARS:Ys,VDB:Zl,VLOOKUP:cr,WEEKDAY:wu,WEEKNUM:Tu,WEIBULL:qe,WEIBULLDIST:$s,WORKDAY:ge,WORKDAYINTL:zs,XIRR:Jl,XNPV:Sl,XOR:s0,YEAR:Au,YEARFRAC:ke,YIELD:bl,YIELDDISC:xl,YIELDMAT:jl,Z:Ue,ZTEST:Ws,utils:{errors:mt,symbols:ou}},Symbol.toStringTag,{value:"Module"})),a0={install:n=>{n.component("SpreadsheetList",D.defineAsyncComponent(()=>Promise.resolve().then(()=>y0))),n.component("SpreadsheetTable",D.defineAsyncComponent(()=>Promise.resolve().then(()=>z0)))}},g0=["contenteditable"],h0=["contenteditable"],d0=["value","disabled"],v0=["value","disabled"],E0=["checked","disabled"],p0={key:5},Ee=D.defineComponent({__name:"SpreadsheetCell",props:{editable:{type:Boolean},mode:null,modelValue:{type:[String,Number,Boolean]},type:null},emits:["update:modelValue"],setup(n){return(e,t)=>(n.type||typeof n.modelValue)==="string"&&n.mode==="normal"?(D.openBlock(),D.createElementBlock("span",{key:0,onInput:t[0]||(t[0]=r=>e.$emit("update:modelValue",r.target.innerText)),contenteditable:n.editable},D.toDisplayString(n.modelValue),41,g0)):(n.type||typeof n.modelValue)==="number"&&n.mode==="normal"?(D.openBlock(),D.createElementBlock("span",{key:1,onInput:t[1]||(t[1]=r=>e.$emit("update:modelValue",Number(r.target.innerText))),onBeforeinput:t[2]||(t[2]=r=>D.unref(Ne)(D.unref(pe)())),contenteditable:n.editable},D.toDisplayString(n.modelValue),41,h0)):(n.type||typeof n.modelValue)==="string"&&n.mode==="input"?(D.openBlock(),D.createElementBlock("input",{key:2,value:n.modelValue,onInput:t[3]||(t[3]=r=>e.$emit("update:modelValue",r.target.value)),disabled:!n.editable,type:"text"},null,40,d0)):(n.type||typeof n.modelValue)==="number"&&n.mode==="input"?(D.openBlock(),D.createElementBlock("input",{key:3,value:n.modelValue,onInput:t[4]||(t[4]=r=>e.$emit("update:modelValue",Number(r.target.value))),onBeforeinput:t[5]||(t[5]=r=>D.unref(Ne)(D.unref(pe)())),disabled:!n.editable,inputmode:"decimal",type:"text"},null,40,v0)):(n.type||typeof n.modelValue)==="boolean"?(D.openBlock(),D.createElementBlock("input",{key:4,checked:n.modelValue,onInput:t[6]||(t[6]=r=>e.$emit("update:modelValue",r.target.checked)),type:"checkbox",disabled:!n.editable},null,40,E0)):(D.openBlock(),D.createElementBlock("span",p0,"Unsupported type"))}}),N0=n=>(D.pushScopeId("data-v-f2bd7273"),n=n(),D.popScopeId(),n),I0={class:"list-item"},m0={key:0,class:"sorting-handle"},w0=[D.createStaticVNode('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke-width="2" class="ai ai-DragVerticalFill" data-v-f2bd7273><path fill-rule="evenodd" clip-rule="evenodd" d="M16 2a2 2 0 1 1 0 4 2 2 0 0 1 0-4z" data-v-f2bd7273></path><path fill-rule="evenodd" clip-rule="evenodd" d="M16 10a2 2 0 1 1 0 4 2 2 0 0 1 0-4z" data-v-f2bd7273></path><path fill-rule="evenodd" clip-rule="evenodd" d="M8 18a2 2 0 1 1 0 4 2 2 0 0 1 0-4z" data-v-f2bd7273></path><path fill-rule="evenodd" clip-rule="evenodd" d="M16 18a2 2 0 1 1 0 4 2 2 0 0 1 0-4z" data-v-f2bd7273></path><path fill-rule="evenodd" clip-rule="evenodd" d="M8 2a2 2 0 1 1 0 4 2 2 0 0 1 0-4z" data-v-f2bd7273></path><path fill-rule="evenodd" clip-rule="evenodd" d="M8 10a2 2 0 1 1 0 4 2 2 0 0 1 0-4z" data-v-f2bd7273></path></svg>',1)],T0=[N0(()=>D.createElementVNode("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"ai ai-Cross"},[D.createElementVNode("path",{d:"M20 20L4 4m16 0L4 20"})],-1))],A0=D.defineComponent({__name:"ListItem",props:{item:null,editable:{type:Boolean},sortable:{type:Boolean},removable:{type:Boolean},mode:null},emits:["remove","edit"],setup(n,{emit:e}){return(t,r)=>(D.openBlock(),D.createElementBlock("div",I0,[n.sortable?(D.openBlock(),D.createElementBlock("div",m0,w0)):D.createCommentVNode("",!0),D.createVNode(Ee,{editable:n.editable,mode:n.mode,"model-value":n.item.value,"onUpdate:modelValue":r[0]||(r[0]=i=>t.$emit("edit",{id:n.item.id,value:i})),class:"spreadsheet-cell"},null,8,["editable","mode","model-value"]),n.removable?(D.openBlock(),D.createElementBlock("button",{key:1,class:"remove-button",onClick:r[1]||(r[1]=i=>t.$emit("remove",n.item))},T0)):D.createCommentVNode("",!0)]))}}),Q0="",yr=(n,e)=>{const t=n.__vccOpts||n;for(const[r,i]of e)t[r]=i;return t},Pr=yr(A0,[["__scopeId","data-v-f2bd7273"]]),C0=n=>(D.pushScopeId("data-v-56bececb"),n=n(),D.popScopeId(),n),R0={class:"spreadsheet-list"},D0={key:0,class:"list-items"},O0={key:2,class:"list-add"},L0=[C0(()=>D.createElementVNode("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"ai ai-Plus"},[D.createElementVNode("path",{d:"M12 20v-8m0 0V4m0 8h8m-8 0H4"})],-1))],M0=D.defineComponent({__name:"SpreadsheetList",props:{editable:{type:Boolean,default:!1},sortable:{type:Boolean,default:!1},removable:{type:Boolean,default:!1},addable:{type:Boolean,default:!1},list:null,type:null},emits:["add","remove","edit","sort"],setup(n,{emit:e}){const t=n,r=o=>{const u=d.value.findIndex(f=>f.id===o.id);d.value[u].value=o.value,t.list[u]=o.value,e("edit",o.value,u)},i=o=>{const u=d.value.findIndex(f=>f.id===o.id);d.value.splice(u,1),t.list.splice(u,1),e("remove",o.value)},c=o=>{o.moved&&(t.list.splice(o.moved.oldIndex,1),t.list.splice(o.moved.newIndex,0,o.moved.element.value),e("sort",t.list))},a=()=>{d.value.push({id:d.value.reduce((o,u)=>Math.max(u.id,o),0)+1,value:s.value}),t.list.push(s.value),e("add",s.value),s.value=""},E=()=>t.list.map((o,u)=>({id:u,value:o})),d=D.ref(E()),s=D.ref("");return D.watch(()=>t.list,()=>{if(d.value.length===t.list.length){for(let o=0;o<d.value.length;o++)if(d.value[o].value!==t.list[o]){d.value=E();break}}else d.value=E()}),(o,u)=>(D.openBlock(),D.createElementBlock("div",R0,[n.sortable?(D.openBlock(),D.createBlock(D.unref(Je),{key:1,list:d.value,"item-key":"id",handle:".sorting-handle",class:"list-items",onChange:c},{item:D.withCtx(({element:f})=>[D.createVNode(Pr,{item:f,editable:n.editable,sortable:n.sortable,removable:n.removable,mode:"normal",onEdit:r,onRemove:i},null,8,["item","editable","sortable","removable"])]),_:1},8,["list"])):(D.openBlock(),D.createElementBlock("div",D0,[(D.openBlock(!0),D.createElementBlock(D.Fragment,null,D.renderList(d.value,(f,l)=>(D.openBlock(),D.createBlock(Pr,{key:l,item:f,editable:n.editable,sortable:n.sortable,removable:n.removable,mode:"normal",onEdit:r,onRemove:i},null,8,["item","editable","sortable","removable"]))),128))])),n.addable?(D.openBlock(),D.createElementBlock("div",O0,[D.createVNode(Ee,{modelValue:s.value,"onUpdate:modelValue":u[0]||(u[0]=f=>s.value=f),editable:!0,mode:"input",type:n.type,class:"add-input"},null,8,["modelValue","type"]),D.createElementVNode("button",{class:"add-button",onClick:a},L0)])):D.createCommentVNode("",!0)]))}}),J0="",y0=Object.freeze(Object.defineProperty({__proto__:null,default:yr(M0,[["__scopeId","data-v-56bececb"]])},Symbol.toStringTag,{value:"Module"})),P0={class:"table-row"},V0={key:0,class:"sorting-handle"},B0=[D.createStaticVNode('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke-width="2" class="ai ai-DragVerticalFill"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 2a2 2 0 1 1 0 4 2 2 0 0 1 0-4z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M16 10a2 2 0 1 1 0 4 2 2 0 0 1 0-4z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M8 18a2 2 0 1 1 0 4 2 2 0 0 1 0-4z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M16 18a2 2 0 1 1 0 4 2 2 0 0 1 0-4z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M8 2a2 2 0 1 1 0 4 2 2 0 0 1 0-4z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M8 10a2 2 0 1 1 0 4 2 2 0 0 1 0-4z"></path></svg>',1)],q0=[D.createElementVNode("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"ai ai-Cross"},[D.createElementVNode("path",{d:"M20 20L4 4m16 0L4 20"})],-1)],Vr=D.defineComponent({__name:"TableRow",props:{row:null,headers:null,editable:{type:Boolean},sortable:{type:Boolean},removable:{type:Boolean},mode:null},emits:["remove","edit"],setup(n,{emit:e}){return(t,r)=>(D.openBlock(),D.createElementBlock("tr",P0,[n.sortable?(D.openBlock(),D.createElementBlock("td",V0,B0)):D.createCommentVNode("",!0),(D.openBlock(!0),D.createElementBlock(D.Fragment,null,D.renderList(Object.keys(n.headers),i=>(D.openBlock(),D.createElementBlock("td",null,[D.createVNode(Ee,{editable:n.editable,mode:n.mode,"model-value":n.row.value[i],"onUpdate:modelValue":c=>t.$emit("edit",n.row,i,c),class:"spreadsheet-cell"},null,8,["editable","mode","model-value","onUpdate:modelValue"])]))),256)),D.createElementVNode("td",null,[n.removable?(D.openBlock(),D.createElementBlock("button",{key:0,class:"remove-button",onClick:r[0]||(r[0]=i=>t.$emit("remove",n.row))},q0)):D.createCommentVNode("",!0)])]))}}),U0={class:"spreadsheet-table"},F0={key:0},k0={key:1},G0={key:0,class:"table-body"},H0={key:2,class:"table-add"},Y0={key:0},$0=[D.createElementVNode("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"ai ai-Plus"},[D.createElementVNode("path",{d:"M12 20v-8m0 0V4m0 8h8m-8 0H4"})],-1)],z0=Object.freeze(Object.defineProperty({__proto__:null,default:D.defineComponent({__name:"SpreadsheetTable",props:{editable:{type:Boolean,default:!1},sortable:{type:Boolean,default:!1},removable:{type:Boolean,default:!1},addable:{type:Boolean,default:!1},table:null,headers:null,types:null},emits:["add","remove","edit","sort"],setup(n,{emit:e}){const t=n,r=(u,f,l)=>{const g=s.value.findIndex(h=>h.id===u.id);s.value[g].value[f]=l,t.table[g][f]=l,e("edit",s.value[g].value,g,f,l)},i=u=>{const f=s.value.findIndex(l=>l.id===u.id);s.value.splice(f,1),t.table.splice(f,1),e("remove",u.value)},c=u=>{u.moved&&(t.table.splice(u.moved.oldIndex,1),t.table.splice(u.moved.newIndex,0,u.moved.element.value),e("sort",t.table))},a=()=>{s.value.push({id:s.value.reduce((u,f)=>Math.max(f.id,u),0)+1,value:o.value}),t.table.push(o.value),e("add",o.value),o.value=d()},E=()=>t.table.map((u,f)=>({id:f,value:u})),d=()=>Object.keys(t.types).reduce((u,f)=>(u[f]=t.types[f]==="number"?0:t.types[f]==="boolean"?!1:"",u),{}),s=D.ref(E()),o=D.ref(d());return D.watch(()=>t.table,()=>{if(s.value.length===t.table.length){for(let u=0;u<s.value.length;u++)if(s.value[u].value!==t.table[u]){s.value=E();break}}else s.value=E()}),(u,f)=>(D.openBlock(),D.createElementBlock("table",U0,[D.createElementVNode("thead",null,[D.createElementVNode("tr",null,[n.sortable?(D.openBlock(),D.createElementBlock("th",F0)):D.createCommentVNode("",!0),(D.openBlock(!0),D.createElementBlock(D.Fragment,null,D.renderList(Object.values(n.headers),(l,g)=>(D.openBlock(),D.createElementBlock("th",{key:g,class:"spreadsheet-table-header"},D.toDisplayString(l),1))),128)),n.removable||n.addable?(D.openBlock(),D.createElementBlock("th",k0)):D.createCommentVNode("",!0)])]),n.sortable?(D.openBlock(),D.createBlock(D.unref(Je),{key:1,list:s.value,"item-key":"id",handle:".sorting-handle",class:"list-items",tag:"tbody",onChange:c},{item:D.withCtx(({element:l,index:g})=>[(D.openBlock(),D.createBlock(Vr,{key:g,row:l,headers:n.headers,editable:n.editable,sortable:n.sortable,removable:n.removable,mode:"normal",onEdit:r,onRemove:i},null,8,["row","headers","editable","sortable","removable"]))]),_:1},8,["list"])):(D.openBlock(),D.createElementBlock("tbody",G0,[(D.openBlock(!0),D.createElementBlock(D.Fragment,null,D.renderList(s.value,(l,g)=>(D.openBlock(),D.createBlock(Vr,{key:g,row:l,headers:n.headers,editable:n.editable,sortable:n.sortable,removable:n.removable,mode:"normal",onEdit:r,onRemove:i},null,8,["row","headers","editable","sortable","removable"]))),128))])),n.addable?(D.openBlock(),D.createElementBlock("tfoot",H0,[n.sortable?(D.openBlock(),D.createElementBlock("td",Y0)):D.createCommentVNode("",!0),(D.openBlock(!0),D.createElementBlock(D.Fragment,null,D.renderList(Object.keys(o.value),l=>(D.openBlock(),D.createElementBlock("td",null,[D.createVNode(Ee,{modelValue:o.value[l],"onUpdate:modelValue":g=>o.value[l]=g,editable:!0,mode:"input",type:n.types[l],class:"add-input"},null,8,["modelValue","onUpdate:modelValue","type"])]))),256)),D.createElementVNode("td",null,[D.createElementVNode("button",{class:"add-button",onClick:a},$0)])])):D.createCommentVNode("",!0)]))}})},Symbol.toStringTag,{value:"Module"}));F.and=tt,F.asNumber=pt,F.flatten=Ur,F.formula=c0,F.isBetween=jr,F.isBetweenExclusive=_r,F.isBetweenExclusiveInclusive=et,F.isBetweenInclusiveExclusive=nt,F.isEmpty=it,F.isEqual=ut,F.isGreaterThan=br,F.isGreaterThanOrEqualTo=xr,F.isLengthBetween=ht,F.isLengthBetweenExclusive=dt,F.isLengthBetweenExclusiveInclusive=Et,F.isLengthBetweenInclusiveExclusive=vt,F.isLengthEqualTo=st,F.isLengthGreaterThan=at,F.isLengthGreaterThanOrEqualTo=gt,F.isLengthLessThan=lt,F.isLengthLessThanOrEqualTo=ct,F.isLessThan=Jr,F.isLessThanOrEqualTo=Sr,F.isNegative=Xr,F.isNumber=pe,F.isPositive=Kr,F.isStrictlyNegative=Zr,F.isStrictlyPositive=Qr,F.isTypeMatch=ft,F.isWholeNumber=Wr,F.listToCsv=kr,F.not=rt,F.or=ot,F.parseCSV=$r,F.saveCsv=Yr,F.sortArray=Br,F.sortRange=qr,F.spreadsheets=a0,F.tableToCsv=Hr,F.transpose=Se,F.validate=Ne,Object.defineProperty(F,Symbol.toStringTag,{value:"Module"})});
