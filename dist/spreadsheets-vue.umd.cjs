(function(s,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("vue"),require("vuedraggable")):typeof define=="function"&&define.amd?define(["exports","vue","vuedraggable"],t):(s=typeof globalThis<"u"?globalThis:s||self,t(s.SpreadsheetsVue={},s.Vue,s.draggable))})(this,function(s,t,N){"use strict";Array.prototype.count||(Array.prototype.count=function(n){return this.reduce((l,o)=>l+(n(o)?1:0),0)});const j=e=>n=>!e(n),x=()=>e=>e==null||e==="",O=e=>n=>n===e,z=e=>n=>typeof n==typeof e;function g(e,n){let l=[...e];const o=l.filter(i=>!Number.isNaN(Number(i))),a=l.filter(i=>Number.isNaN(Number(i)));return o.sort((i,b)=>Number(i)-Number(b)),a.sort(),n!=null&&n.descending&&(o.reverse(),a.reverse()),l=(n==null?void 0:n.numbersFirst)===void 0||n.numbersFirst?[...o,...a]:[...a,...o],l}function q(e,n,l,o){if(n<0||l>=e.length||n>=l)throw new Error("Invalid range specified");const a=e.slice(n,l+1);a.sort(),o&&a.reverse();for(let i=n,b=0;i<=l;i++,b++)e[i]=a[b];return e}var A=["2","3","4","1","5","8","11","-3","9.2"],P=["john","3","4","afro","22","-3","student","2no","2 yes","9.2","9,3","e","01010","Infinity","-Infinity"];console.log(g(A)),console.log(g(P));function R(e){return e.reduce((n,l)=>n.concat(l),[])}function B(e){return e[0].map((n,l)=>e.map(o=>o[l]))}console.log(B([[1,2,3],[4,5,6],[7,8,9],[10,11,12]]));function E(e){return v(e)/e.length}function v(e){return e.reduce((n,l)=>n+l,0)}let $=[1,12,23,45,5];console.log(E($)),console.log(v($));function D(e,n,l,o,a){return(e-n)/Math.sqrt(Math.pow(l,2)*(1/o+1/a))}function k(e){if(e.length===0)return null;const n=Math.floor(e.length/2);return e.length%2===0?(e[n-1]+e[n])/2:e[n]}function C(e){if(e.length===0)return{q1:null,q2:null,q3:null};const n=Math.floor(e.length/2),l=k(e);let o,a;if(e.length%2===0){const i=e.slice(0,n),b=e.slice(n);o=k(i),a=k(b)}else{const i=e.slice(0,n),b=e.slice(n+1);o=k(i),a=k(b)}return{q1:o,q2:l,q3:a}}let S=[1,2,3,4,5,6,7,8,9];console.log(k(S)),console.log(C(S));function F(e,n){return(n!=null&&n.header?[n.header,...e]:e).join((n==null?void 0:n.direction)==="horizontal"?",":`
`)}function U(e,n){if(n!=null&&n.nested)return n.nested;for(let l of e)if("items"in l&&Array.isArray(l.items)&&l.items.length>0&&typeof l.items[0]=="object")return!0;return!1}function H(e,n,l){let o=[];if(o.push(Object.values(n)),U(e,l))for(let a of e)for(let i of a.items)o.push(Object.keys(n).map(b=>b===(l==null?void 0:l.groupKey)?a[l.groupKey]:i[b]));else for(let a of e)o.push(Object.keys(n).map(i=>a[i]));return(l==null?void 0:l.direction)==="horizontal"&&(o=B(o)),o.map(a=>a.join(",")).join(`
`)}function W(e,n){}function M(e){const n=e.split(`
`),l=[];for(let o of n){const a=o.split(",");for(let i of a)i=i.trim(),l.push(K(i))}return l}function K(e){const n=Number(e);if(!isNaN(n))return n;const l=new Date(e);return isNaN(l.getTime())?e.toLowerCase()==="true"?!0:e.toLowerCase()==="false"?!1:e:l}console.log(M("2, TRUE, John"));const w=e=>{if(e.target.value){const n=e.target;return n.value.substring(0,n.selectionStart)+(e.data??"")+n.value.substring(n.selectionEnd)}else{const n=e.target,l=document.getSelection(),o=Math.min(l.anchorOffset,l.focusOffset),a=Math.max(l.anchorOffset,l.focusOffset);return n.innerText.substring(0,o)+(e.data??"")+n.innerText.substring(a)}},J=e=>{const n=w(e);/^\d*$/.test(n)||e.preventDefault()},G=e=>{const n=w(e);/^-?\d*$/.test(n)||e.preventDefault()},V=e=>{const n=w(e);/^-?\d*\.?\d*$/.test(n)||e.preventDefault()},Q=e=>{e.component("SpreadsheetList",t.defineAsyncComponent(()=>Promise.resolve().then(()=>be))),e.component("SpreadsheetTable",t.defineAsyncComponent(()=>Promise.resolve().then(()=>$e)))},X=["contenteditable"],Y=["contenteditable"],Z=["value","disabled"],_=["value","disabled"],ee=["checked","disabled"],te={key:5},y=t.defineComponent({__name:"SpreadsheetCell",props:{editable:{type:Boolean},mode:null,modelValue:{type:[String,Number,Boolean]},type:null},emits:["update:modelValue"],setup(e){return(n,l)=>(e.type||typeof e.modelValue)==="string"&&e.mode==="normal"?(t.openBlock(),t.createElementBlock("span",{key:0,onInput:l[0]||(l[0]=o=>n.$emit("update:modelValue",o.target.innerText)),contenteditable:e.editable},t.toDisplayString(e.modelValue),41,X)):(e.type||typeof e.modelValue)==="number"&&e.mode==="normal"?(t.openBlock(),t.createElementBlock("span",{key:1,onInput:l[1]||(l[1]=o=>n.$emit("update:modelValue",Number(o.target.innerText))),onBeforeinput:l[2]||(l[2]=o=>t.unref(V)(o)),contenteditable:e.editable},t.toDisplayString(e.modelValue),41,Y)):(e.type||typeof e.modelValue)==="string"&&e.mode==="input"?(t.openBlock(),t.createElementBlock("input",{key:2,value:e.modelValue,onInput:l[3]||(l[3]=o=>n.$emit("update:modelValue",o.target.value)),disabled:!e.editable,type:"text"},null,40,Z)):(e.type||typeof e.modelValue)==="number"&&e.mode==="input"?(t.openBlock(),t.createElementBlock("input",{key:3,value:e.modelValue,onInput:l[4]||(l[4]=o=>n.$emit("update:modelValue",Number(o.target.value))),onBeforeinput:l[5]||(l[5]=o=>t.unref(V)(o)),disabled:!e.editable,inputmode:"decimal",type:"text"},null,40,_)):(e.type||typeof e.modelValue)==="boolean"?(t.openBlock(),t.createElementBlock("input",{key:4,checked:e.modelValue,onInput:l[6]||(l[6]=o=>n.$emit("update:modelValue",o.target.checked)),type:"checkbox",disabled:!e.editable},null,40,ee)):(t.openBlock(),t.createElementBlock("span",te,"Unsupported type"))}}),le=e=>(t.pushScopeId("data-v-f2bd7273"),e=e(),t.popScopeId(),e),ne={class:"list-item"},oe={key:0,class:"sorting-handle"},ae=[t.createStaticVNode('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke-width="2" class="ai ai-DragVerticalFill" data-v-f2bd7273><path fill-rule="evenodd" clip-rule="evenodd" d="M16 2a2 2 0 1 1 0 4 2 2 0 0 1 0-4z" data-v-f2bd7273></path><path fill-rule="evenodd" clip-rule="evenodd" d="M16 10a2 2 0 1 1 0 4 2 2 0 0 1 0-4z" data-v-f2bd7273></path><path fill-rule="evenodd" clip-rule="evenodd" d="M8 18a2 2 0 1 1 0 4 2 2 0 0 1 0-4z" data-v-f2bd7273></path><path fill-rule="evenodd" clip-rule="evenodd" d="M16 18a2 2 0 1 1 0 4 2 2 0 0 1 0-4z" data-v-f2bd7273></path><path fill-rule="evenodd" clip-rule="evenodd" d="M8 2a2 2 0 1 1 0 4 2 2 0 0 1 0-4z" data-v-f2bd7273></path><path fill-rule="evenodd" clip-rule="evenodd" d="M8 10a2 2 0 1 1 0 4 2 2 0 0 1 0-4z" data-v-f2bd7273></path></svg>',1)],de=[le(()=>t.createElementVNode("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"ai ai-Cross"},[t.createElementVNode("path",{d:"M20 20L4 4m16 0L4 20"})],-1))],re=t.defineComponent({__name:"ListItem",props:{item:null,editable:{type:Boolean},sortable:{type:Boolean},removable:{type:Boolean},mode:null},emits:["remove","edit"],setup(e,{emit:n}){return(l,o)=>(t.openBlock(),t.createElementBlock("div",ne,[e.sortable?(t.openBlock(),t.createElementBlock("div",oe,ae)):t.createCommentVNode("",!0),t.createVNode(y,{editable:e.editable,mode:e.mode,"model-value":e.item.value,"onUpdate:modelValue":o[0]||(o[0]=a=>l.$emit("edit",{id:e.item.id,value:a})),class:"spreadsheet-cell"},null,8,["editable","mode","model-value"]),e.removable?(t.openBlock(),t.createElementBlock("button",{key:1,class:"remove-button",onClick:o[1]||(o[1]=a=>l.$emit("remove",e.item))},de)):t.createCommentVNode("",!0)]))}}),Le="",I=(e,n)=>{const l=e.__vccOpts||e;for(const[o,a]of n)l[o]=a;return l},T=I(re,[["__scopeId","data-v-f2bd7273"]]),se=e=>(t.pushScopeId("data-v-56bececb"),e=e(),t.popScopeId(),e),ie={class:"spreadsheet-list"},ce={key:0,class:"list-items"},me={key:2,class:"list-add"},ue=[se(()=>t.createElementVNode("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"ai ai-Plus"},[t.createElementVNode("path",{d:"M12 20v-8m0 0V4m0 8h8m-8 0H4"})],-1))],fe=t.defineComponent({__name:"SpreadsheetList",props:{editable:{type:Boolean,default:!1},sortable:{type:Boolean,default:!1},removable:{type:Boolean,default:!1},addable:{type:Boolean,default:!1},list:null,type:null},emits:["add","remove","edit","sort"],setup(e,{emit:n}){const l=e,o=r=>{const d=f.value.findIndex(c=>c.id===r.id);f.value[d].value=r.value,l.list[d]=r.value,n("edit",r.value,d)},a=r=>{const d=f.value.findIndex(c=>c.id===r.id);f.value.splice(d,1),l.list.splice(d,1),n("remove",r.value)},i=r=>{r.moved&&(l.list.splice(r.moved.oldIndex,1),l.list.splice(r.moved.newIndex,0,r.moved.element.value),n("sort",l.list))},b=()=>{f.value.push({id:f.value.reduce((r,d)=>Math.max(d.id,r),0)+1,value:m.value}),l.list.push(m.value),n("add",m.value),m.value=""},p=()=>l.list.map((r,d)=>({id:d,value:r})),f=t.ref(p()),m=t.ref("");return t.watch(()=>l.list,()=>{if(f.value.length===l.list.length){for(let r=0;r<f.value.length;r++)if(f.value[r].value!==l.list[r]){f.value=p();break}}else f.value=p()}),(r,d)=>(t.openBlock(),t.createElementBlock("div",ie,[e.sortable?(t.openBlock(),t.createBlock(t.unref(N),{key:1,list:f.value,"item-key":"id",handle:".sorting-handle",class:"list-items",onChange:i},{item:t.withCtx(({element:c})=>[t.createVNode(T,{item:c,editable:e.editable,sortable:e.sortable,removable:e.removable,mode:"normal",onEdit:o,onRemove:a},null,8,["item","editable","sortable","removable"])]),_:1},8,["list"])):(t.openBlock(),t.createElementBlock("div",ce,[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(f.value,(c,u)=>(t.openBlock(),t.createBlock(T,{key:u,item:c,editable:e.editable,sortable:e.sortable,removable:e.removable,mode:"normal",onEdit:o,onRemove:a},null,8,["item","editable","sortable","removable"]))),128))])),e.addable?(t.openBlock(),t.createElementBlock("div",me,[t.createVNode(y,{modelValue:m.value,"onUpdate:modelValue":d[0]||(d[0]=c=>m.value=c),editable:!0,mode:"input",type:e.type,class:"add-input"},null,8,["modelValue","type"]),t.createElementVNode("button",{class:"add-button",onClick:b},ue)])):t.createCommentVNode("",!0)]))}}),xe="",be=Object.freeze(Object.defineProperty({__proto__:null,default:I(fe,[["__scopeId","data-v-56bececb"]])},Symbol.toStringTag,{value:"Module"})),he={class:"table-row"},ke={key:0,class:"sorting-handle"},pe=[t.createStaticVNode('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke-width="2" class="ai ai-DragVerticalFill"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 2a2 2 0 1 1 0 4 2 2 0 0 1 0-4z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M16 10a2 2 0 1 1 0 4 2 2 0 0 1 0-4z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M8 18a2 2 0 1 1 0 4 2 2 0 0 1 0-4z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M16 18a2 2 0 1 1 0 4 2 2 0 0 1 0-4z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M8 2a2 2 0 1 1 0 4 2 2 0 0 1 0-4z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M8 10a2 2 0 1 1 0 4 2 2 0 0 1 0-4z"></path></svg>',1)],ye=[t.createElementVNode("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"ai ai-Cross"},[t.createElementVNode("path",{d:"M20 20L4 4m16 0L4 20"})],-1)],L=t.defineComponent({__name:"TableRow",props:{row:null,headers:null,editable:{type:Boolean},sortable:{type:Boolean},removable:{type:Boolean},mode:null},emits:["remove","edit"],setup(e,{emit:n}){return(l,o)=>(t.openBlock(),t.createElementBlock("tr",he,[e.sortable?(t.openBlock(),t.createElementBlock("td",ke,pe)):t.createCommentVNode("",!0),(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(Object.keys(e.headers),a=>(t.openBlock(),t.createElementBlock("td",null,[t.createVNode(y,{editable:e.editable,mode:e.mode,"model-value":e.row.value[a],"onUpdate:modelValue":i=>l.$emit("edit",e.row,a,i),class:"spreadsheet-cell"},null,8,["editable","mode","model-value","onUpdate:modelValue"])]))),256)),t.createElementVNode("td",null,[e.removable?(t.openBlock(),t.createElementBlock("button",{key:0,class:"remove-button",onClick:o[0]||(o[0]=a=>l.$emit("remove",e.row))},ye)):t.createCommentVNode("",!0)])]))}}),ge={class:"spreadsheet-table"},Be={key:0},ve={key:1},we={key:0,class:"table-body"},Ve={key:2,class:"table-add"},Ne={key:0},Ee=[t.createElementVNode("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"ai ai-Plus"},[t.createElementVNode("path",{d:"M12 20v-8m0 0V4m0 8h8m-8 0H4"})],-1)],$e=Object.freeze(Object.defineProperty({__proto__:null,default:t.defineComponent({__name:"SpreadsheetTable",props:{editable:{type:Boolean,default:!1},sortable:{type:Boolean,default:!1},removable:{type:Boolean,default:!1},addable:{type:Boolean,default:!1},table:null,headers:null,types:null},emits:["add","remove","edit","sort"],setup(e,{emit:n}){const l=e,o=(d,c,u)=>{const h=m.value.findIndex(Ce=>Ce.id===d.id);m.value[h].value[c]=u,l.table[h][c]=u,n("edit",m.value[h].value,h,c,u)},a=d=>{const c=m.value.findIndex(u=>u.id===d.id);m.value.splice(c,1),l.table.splice(c,1),n("remove",d.value)},i=d=>{d.moved&&(l.table.splice(d.moved.oldIndex,1),l.table.splice(d.moved.newIndex,0,d.moved.element.value),n("sort",l.table))},b=()=>{m.value.push({id:m.value.reduce((d,c)=>Math.max(c.id,d),0)+1,value:r.value}),l.table.push(r.value),n("add",r.value),r.value=f()},p=()=>l.table.map((d,c)=>({id:c,value:d})),f=()=>Object.keys(l.types).reduce((d,c)=>(d[c]=l.types[c]==="number"?0:l.types[c]==="boolean"?!1:"",d),{}),m=t.ref(p()),r=t.ref(f());return t.watch(()=>l.table,()=>{if(m.value.length===l.table.length){for(let d=0;d<m.value.length;d++)if(m.value[d].value!==l.table[d]){m.value=p();break}}else m.value=p()}),(d,c)=>(t.openBlock(),t.createElementBlock("table",ge,[t.createElementVNode("thead",null,[t.createElementVNode("tr",null,[e.sortable?(t.openBlock(),t.createElementBlock("th",Be)):t.createCommentVNode("",!0),(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(Object.values(e.headers),(u,h)=>(t.openBlock(),t.createElementBlock("th",{key:h,class:"spreadsheet-table-header"},t.toDisplayString(u),1))),128)),e.removable||e.addable?(t.openBlock(),t.createElementBlock("th",ve)):t.createCommentVNode("",!0)])]),e.sortable?(t.openBlock(),t.createBlock(t.unref(N),{key:1,list:m.value,"item-key":"id",handle:".sorting-handle",class:"list-items",tag:"tbody",onChange:i},{item:t.withCtx(({element:u,index:h})=>[(t.openBlock(),t.createBlock(L,{key:h,row:u,headers:e.headers,editable:e.editable,sortable:e.sortable,removable:e.removable,mode:"normal",onEdit:o,onRemove:a},null,8,["row","headers","editable","sortable","removable"]))]),_:1},8,["list"])):(t.openBlock(),t.createElementBlock("tbody",we,[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(m.value,(u,h)=>(t.openBlock(),t.createBlock(L,{key:h,row:u,headers:e.headers,editable:e.editable,sortable:e.sortable,removable:e.removable,mode:"normal",onEdit:o,onRemove:a},null,8,["row","headers","editable","sortable","removable"]))),128))])),e.addable?(t.openBlock(),t.createElementBlock("tfoot",Ve,[e.sortable?(t.openBlock(),t.createElementBlock("td",Ne)):t.createCommentVNode("",!0),(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(Object.keys(r.value),u=>(t.openBlock(),t.createElementBlock("td",null,[t.createVNode(y,{modelValue:r.value[u],"onUpdate:modelValue":h=>r.value[u]=h,editable:!0,mode:"input",type:e.types[u],class:"add-input"},null,8,["modelValue","onUpdate:modelValue","type"])]))),256)),t.createElementVNode("button",{class:"add-button",onClick:b},Ee)])):t.createCommentVNode("",!0)]))}})},Symbol.toStringTag,{value:"Module"}));s.arrayMean=E,s.arraySum=v,s.emptyElements=x,s.exactMatch=O,s.flatten=R,s.isNumber=V,s.isWholeNumber=G,s.isWholePositiveNumber=J,s.listToCsv=F,s.median=k,s.not=j,s.parseCSV=M,s.quartiles=C,s.saveCsv=W,s.simple_T_Test=D,s.sortList=g,s.sortRange=q,s.spreadsheetsPlugin=Q,s.tableToCsv=H,s.transpose=B,s.typeMatch=z,Object.defineProperty(s,Symbol.toStringTag,{value:"Module"})});
