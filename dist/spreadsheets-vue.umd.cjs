(function(i,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("vue"),require("vuedraggable")):typeof define=="function"&&define.amd?define(["exports","vue","vuedraggable"],t):(i=typeof globalThis<"u"?globalThis:i||self,t(i.SpreadsheetsVue={},i.Vue,i.draggable))})(this,function(i,t,k){"use strict";function B(e,n){return e+n}function V(e,n,l,a,d){return(e-n)/Math.sqrt(Math.pow(l,2)*(1/a+1/d))}function w(e){return e[0].map((n,l)=>e.map(a=>a[l]))}function $(e,n){return(n!=null&&n.header?[n.header,...e]:e).join((n==null?void 0:n.direction)==="horizontal"?",":`
`)}function I(e,n){if(n!=null&&n.nested)return n.nested;for(let l of e)if("items"in l&&Array.isArray(l.items)&&l.items.length>0&&typeof l.items[0]=="object")return!0;return!1}function N(e,n,l){let a=[];if(a.push(Object.values(n)),I(e,l))for(let d of e)for(let c of d.items)a.push(Object.keys(n).map(f=>f===(l==null?void 0:l.groupKey)?d[l.groupKey]:c[f]));else for(let d of e)a.push(Object.keys(n).map(c=>d[c]));return(l==null?void 0:l.direction)==="horizontal"&&(a=w(a)),a.map(d=>d.join(",")).join(`
`)}function C(e,n){}const b=e=>{if(e.target.value){const n=e.target;return n.value.substring(0,n.selectionStart)+(e.data??"")+n.value.substring(n.selectionEnd)}else{const n=e.target,l=document.getSelection(),a=Math.min(l.anchorOffset,l.focusOffset),d=Math.max(l.anchorOffset,l.focusOffset);return n.innerText.substring(0,a)+(e.data??"")+n.innerText.substring(d)}},E=e=>{const n=b(e);/^\d*$/.test(n)||e.preventDefault()},S=e=>{const n=b(e);/^-?\d*$/.test(n)||e.preventDefault()},h=e=>{const n=b(e);/^-?\d*\.?\d*$/.test(n)||e.preventDefault()},x=e=>{e.component("List",t.defineAsyncComponent(()=>Promise.resolve().then(()=>G)))},M=["contenteditable"],L=["contenteditable"],j=["value","disabled"],T=["value","disabled"],O=["checked"],p=t.defineComponent({__name:"SpreadsheetCell",props:{editable:{type:Boolean},mode:null,modelValue:{type:[String,Number,Boolean]},type:null},emits:["update:modelValue"],setup(e){return(n,l)=>(e.type||typeof e.modelValue)==="string"&&e.mode==="normal"?(t.openBlock(),t.createElementBlock("span",{key:0,onInput:l[0]||(l[0]=a=>n.$emit("update:modelValue",a.target.innerText)),contenteditable:e.editable},t.toDisplayString(e.modelValue),41,M)):(e.type||typeof e.modelValue)==="number"&&e.mode==="normal"?(t.openBlock(),t.createElementBlock("span",{key:1,onInput:l[1]||(l[1]=a=>n.$emit("update:modelValue",Number(a.target.innerText))),onBeforeinput:l[2]||(l[2]=a=>t.unref(h)(a)),contenteditable:e.editable},t.toDisplayString(e.modelValue),41,L)):(e.type||typeof e.modelValue)==="string"&&e.mode==="input"?(t.openBlock(),t.createElementBlock("input",{key:2,value:e.modelValue,onInput:l[3]||(l[3]=a=>n.$emit("update:modelValue",a.target.value)),disabled:!e.editable,type:"text"},null,40,j)):(e.type||typeof e.modelValue)==="number"&&e.mode==="input"?(t.openBlock(),t.createElementBlock("input",{key:3,value:e.modelValue,onInput:l[4]||(l[4]=a=>n.$emit("update:modelValue",Number(a.target.value))),onBeforeinput:l[5]||(l[5]=a=>t.unref(h)(a)),disabled:!e.editable,inputmode:"decimal",type:"text"},null,40,T)):(e.type||typeof e.modelValue)==="boolean"?(t.openBlock(),t.createElementBlock("input",{key:4,checked:e.modelValue,onInput:l[6]||(l[6]=a=>n.$emit("update:modelValue",a.target.checked)),type:"checkbox"},null,40,O)):t.createCommentVNode("",!0)}}),z=e=>(t.pushScopeId("data-v-5df4679e"),e=e(),t.popScopeId(),e),P={class:"list-item"},D=t.createStaticVNode('<div class="sorting-handle" data-v-5df4679e><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke-width="2" class="ai ai-DragVerticalFill" data-v-5df4679e><path fill-rule="evenodd" clip-rule="evenodd" d="M16 2a2 2 0 1 1 0 4 2 2 0 0 1 0-4z" data-v-5df4679e></path><path fill-rule="evenodd" clip-rule="evenodd" d="M16 10a2 2 0 1 1 0 4 2 2 0 0 1 0-4z" data-v-5df4679e></path><path fill-rule="evenodd" clip-rule="evenodd" d="M8 18a2 2 0 1 1 0 4 2 2 0 0 1 0-4z" data-v-5df4679e></path><path fill-rule="evenodd" clip-rule="evenodd" d="M16 18a2 2 0 1 1 0 4 2 2 0 0 1 0-4z" data-v-5df4679e></path><path fill-rule="evenodd" clip-rule="evenodd" d="M8 2a2 2 0 1 1 0 4 2 2 0 0 1 0-4z" data-v-5df4679e></path><path fill-rule="evenodd" clip-rule="evenodd" d="M8 10a2 2 0 1 1 0 4 2 2 0 0 1 0-4z" data-v-5df4679e></path></svg></div>',1),A=[z(()=>t.createElementVNode("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"ai ai-Cross"},[t.createElementVNode("path",{d:"M20 20L4 4m16 0L4 20"})],-1))],W=t.defineComponent({__name:"ListItem",props:{item:null,editable:{type:Boolean},sortable:{type:Boolean},removable:{type:Boolean},mode:null},emits:["remove","edit"],setup(e,{emit:n}){return(l,a)=>(t.openBlock(),t.createElementBlock("div",P,[D,t.createVNode(p,{editable:e.editable,mode:e.mode,"model-value":e.item.value,"onUpdate:modelValue":a[0]||(a[0]=d=>l.$emit("edit",{id:e.item.id,value:d})),class:"spreadsheet-cell"},null,8,["editable","mode","model-value"]),e.removable?(t.openBlock(),t.createElementBlock("button",{key:0,class:"remove-button",onClick:a[1]||(a[1]=d=>l.$emit("remove",e.item))},A)):t.createCommentVNode("",!0)]))}}),X="",g=(e,n)=>{const l=e.__vccOpts||e;for(const[a,d]of n)l[a]=d;return l},y=g(W,[["__scopeId","data-v-5df4679e"]]),q=e=>(t.pushScopeId("data-v-07030a0f"),e=e(),t.popScopeId(),e),R={class:"list"},F={key:0,class:"list-items"},K={key:2,class:"list-add"},U=[q(()=>t.createElementVNode("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"ai ai-Plus"},[t.createElementVNode("path",{d:"M12 20v-8m0 0V4m0 8h8m-8 0H4"})],-1))],H=t.defineComponent({__name:"List",props:{editable:{type:Boolean,default:!1},sortable:{type:Boolean,default:!1},removable:{type:Boolean,default:!1},addable:{type:Boolean,default:!1},list:null,type:null},emits:["add","remove","edit","sort"],setup(e,{emit:n}){const l=e,a=o=>{const r=s.value.findIndex(u=>u.id===o.id);s.value[r].value=o.value,l.list[r]=o.value,n("edit",o.value,r)},d=o=>{const r=s.value.findIndex(u=>u.id===o.id);s.value.splice(r,1),l.list.splice(r,1),n("remove",o.value)},c=o=>{o.moved&&(l.list.splice(o.moved.oldIndex,1),l.list.splice(o.moved.newIndex,0,o.moved.element.value),n("sort",l.list))},f=()=>{s.value.push({id:s.value.reduce((o,r)=>Math.max(r.id,o),0)+1,value:m.value}),l.list.push(m.value),n("add",m.value),m.value=""},v=()=>l.list.map((o,r)=>({id:r,value:o})),s=t.ref(v()),m=t.ref("");return t.watch(()=>l.list,()=>{if(s.value.length===l.list.length){for(let o=0;o<s.value.length;o++)if(s.value[o].value!==l.list[o]){s.value=v();break}}else s.value=v()}),(o,r)=>(t.openBlock(),t.createElementBlock("div",R,[e.sortable?(t.openBlock(),t.createBlock(t.unref(k),{key:1,list:s.value,"item-key":"id",handle:".sorting-handle",class:"list-items",onChange:c},{item:t.withCtx(({element:u})=>[t.createVNode(y,{item:u,editable:e.editable,sortable:e.sortable,removable:e.removable,mode:"normal",onEdit:a,onRemove:d},null,8,["item","editable","sortable","removable"])]),_:1},8,["list"])):(t.openBlock(),t.createElementBlock("div",F,[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(s.value,(u,J)=>(t.openBlock(),t.createBlock(y,{key:J,item:u,editable:e.editable,sortable:e.sortable,removable:e.removable,mode:"normal",onEdit:a,onRemove:d},null,8,["item","editable","sortable","removable"]))),128))])),e.addable?(t.openBlock(),t.createElementBlock("div",K,[t.createVNode(p,{modelValue:m.value,"onUpdate:modelValue":r[0]||(r[0]=u=>m.value=u),editable:!0,mode:"input",type:e.type,class:"add-input"},null,8,["modelValue","type"]),t.createElementVNode("button",{class:"add-button",onClick:f},U)])):t.createCommentVNode("",!0)]))}}),Z="",G=Object.freeze(Object.defineProperty({__proto__:null,default:g(H,[["__scopeId","data-v-07030a0f"]])},Symbol.toStringTag,{value:"Module"}));i.isNumber=h,i.isWholeNumber=S,i.isWholePositiveNumber=E,i.listToCsv=$,i.saveCsv=C,i.spreadsheetsPlugin=x,i.sum=B,i.t_test=V,i.tableToCsv=N,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})});
